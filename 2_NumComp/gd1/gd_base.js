// Generated by js_of_ocaml 3.0.1
(function(joo_global_object)
   {"use strict";
    function caml_array_append(a1,a2)
     {var l1=a1.length,l2=a2.length,l=l1 + l2 - 1,a=new Array(l);
      a[0] = 0;
      var i=1,j=1;
      for(;i < l1;i++)a[i] = a1[i];
      for(;i < l;i++,j++)a[i] = a2[j];
      return a}
    function caml_array_concat(l)
     {var a=[0];
      while(l !== 0)
       {var b=l[1];for(var i=1;i < b.length;i++)a.push(b[i]);l = l[2]}
      return a}
    function caml_raise_with_arg(tag,arg){throw [0,tag,arg]}
    function caml_str_repeat(n,s)
     {if(s.repeat)return s.repeat(n);
      var r="",l=0;
      if(n == 0)return r;
      for(;;)
       {if(n & 1)r += s;
        n >>= 1;
        if(n == 0)return r;
        s += s;
        l++;
        if(l == 9)s.slice(0,1)}}
    function raw_array_sub(a,i,l)
     {var b=new Array(l);for(var j=0;j < l;j++)b[j] = a[i + j];return b}
    function caml_subarray_to_string(a,i,len)
     {var f=String.fromCharCode;
      if(i == 0 && len <= 4096 && len == a.length)return f.apply(null,a);
      var s="";
      for(;0 < len;i += 1024,len -= 1024)
       s += f.apply(null,raw_array_sub(a,i,Math.min(len,1024)));
      return s}
    function caml_convert_string_to_bytes(s)
     {if(s.t == 2)
       s.c += caml_str_repeat(s.l - s.c.length,"\0");
      else
       s.c = caml_subarray_to_string(s.c,0,s.c.length);
      s.t = 0}
    function caml_is_ascii(s)
     {if(s.length < 24)
       {for(var i=0;i < s.length;i++)if(s.charCodeAt(i) > 127)return false;
        return true}
      else
       return !/[^\x00-\x7f]/.test(s)}
    function caml_utf16_of_utf8(s)
     {for(var b="",t="",c,c1,c2,v,i=0,l=s.length;i < l;i++)
       {c1 = s.charCodeAt(i);
        if(c1 < 128)
         {for(var j=i + 1;j < l && (c1 = s.charCodeAt(j)) < 128;j++);
          if(j - i > 512)
           {t.substr(0,1);b += t;t = "";b += s.slice(i,j)}
          else
           t += s.slice(i,j);
          if(j == l)break;
          i = j}
        v = 1;
        if(++i < l && ((c2 = s.charCodeAt(i)) & -64) == 128)
         {c = c2 + (c1 << 6);
          if(c1 < 224)
           {v = c - 12416;if(v < 128)v = 1}
          else
           {v = 2;
            if(++i < l && ((c2 = s.charCodeAt(i)) & -64) == 128)
             {c = c2 + (c << 6);
              if(c1 < 240)
               {v = c - 925824;if(v < 2048 || v >= 55295 && v < 57344)v = 2}
              else
               {v = 3;
                if
                 (++i
                  <
                  l
                  &&
                  ((c2 = s.charCodeAt(i)) & -64)
                  ==
                  128
                  &&
                  c1
                  <
                  245)
                 {v = c2 - 63447168 + (c << 6);
                  if(v < 65536 || v > 1114111)v = 3}}}}}
        if(v < 4)
         {i -= v;t += "\ufffd"}
        else
         if(v > 65535)
          t += String.fromCharCode(55232 + (v >> 10),56320 + (v & 1023));
         else
          t += String.fromCharCode(v);
        if(t.length > 1024){t.substr(0,1);b += t;t = ""}}
      return b + t}
    function caml_to_js_string(s)
     {switch(s.t)
       {case 9:return s.c;
        default:caml_convert_string_to_bytes(s);case 0:
         if(caml_is_ascii(s.c)){s.t = 9;return s.c}s.t = 8;
        case 8:return caml_utf16_of_utf8(s.c)
        }}
    function MlString(tag,contents,length)
     {this.t = tag;this.c = contents;this.l = length}
    MlString.prototype.toString = function(){return caml_to_js_string(this)};
    function caml_new_string(s){return new MlString(0,s,s.length)}
    function caml_raise_with_string(tag,msg)
     {caml_raise_with_arg(tag,caml_new_string(msg))}
    var caml_global_data=[0];
    function caml_invalid_argument(msg)
     {caml_raise_with_string(caml_global_data.Invalid_argument,msg)}
    function caml_array_bound_error()
     {caml_invalid_argument("index out of bounds")}
    function caml_array_get(array,index)
     {if(index < 0 || index >= array.length - 1)caml_array_bound_error();
      return array[index + 1]}
    function caml_array_set(array,index,newval)
     {if(index < 0 || index >= array.length - 1)caml_array_bound_error();
      array[index + 1] = newval;
      return 0}
    function caml_array_sub(a,i,len)
     {var a2=new Array(len + 1);
      a2[0] = 0;
      for(var i2=1,i1=i + 1;i2 <= len;i2++,i1++)a2[i2] = a[i1];
      return a2}
    function caml_ba_blit(src,dst){dst.blit(src);return 0}
    function caml_ba_get_size(dims)
     {var n_dims=dims.length,size=1;
      for(var i=0;i < n_dims;i++)
       {if(dims[i] < 0)
         caml_invalid_argument("Bigarray.create: negative dimension");
        size = size * dims[i]}
      return size}
    var caml_ba_views;
    function caml_ba_init_views()
     {if(!caml_ba_views)
       {var g=joo_global_object;
        caml_ba_views
        =
        [[g.Float32Array,
          g.Float64Array,
          g.Int8Array,
          g.Uint8Array,
          g.Int16Array,
          g.Uint16Array,
          g.Int32Array,
          g.Int32Array,
          g.Int32Array,
          g.Int32Array,
          g.Float32Array,
          g.Float64Array,
          g.Uint8Array],
         [0,0,0,0,0,0,0,1,0,0,2,2,0]]}}
    function caml_js_from_array(a){return raw_array_sub(a,1,a.length - 1)}
    function caml_ba_create_from(data,data2,data_type,kind,layout,dims)
     {var n_dims=dims.length,size=caml_ba_get_size(dims);
      function offset_c(index)
       {var ofs=0;
        if(n_dims != index.length)
         caml_invalid_argument("Bigarray.get/set: bad number of dimensions");
        for(var i=0;i < n_dims;i++)
         {if(index[i] < 0 || index[i] >= dims[i])caml_array_bound_error();
          ofs = ofs * dims[i] + index[i]}
        return ofs}
      function offset_fortran(index)
       {var ofs=0;
        if(n_dims != index.length)
         caml_invalid_argument("Bigarray.get/set: wrong number of indices");
        for(var i=n_dims - 1;i >= 0;i--)
         {if(index[i] < 1 || index[i] > dims[i])caml_array_bound_error();
          ofs = ofs * dims[i] + (index[i] - 1)}
        return ofs}
      var offset=layout == 0?offset_c:offset_fortran,dim0=dims[0];
      function get_std(index){var ofs=offset(index),v=data[ofs];return v}
      function get_int64(index)
       {var off=offset(index),l=data[off],h=data2[off];
        return [255,
                l & 16777215,
                l >>> 24 & 255 | (h & 65535) << 8,
                h >>> 16 & 65535]}
      function get_complex(index)
       {var off=offset(index),r=data[off],i=data2[off];return [254,r,i]}
      var get=data_type == 1?get_int64:data_type == 2?get_complex:get_std;
      function get1_c(i)
       {if(i < 0 || i >= dim0)caml_array_bound_error();return data[i]}
      function get1_fortran(i)
       {if(i < 1 || i > dim0)caml_array_bound_error();return data[i - 1]}
      function get1_any(i){return get([i])}
      var get1=data_type == 0?layout == 0?get1_c:get1_fortran:get1_any;
      function set_std_raw(off,v){data[off] = v}
      function set_int64_raw(off,v)
       {data[off] = v[1] | (v[2] & 255) << 24;
        data2[off] = v[2] >>> 8 & 65535 | v[3] << 16}
      function set_complex_raw(off,v){data[off] = v[1];data2[off] = v[2]}
      function set_std(index,v)
       {var ofs=offset(index);return set_std_raw(ofs,v)}
      function set_int64(index,v){return set_int64_raw(offset(index),v)}
      function set_complex(index,v){return set_complex_raw(offset(index),v)}
      var set=data_type == 1?set_int64:data_type == 2?set_complex:set_std;
      function set1_c(i,v)
       {if(i < 0 || i >= dim0)caml_array_bound_error();data[i] = v}
      function set1_fortran(i,v)
       {if(i < 1 || i > dim0)caml_array_bound_error();data[i - 1] = v}
      function set1_any(i,v){set([i],v)}
      var set1=data_type == 0?layout == 0?set1_c:set1_fortran:set1_any;
      function nth_dim(i)
       {if(i < 0 || i >= n_dims)caml_invalid_argument("Bigarray.dim");
        return dims[i]}
      function fill(v)
       {if(data_type == 0)for(var i=0;i < data.length;i++)set_std_raw(i,v);
        if(data_type == 1)for(var i=0;i < data.length;i++)set_int64_raw(i,v);
        if(data_type == 2)for(var i=0;i < data.length;i++)set_complex_raw(i,v)}
      function blit(from)
       {if(n_dims != from.num_dims)
         caml_invalid_argument("Bigarray.blit: dimension mismatch");
        for(var i=0;i < n_dims;i++)
         if(dims[i] != from.nth_dim(i))
          caml_invalid_argument("Bigarray.blit: dimension mismatch");
        data.set(from.data);
        if(data_type != 0)data2.set(from.data2)}
      function sub(ofs,len)
       {var changed_dim,mul=1;
        if(layout == 0)
         {for(var i=1;i < n_dims;i++)mul = mul * dims[i];changed_dim = 0}
        else
         {for(var i=0;i < n_dims - 1;i++)mul = mul * dims[i];
          changed_dim = n_dims - 1;
          ofs = ofs - 1}
        if(ofs < 0 || len < 0 || ofs + len > dims[changed_dim])
         caml_invalid_argument("Bigarray.sub: bad sub-array");
        var
         new_data=data.subarray(ofs * mul,(ofs + len) * mul),
         new_data2=
          data_type == 0?null:data2.subarray(ofs * mul,(ofs + len) * mul),
         new_dims=[];
        for(var i=0;i < n_dims;i++)new_dims[i] = dims[i];
        new_dims[changed_dim] = len;
        return caml_ba_create_from
                (new_data,new_data2,data_type,kind,layout,new_dims)}
      function slice(vind)
       {var num_inds=vind.length,index=[],sub_dims=[],ofs;
        if(num_inds >= n_dims)
         caml_invalid_argument("Bigarray.slice: too many indices");
        if(layout == 0)
         {for(var i=0;i < num_inds;i++)index[i] = vind[i];
          for(;i < n_dims;i++)index[i] = 0;
          ofs = offset(index);
          sub_dims = dims.slice(num_inds)}
        else
         {for(var i=0;i < num_inds;i++)index[n_dims - num_inds + i] = vind[i];
          for(var i=0;i < n_dims - num_inds;i++)index[i] = 1;
          ofs = offset(index);
          sub_dims = dims.slice(0,num_inds)}
        var
         size=caml_ba_get_size(sub_dims),
         new_data=data.subarray(ofs,ofs + size),
         new_data2=data_type == 0?null:data2.subarray(ofs,ofs + size);
        return caml_ba_create_from
                (new_data,new_data2,data_type,kind,layout,sub_dims)}
      function reshape(vdim)
       {var new_dim=[],num_dims=vdim.length;
        if(num_dims < 1)
         caml_invalid_argument("Bigarray.reshape: bad number of dimensions");
        var num_elts=1;
        for(var i=0;i < num_dims;i++)
         {new_dim[i] = vdim[i];
          if(new_dim[i] < 0)
           caml_invalid_argument("Bigarray.reshape: negative dimension");
          num_elts = num_elts * new_dim[i]}
        if(num_elts != size)
         caml_invalid_argument("Bigarray.reshape: size mismatch");
        return caml_ba_create_from(data,data2,data_type,kind,layout,new_dim)}
      function compare(b,total)
       {if(layout != b.layout)return b.layout - layout;
        if(n_dims != b.num_dims)return b.num_dims - n_dims;
        for(var i=0;i < n_dims;i++)
         if(nth_dim(i) != b.nth_dim(i))return nth_dim(i) < b.nth_dim(i)?-1:1;
        switch(kind)
         {case 0:
          case 1:
          case 10:
          case 11:
           var x,y;
           for(var i=0;i < data.length;i++)
            {x = data[i];
             y = b.data[i];
             if(x < y)return -1;
             if(x > y)return 1;
             if(x != y)
              if(x != y)
               {if(!total)return NaN;if(x == x)return 1;if(y == y)return -1}
             if(data2)
              {x = data2[i];
               y = b.data2[i];
               if(x < y)return -1;
               if(x > y)return 1;
               if(x != y)
                if(x != y)
                 {if(!total)return NaN;if(x == x)return 1;if(y == y)return -1}}}
           break;
          case 2:
          case 3:
          case 4:
          case 5:
          case 6:
          case 8:
          case 9:
          case 12:
           for(var i=0;i < data.length;i++)
            {if(data[i] < b.data[i])return -1;if(data[i] > b.data[i])return 1}
           break;
          case 7:
           for(var i=0;i < data.length;i++)
            {if(data2[i] < b.data2[i])return -1;
             if(data2[i] > b.data2[i])return 1;
             if(data[i] < b.data[i])return -1;
             if(data[i] > b.data[i])return 1}
           break
          }
        return 0}
      return {data:data,
              data2:data2,
              data_type:data_type,
              num_dims:n_dims,
              nth_dim:nth_dim,
              kind:kind,
              layout:layout,
              size:size,
              sub:sub,
              slice:slice,
              blit:blit,
              fill:fill,
              reshape:reshape,
              get:get,
              get1:get1,
              set:set,
              set1:set1,
              compare:compare}}
    function caml_ba_create(kind,layout,dims_ml)
     {caml_ba_init_views();
      var
       dims=caml_js_from_array(dims_ml),
       size=caml_ba_get_size(dims),
       view=caml_ba_views[0][kind];
      if(!view)caml_invalid_argument("Bigarray.create: unsupported kind");
      var data=new view(size),data_type=caml_ba_views[1][kind],data2=null;
      if(data_type != 0)data2 = new view(size);
      return caml_ba_create_from(data,data2,data_type,kind,layout,dims)}
    function caml_ba_dim(ba,dim){return ba.nth_dim(dim)}
    function caml_ba_fill(ba,init){ba.fill(init);return 0}
    function caml_ba_get_1(ba,i0){return ba.get1(i0)}
    function caml_ba_get_generic(ba,index)
     {return ba.get(caml_js_from_array(index))}
    function caml_ba_kind(ba){return ba.kind}
    function caml_ba_num_dims(ba,_dim){return ba.num_dims}
    function caml_ba_reshape(ba,vind)
     {return ba.reshape(caml_js_from_array(vind))}
    function caml_ba_set_1(ba,i0,v){return ba.set1(i0,v)}
    function caml_ba_set_generic(ba,index,v)
     {return ba.set(caml_js_from_array(index),v)}
    function caml_ba_slice(ba,vind){return ba.slice(caml_js_from_array(vind))}
    function caml_ba_sub(ba,ofs,len){return ba.sub(ofs,len)}
    function caml_convert_string_to_array(s)
     {if(joo_global_object.Uint8Array)
       var a=new (joo_global_object.Uint8Array)(s.l);
      else
       var a=new Array(s.l);
      var b=s.c,l=b.length,i=0;
      for(;i < l;i++)a[i] = b.charCodeAt(i);
      for(l = s.l;i < l;i++)a[i] = 0;
      s.c = a;
      s.t = 4;
      return a}
    function caml_blit_string(s1,i1,s2,i2,len)
     {if(len == 0)return 0;
      if(i2 == 0 && (len >= s2.l || s2.t == 2 && len >= s2.c.length))
       {s2.c
        =
        s1.t == 4
         ?caml_subarray_to_string(s1.c,i1,len)
         :i1 == 0 && s1.c.length == len?s1.c:s1.c.substr(i1,len);
        s2.t = s2.c.length == s2.l?0:2}
      else
       if(s2.t == 2 && i2 == s2.c.length)
        {s2.c
         +=
         s1.t == 4
          ?caml_subarray_to_string(s1.c,i1,len)
          :i1 == 0 && s1.c.length == len?s1.c:s1.c.substr(i1,len);
         s2.t = s2.c.length == s2.l?0:2}
       else
        {if(s2.t != 4)caml_convert_string_to_array(s2);
         var c1=s1.c,c2=s2.c;
         if(s1.t == 4)
          if(i2 <= i1)
           for(var i=0;i < len;i++)c2[i2 + i] = c1[i1 + i];
          else
           for(var i=len - 1;i >= 0;i--)c2[i2 + i] = c1[i1 + i];
         else
          {var l=Math.min(len,c1.length - i1);
           for(var i=0;i < l;i++)c2[i2 + i] = c1.charCodeAt(i1 + i);
           for(;i < len;i++)c2[i2 + i] = 0}}
      return 0}
    var caml_blit_bytes=caml_blit_string;
    function caml_string_bound_error()
     {caml_invalid_argument("index out of bounds")}
    function caml_bytes_unsafe_get(s,i)
     {switch(s.t & 6)
       {default:if(i >= s.c.length)return 0;case 0:return s.c.charCodeAt(i);
        case 4:return s.c[i]
        }}
    function caml_bytes_get(s,i)
     {if(i >>> 0 >= s.l)caml_string_bound_error();
      return caml_bytes_unsafe_get(s,i)}
    function caml_bytes_unsafe_set(s,i,c)
     {c &= 255;
      if(s.t != 4)
       {if(i == s.c.length)
         {s.c += String.fromCharCode(c);if(i + 1 == s.l)s.t = 0;return 0}
        caml_convert_string_to_array(s)}
      s.c[i] = c;
      return 0}
    function caml_bytes_set(s,i,c)
     {if(i >>> 0 >= s.l)caml_string_bound_error();
      return caml_bytes_unsafe_set(s,i,c)}
    function raw_array_append_one(a,x)
     {var l=a.length,b=new Array(l + 1),i=0;
      for(;i < l;i++)b[i] = a[i];
      b[i] = x;
      return b}
    function caml_call_gen(f,args)
     {if(f.fun)return caml_call_gen(f.fun,args);
      var n=f.length,argsLen=args.length,d=n - argsLen;
      if(d == 0)
       return f.apply(null,args);
      else
       if(d < 0)
        return caml_call_gen
                (f.apply(null,raw_array_sub(args,0,n)),
                 raw_array_sub(args,n,argsLen - n));
       else
        return function(x)
         {return caml_call_gen(f,raw_array_append_one(args,x))}}
    function caml_check_bound(array,index)
     {if(index >>> 0 >= array.length - 1)caml_array_bound_error();
      return array}
    function caml_classify_float(x)
     {if(isFinite(x))
       {if(Math.abs(x) >= 2.22507385850720138e-308)return 0;
        if(x != 0)return 1;
        return 2}
      return isNaN(x)?4:3}
    function caml_int64_compare(x,y)
     {var x3=x[3] << 16,y3=y[3] << 16;
      if(x3 > y3)return 1;
      if(x3 < y3)return -1;
      if(x[2] > y[2])return 1;
      if(x[2] < y[2])return -1;
      if(x[1] > y[1])return 1;
      if(x[1] < y[1])return -1;
      return 0}
    function caml_int_compare(a,b)
     {if(a < b)return -1;if(a == b)return 0;return 1}
    function caml_string_compare(s1,s2)
     {s1.t & 6 && caml_convert_string_to_bytes(s1);
      s2.t & 6 && caml_convert_string_to_bytes(s2);
      return s1.c < s2.c?-1:s1.c > s2.c?1:0}
    function caml_compare_val(a,b,total)
     {var stack=[];
      for(;;)
       {if(!(total && a === b))
         if(a instanceof MlString)
          if(b instanceof MlString)
           {if(a !== b){var x=caml_string_compare(a,b);if(x != 0)return x}}
          else
           return 1;
         else
          if(a instanceof Array && a[0] === (a[0] | 0))
           {var ta=a[0];
            if(ta === 254)ta = 0;
            if(ta === 250)
             {a = a[1];continue}
            else
             if(b instanceof Array && b[0] === (b[0] | 0))
              {var tb=b[0];
               if(tb === 254)tb = 0;
               if(tb === 250)
                {b = b[1];continue}
               else
                if(ta != tb)
                 return ta < tb?-1:1;
                else
                 switch(ta)
                  {case 248:
                    var x=caml_int_compare(a[2],b[2]);if(x != 0)return x;break;
                   case 251:caml_invalid_argument("equal: abstract value");
                   case 255:
                    var x=caml_int64_compare(a,b);if(x != 0)return x;break;
                   default:
                    if(a.length != b.length)return a.length < b.length?-1:1;
                    if(a.length > 1)stack.push(a,b,1)}}
             else
              return 1}
          else
           if
            (b instanceof MlString
             ||
             b instanceof Array
             &&
             b[0]
             ===
             (b[0] | 0))
            return -1;
           else
            if(typeof a != "number" && a && a.compare)
             return a.compare(b,total);
            else
             if(typeof a == "function")
              caml_invalid_argument("compare: functional value");
             else
              {if(a < b)return -1;
               if(a > b)return 1;
               if(a != b)
                {if(!total)return NaN;if(a == a)return 1;if(b == b)return -1}}
        if(stack.length == 0)return 0;
        var i=stack.pop();
        b = stack.pop();
        a = stack.pop();
        if(i + 1 < a.length)stack.push(a,b,i + 1);
        a = a[i];
        b = b[i]}}
    function caml_compare(a,b){return caml_compare_val(a,b,true)}
    function caml_cosh_float(x){return (Math.exp(x) + Math.exp(-x)) / 2}
    function caml_create_bytes(len)
     {if(len < 0)caml_invalid_argument("Bytes.create");
      return new MlString(len?2:9,"",len)}
    function caml_raise_constant(tag){throw tag}
    function caml_raise_zero_divide()
     {caml_raise_constant(caml_global_data.Division_by_zero)}
    function caml_div(x,y)
     {if(y == 0)caml_raise_zero_divide();return x / y | 0}
    function caml_equal(x,y){return +(caml_compare_val(x,y,false) == 0)}
    function caml_fill_string(s,i,l,c)
     {if(l > 0)
       if(i == 0 && (l >= s.l || s.t == 2 && l >= s.c.length))
        if(c == 0)
         {s.c = "";s.t = 2}
        else
         {s.c = caml_str_repeat(l,String.fromCharCode(c));s.t = l == s.l?0:2}
       else
        {if(s.t != 4)caml_convert_string_to_array(s);
         for(l += i;i < l;i++)s.c[i] = c}
      return 0}
    var caml_fill_bytes=caml_fill_string;
    function caml_float_compare(x,y)
     {if(x === y)return 0;
      if(x < y)return -1;
      if(x > y)return 1;
      if(x === x)return 1;
      if(y === y)return -1;
      return 0}
    function caml_bytes_of_string(s)
     {if((s.t & 6) != 0)caml_convert_string_to_bytes(s);return s.c}
    function caml_parse_format(fmt)
     {fmt = caml_bytes_of_string(fmt);
      var len=fmt.length;
      if(len > 31)caml_invalid_argument("format_int: format too long");
      var
       f=
        {justify:"+",
         signstyle:"-",
         filler:" ",
         alternate:false,
         base:0,
         signedconv:false,
         width:0,
         uppercase:false,
         sign:1,
         prec:-1,
         conv:"f"};
      for(var i=0;i < len;i++)
       {var c=fmt.charAt(i);
        switch(c)
         {case "-":f.justify = "-";break;
          case "+":
          case " ":f.signstyle = c;break;
          case "0":f.filler = "0";break;
          case "#":f.alternate = true;break;
          case "1":
          case "2":
          case "3":
          case "4":
          case "5":
          case "6":
          case "7":
          case "8":
          case "9":
           f.width = 0;
           while(c = fmt.charCodeAt(i) - 48,c >= 0 && c <= 9)
            {f.width = f.width * 10 + c;i++}
           i--;
           break;
          case ".":
           f.prec = 0;
           i++;
           while(c = fmt.charCodeAt(i) - 48,c >= 0 && c <= 9)
            {f.prec = f.prec * 10 + c;i++}
           i--;
          case "d":
          case "i":f.signedconv = true;
          case "u":f.base = 10;break;
          case "x":f.base = 16;break;
          case "X":f.base = 16;f.uppercase = true;break;
          case "o":f.base = 8;break;
          case "e":
          case "f":
          case "g":f.signedconv = true;f.conv = c;break;
          case "E":
          case "F":
          case "G":
           f.signedconv = true;
           f.uppercase = true;
           f.conv = c.toLowerCase();
           break
          }}
      return f}
    function caml_finish_formatting(f,rawbuffer)
     {if(f.uppercase)rawbuffer = rawbuffer.toUpperCase();
      var len=rawbuffer.length;
      if(f.signedconv && (f.sign < 0 || f.signstyle != "-"))len++;
      if(f.alternate){if(f.base == 8)len += 1;if(f.base == 16)len += 2}
      var buffer="";
      if(f.justify == "+" && f.filler == " ")
       for(var i=len;i < f.width;i++)buffer += " ";
      if(f.signedconv)
       if(f.sign < 0)
        buffer += "-";
       else
        if(f.signstyle != "-")buffer += f.signstyle;
      if(f.alternate && f.base == 8)buffer += "0";
      if(f.alternate && f.base == 16)buffer += "0x";
      if(f.justify == "+" && f.filler == "0")
       for(var i=len;i < f.width;i++)buffer += "0";
      buffer += rawbuffer;
      if(f.justify == "-")for(var i=len;i < f.width;i++)buffer += " ";
      return caml_new_string(buffer)}
    function caml_format_float(fmt,x)
     {var s,f=caml_parse_format(fmt),prec=f.prec < 0?6:f.prec;
      if(x < 0 || x == 0 && 1 / x == -Infinity){f.sign = -1;x = -x}
      if(isNaN(x))
       {s = "nan";f.filler = " "}
      else
       if(!isFinite(x))
        {s = "inf";f.filler = " "}
       else
        switch(f.conv)
         {case "e":
           var s=x.toExponential(prec),i=s.length;
           if(s.charAt(i - 3) == "e")
            s = s.slice(0,i - 1) + "0" + s.slice(i - 1);
           break;
          case "f":s = x.toFixed(prec);break;
          case "g":
           prec = prec?prec:1;
           s = x.toExponential(prec - 1);
           var j=s.indexOf("e"),exp=+s.slice(j + 1);
           if(exp < -4 || x >= 1e+21 || x.toFixed(0).length > prec)
            {var i=j - 1;
             while(s.charAt(i) == "0")i--;
             if(s.charAt(i) == ".")i--;
             s = s.slice(0,i + 1) + s.slice(j);
             i = s.length;
             if(s.charAt(i - 3) == "e")
              s = s.slice(0,i - 1) + "0" + s.slice(i - 1);
             break}
           else
            {var p=prec;
             if(exp < 0)
              {p -= exp + 1;s = x.toFixed(p)}
             else
              while(s = x.toFixed(p),s.length > prec + 1)p--;
             if(p)
              {var i=s.length - 1;
               while(s.charAt(i) == "0")i--;
               if(s.charAt(i) == ".")i--;
               s = s.slice(0,i + 1)}}
           break
          }
      return caml_finish_formatting(f,s)}
    function caml_format_int(fmt,i)
     {if(caml_bytes_of_string(fmt) == "%d")return caml_new_string("" + i);
      var f=caml_parse_format(fmt);
      if(i < 0)if(f.signedconv){f.sign = -1;i = -i}else i >>>= 0;
      var s=i.toString(f.base);
      if(f.prec >= 0)
       {f.filler = " ";
        var n=f.prec - s.length;
        if(n > 0)s = caml_str_repeat(n,"0") + s}
      return caml_finish_formatting(f,s)}
    var caml_oo_last_id=0;
    function caml_fresh_oo_id(){return caml_oo_last_id++}
    function caml_greaterequal(x,y)
     {return +(caml_compare_val(x,y,false) >= 0)}
    function caml_greaterthan(x,y){return +(caml_compare_val(x,y,false) > 0)}
    if(!Math.imul)
     Math.imul
     =
     function(x,y){y |= 0;return ((x >> 16) * y << 16) + (x & 65535) * y | 0};
    var caml_mul=Math.imul;
    function caml_hash_mix_int(h,d)
     {d = caml_mul(d,3432918353 | 0);
      d = d << 15 | d >>> 32 - 15;
      d = caml_mul(d,461845907);
      h ^= d;
      h = h << 13 | h >>> 32 - 13;
      return (h + (h << 2) | 0) + (3864292196 | 0) | 0}
    function caml_hash_mix_int64(h,v)
     {var lo=v[1] | v[2] << 24,hi=v[2] >>> 8 | v[3] << 16;
      h = caml_hash_mix_int(h,hi ^ lo);
      return h}
    var log2_ok=Math.log2 && Math.log2(1.12355820928894744e+307) == 1020;
    function jsoo_floor_log2(x)
     {if(log2_ok)return Math.floor(Math.log2(x));
      var i=0;
      if(x == 0)return -Infinity;
      if(x >= 1)while(x >= 2){x /= 2;i++}else while(x < 1){x *= 2;i--}
      return i}
    function caml_int64_bits_of_float(x)
     {if(!isFinite(x))
       {if(isNaN(x))return [255,1,0,32752];
        return x > 0?[255,0,0,32752]:[255,0,0,65520]}
      var sign=x == 0 && 1 / x == -Infinity?32768:x >= 0?0:32768;
      if(sign)x = -x;
      var exp=jsoo_floor_log2(x) + 1023;
      if(exp <= 0)
       {exp = 0;x /= Math.pow(2,-1026)}
      else
       {x /= Math.pow(2,exp - 1027);
        if(x < 16){x *= 2;exp -= 1}
        if(exp == 0)x /= 2}
      var k=Math.pow(2,24),r3=x | 0;
      x = (x - r3) * k;
      var r2=x | 0;
      x = (x - r2) * k;
      var r1=x | 0;
      r3 = r3 & 15 | sign | exp << 4;
      return [255,r1,r2,r3]}
    function caml_hash_mix_float(h,v0)
     {var
       v=caml_int64_bits_of_float(v0),
       lo=v[1] | v[2] << 24,
       hi=v[2] >>> 8 | v[3] << 16;
      h = caml_hash_mix_int(h,lo);
      h = caml_hash_mix_int(h,hi);
      return h}
    function caml_hash_mix_string_arr(h,s)
     {var len=s.length,i,w;
      for(i = 0;i + 4 <= len;i += 4)
       {w = s[i] | s[i + 1] << 8 | s[i + 2] << 16 | s[i + 3] << 24;
        h = caml_hash_mix_int(h,w)}
      w = 0;
      switch(len & 3)
       {case 3:w = s[i + 2] << 16;
        case 2:w |= s[i + 1] << 8;
        case 1:w |= s[i];h = caml_hash_mix_int(h,w)
        }
      h ^= len;
      return h}
    function caml_hash_mix_string_str(h,s)
     {var len=s.length,i,w;
      for(i = 0;i + 4 <= len;i += 4)
       {w
        =
        s.charCodeAt(i)
        |
        s.charCodeAt(i + 1)
        <<
        8
        |
        s.charCodeAt(i + 2)
        <<
        16
        |
        s.charCodeAt(i + 3)
        <<
        24;
        h = caml_hash_mix_int(h,w)}
      w = 0;
      switch(len & 3)
       {case 3:w = s.charCodeAt(i + 2) << 16;
        case 2:w |= s.charCodeAt(i + 1) << 8;
        case 1:w |= s.charCodeAt(i);h = caml_hash_mix_int(h,w)
        }
      h ^= len;
      return h}
    function caml_hash_mix_string(h,v)
     {switch(v.t & 6)
       {default:caml_convert_string_to_bytes(v);case 0:
         h = caml_hash_mix_string_str(h,v.c);break;
        case 2:h = caml_hash_mix_string_arr(h,v.c)
        }
      return h}
    function caml_hash_mix_final(h)
     {h ^= h >>> 16;
      h = caml_mul(h,2246822507 | 0);
      h ^= h >>> 13;
      h = caml_mul(h,3266489909 | 0);
      h ^= h >>> 16;
      return h}
    var HASH_QUEUE_SIZE=256;
    function caml_hash(count,limit,seed,obj)
     {var queue,rd,wr,sz,num,h,v,i,len;
      sz = limit;
      if(sz < 0 || sz > HASH_QUEUE_SIZE)sz = HASH_QUEUE_SIZE;
      num = count;
      h = seed;
      queue = [obj];
      rd = 0;
      wr = 1;
      while(rd < wr && num > 0)
       {v = queue[rd++];
        if(v instanceof Array && v[0] === (v[0] | 0))
         switch(v[0])
          {case 248:h = caml_hash_mix_int(h,v[2]);num--;break;
           case 250:queue[--rd] = v[1];break;
           case 255:h = caml_hash_mix_int64(h,v);num--;break;
           default:
            var tag=v.length - 1 << 10 | v[0];
            h = caml_hash_mix_int(h,tag);
            for(i = 1,len = v.length;i < len;i++)
             {if(wr >= sz)break;queue[wr++] = v[i]}
            break}
        else
         if(v instanceof MlString)
          {h = caml_hash_mix_string(h,v);num--}
         else
          if(v === (v | 0))
           {h = caml_hash_mix_int(h,v + v + 1);num--}
          else
           if(v === +v){h = caml_hash_mix_float(h,v);num--}}
      h = caml_hash_mix_final(h);
      return h & 1073741823}
    function caml_int64_to_bytes(x)
     {return [x[3] >> 8,
              x[3] & 255,
              x[2] >> 16,
              x[2] >> 8 & 255,
              x[2] & 255,
              x[1] >> 16,
              x[1] >> 8 & 255,
              x[1] & 255]}
    function caml_hash_univ_param(count,limit,obj)
     {var hash_accu=0;
      function hash_aux(obj)
       {limit--;
        if(count < 0 || limit < 0)return;
        if(obj instanceof Array && obj[0] === (obj[0] | 0))
         switch(obj[0])
          {case 248:count--;hash_accu = hash_accu * 65599 + obj[2] | 0;break;
           case 250:limit++;hash_aux(obj);break;
           case 255:
            count--;
            hash_accu = hash_accu * 65599 + obj[1] + (obj[2] << 24) | 0;
            break;
           default:
            count--;
            hash_accu = hash_accu * 19 + obj[0] | 0;
            for(var i=obj.length - 1;i > 0;i--)hash_aux(obj[i])}
        else
         if(obj instanceof MlString)
          {count--;
           switch(obj.t & 6)
            {default:caml_convert_string_to_bytes(obj);case 0:
              for(var b=obj.c,l=obj.l,i=0;i < l;i++)
               hash_accu = hash_accu * 19 + b.charCodeAt(i) | 0;
              break;
             case 2:
              for(var a=obj.c,l=obj.l,i=0;i < l;i++)
               hash_accu = hash_accu * 19 + a[i] | 0
             }}
         else
          if(obj === (obj | 0))
           {count--;hash_accu = hash_accu * 65599 + obj | 0}
          else
           if(obj === +obj)
            {count--;
             var p=caml_int64_to_bytes(caml_int64_bits_of_float(obj));
             for(var i=7;i >= 0;i--)hash_accu = hash_accu * 19 + p[i] | 0}}
      hash_aux(obj);
      return hash_accu & 1073741823}
    function caml_utf8_of_utf16(s)
     {for(var b="",t=b,c,d,i=0,l=s.length;i < l;i++)
       {c = s.charCodeAt(i);
        if(c < 128)
         {for(var j=i + 1;j < l && (c = s.charCodeAt(j)) < 128;j++);
          if(j - i > 512)
           {t.substr(0,1);b += t;t = "";b += s.slice(i,j)}
          else
           t += s.slice(i,j);
          if(j == l)break;
          i = j}
        if(c < 2048)
         {t += String.fromCharCode(192 | c >> 6);
          t += String.fromCharCode(128 | c & 63)}
        else
         if(c < 55296 || c >= 57343)
          t
          +=
          String.fromCharCode(224 | c >> 12,128 | c >> 6 & 63,128 | c & 63);
         else
          if
           (c
            >=
            56319
            ||
            i
            +
            1
            ==
            l
            ||
            (d = s.charCodeAt(i + 1))
            <
            56320
            ||
            d
            >
            57343)
           t += "\xef\xbf\xbd";
          else
           {i++;
            c = (c << 10) + d - 56613888;
            t
            +=
            String.fromCharCode
             (240 | c >> 18,128 | c >> 12 & 63,128 | c >> 6 & 63,128 | c & 63)}
        if(t.length > 1024){t.substr(0,1);b += t;t = ""}}
      return b + t}
    function caml_js_to_string(s)
     {var tag=9;
      if(!caml_is_ascii(s))tag = 8,s = caml_utf8_of_utf16(s);
      return new MlString(tag,s,s.length)}
    function caml_hexstring_of_float(x,prec,style)
     {if(!isFinite(x))
       {if(isNaN(x))return caml_js_to_string("nan");
        return caml_js_to_string(x > 0?"infinity":"-infinity")}
      var sign=x == 0 && 1 / x == -Infinity?1:x >= 0?0:1;
      if(sign)x = -x;
      var exp=0;
      if(x == 0)
       ;
      else
       if(x < 1)
        while(x < 1 && exp > -1022){x *= 2;exp--}
       else
        while(x >= 2){x /= 2;exp++}
      var exp_sign=exp < 0?"":"+",sign_str="";
      if(sign)
       sign_str = "-";
      else
       switch(style)
        {case 43:sign_str = "+";break;
         case 32:sign_str = " ";break;
         default:break}
      if(prec >= 0 && prec < 13)
       {var cst=Math.pow(2,prec * 4);x = Math.round(x * cst) / cst}
      var x_str=x.toString(16);
      if(prec >= 0)
       {var idx=x_str.indexOf(".");
        if(idx < 0)
         x_str += "." + caml_str_repeat(prec,"0");
        else
         {var size=idx + 1 + prec;
          if(x_str.length < size)
           x_str += caml_str_repeat(size - x_str.length,"0");
          else
           x_str = x_str.substr(0,size)}}
      return caml_js_to_string
              (sign_str + "0x" + x_str + "p" + exp_sign + exp.toString(10))}
    function caml_int64_add(x,y)
     {var
       z1=x[1] + y[1],
       z2=x[2] + y[2] + (z1 >> 24),
       z3=x[3] + y[3] + (z2 >> 24);
      return [255,z1 & 16777215,z2 & 16777215,z3 & 65535]}
    function caml_int64_neg(x)
     {var y1=-x[1],y2=-x[2] + (y1 >> 24),y3=-x[3] + (y2 >> 24);
      return [255,y1 & 16777215,y2 & 16777215,y3 & 65535]}
    function caml_obj_dup(x)
     {var l=x.length,a=new Array(l);
      for(var i=0;i < l;i++)a[i] = x[i];
      return a}
    function caml_int64_sub(x,y)
     {var
       z1=x[1] - y[1],
       z2=x[2] - y[2] + (z1 >> 24),
       z3=x[3] - y[3] + (z2 >> 24);
      return [255,z1 & 16777215,z2 & 16777215,z3 & 65535]}
    function caml_int64_ucompare(x,y)
     {if(x[3] > y[3])return 1;
      if(x[3] < y[3])return -1;
      if(x[2] > y[2])return 1;
      if(x[2] < y[2])return -1;
      if(x[1] > y[1])return 1;
      if(x[1] < y[1])return -1;
      return 0}
    function caml_int64_lsl1(x)
     {x[3] = x[3] << 1 | x[2] >> 23;
      x[2] = (x[2] << 1 | x[1] >> 23) & 16777215;
      x[1] = x[1] << 1 & 16777215}
    function caml_int64_lsr1(x)
     {x[1] = (x[1] >>> 1 | x[2] << 23) & 16777215;
      x[2] = (x[2] >>> 1 | x[3] << 23) & 16777215;
      x[3] = x[3] >>> 1}
    function caml_int64_udivmod(x,y)
     {var
       offset=0,
       modulus=caml_obj_dup(x),
       divisor=caml_obj_dup(y),
       quotient=[255,0,0,0];
      while(caml_int64_ucompare(modulus,divisor) > 0)
       {offset++;caml_int64_lsl1(divisor)}
      while(offset >= 0)
       {offset--;
        caml_int64_lsl1(quotient);
        if(caml_int64_ucompare(modulus,divisor) >= 0)
         {quotient[1]++;modulus = caml_int64_sub(modulus,divisor)}
        caml_int64_lsr1(divisor)}
      return [0,quotient,modulus]}
    function caml_int64_is_zero(x){return (x[3] | x[2] | x[1]) == 0}
    function caml_int64_div(x,y)
     {if(caml_int64_is_zero(y))caml_raise_zero_divide();
      var sign=x[3] ^ y[3];
      if(x[3] & 32768)x = caml_int64_neg(x);
      if(y[3] & 32768)y = caml_int64_neg(y);
      var q=caml_int64_udivmod(x,y)[1];
      if(sign & 32768)q = caml_int64_neg(q);
      return q}
    function caml_int64_float_of_bits(x)
     {var exp=(x[3] & 32767) >> 4;
      if(exp == 2047)
       return (x[1] | x[2] | x[3] & 15) == 0
               ?x[3] & 32768?-Infinity:Infinity
               :NaN;
      var k=Math.pow(2,-24),res=(x[1] * k + x[2]) * k + (x[3] & 15);
      if(exp > 0)
       {res += 16;res *= Math.pow(2,exp - 1027)}
      else
       res *= Math.pow(2,-1026);
      if(x[3] & 32768)res = -res;
      return res}
    function caml_int64_of_int32(x)
     {return [255,x & 16777215,x >> 24 & 16777215,x >> 31 & 65535]}
    function caml_int64_to_int32(x){return x[1] | x[2] << 24}
    function caml_int64_is_negative(x){return x[3] << 16 < 0}
    function caml_int64_format(fmt,x)
     {var f=caml_parse_format(fmt);
      if(f.signedconv && caml_int64_is_negative(x))
       {f.sign = -1;x = caml_int64_neg(x)}
      var
       buffer="",
       wbase=caml_int64_of_int32(f.base),
       cvtbl="0123456789abcdef";
      do
       {var p=caml_int64_udivmod(x,wbase);
        x = p[1];
        buffer = cvtbl.charAt(caml_int64_to_int32(p[2])) + buffer}
      while
       (!caml_int64_is_zero(x));
      if(f.prec >= 0)
       {f.filler = " ";
        var n=f.prec - buffer.length;
        if(n > 0)buffer = caml_str_repeat(n,"0") + buffer}
      return caml_finish_formatting(f,buffer)}
    var caml_int64_offset=Math.pow(2,-24);
    function caml_int64_mul(x,y)
     {var
       z1=x[1] * y[1],
       z2=(z1 * caml_int64_offset | 0) + x[2] * y[1] + x[1] * y[2],
       z3=
        (z2 * caml_int64_offset | 0)
        +
        x[3]
        *
        y[1]
        +
        x[2]
        *
        y[2]
        +
        x[1]
        *
        y[3];
      return [255,z1 & 16777215,z2 & 16777215,z3 & 65535]}
    function caml_string_unsafe_get(s,i)
     {switch(s.t & 6)
       {default:if(i >= s.c.length)return 0;case 0:return s.c.charCodeAt(i);
        case 4:return s.c[i]
        }}
    function caml_ml_string_length(s){return s.l}
    function caml_parse_sign_and_base(s)
     {var
       i=0,
       len=caml_ml_string_length(s),
       base=10,
       sign=len > 0 && caml_string_unsafe_get(s,0) == 45?(i++,-1):1;
      if(i + 1 < len && caml_string_unsafe_get(s,i) == 48)
       switch(caml_string_unsafe_get(s,i + 1))
        {case 120:
         case 88:base = 16;i += 2;break;
         case 111:
         case 79:base = 8;i += 2;break;
         case 98:
         case 66:base = 2;i += 2;break
         }
      return [i,sign,base]}
    function caml_parse_digit(c)
     {if(c >= 48 && c <= 57)return c - 48;
      if(c >= 65 && c <= 90)return c - 55;
      if(c >= 97 && c <= 122)return c - 87;
      return -1}
    function caml_failwith(msg)
     {caml_raise_with_string(caml_global_data.Failure,msg)}
    function caml_int_of_string(s)
     {var
       r=caml_parse_sign_and_base(s),
       i=r[0],
       sign=r[1],
       base=r[2],
       len=caml_ml_string_length(s),
       threshold=-1 >>> 0,
       c=i < len?caml_string_unsafe_get(s,i):0,
       d=caml_parse_digit(c);
      if(d < 0 || d >= base)caml_failwith("int_of_string");
      var res=d;
      for(i++;i < len;i++)
       {c = caml_string_unsafe_get(s,i);
        if(c == 95)continue;
        d = caml_parse_digit(c);
        if(d < 0 || d >= base)break;
        res = base * res + d;
        if(res > threshold)caml_failwith("int_of_string")}
      if(i != len)caml_failwith("int_of_string");
      res = sign * res;
      if(base == 10 && (res | 0) != res)caml_failwith("int_of_string");
      return res | 0}
    function caml_lessequal(x,y){return +(caml_compare_val(x,y,false) <= 0)}
    function caml_lessthan(x,y){return +(caml_compare_val(x,y,false) < 0)}
    function caml_log10_float(x){return Math.LOG10E * Math.log(x)}
    function caml_make_vect(len,init)
     {var len=len + 1 | 0,b=new Array(len);
      b[0] = 0;
      for(var i=1;i < len;i++)b[i] = init;
      return b}
    function caml_string_of_array(a){return new MlString(4,a,a.length)}
    var
     caml_md5_string=
      function()
        {function add(x,y){return x + y | 0}
         function xx(q,a,b,x,s,t)
          {a = add(add(a,q),add(x,t));return add(a << s | a >>> 32 - s,b)}
         function ff(a,b,c,d,x,s,t){return xx(b & c | ~b & d,a,b,x,s,t)}
         function gg(a,b,c,d,x,s,t){return xx(b & d | c & ~d,a,b,x,s,t)}
         function hh(a,b,c,d,x,s,t){return xx(b ^ c ^ d,a,b,x,s,t)}
         function ii(a,b,c,d,x,s,t){return xx(c ^ (b | ~d),a,b,x,s,t)}
         function md5(buffer,length)
          {var i=length;
           buffer[i >> 2] |= 128 << 8 * (i & 3);
           for(i = (i & ~3) + 8;(i & 63) < 60;i += 4)buffer[(i >> 2) - 1] = 0;
           buffer[(i >> 2) - 1] = length << 3;
           buffer[i >> 2] = length >> 29 & 536870911;
           var w=[1732584193,4023233417,2562383102,271733878];
           for(i = 0;i < buffer.length;i += 16)
            {var a=w[0],b=w[1],c=w[2],d=w[3];
             a = ff(a,b,c,d,buffer[i + 0],7,3614090360);
             d = ff(d,a,b,c,buffer[i + 1],12,3905402710);
             c = ff(c,d,a,b,buffer[i + 2],17,606105819);
             b = ff(b,c,d,a,buffer[i + 3],22,3250441966);
             a = ff(a,b,c,d,buffer[i + 4],7,4118548399);
             d = ff(d,a,b,c,buffer[i + 5],12,1200080426);
             c = ff(c,d,a,b,buffer[i + 6],17,2821735955);
             b = ff(b,c,d,a,buffer[i + 7],22,4249261313);
             a = ff(a,b,c,d,buffer[i + 8],7,1770035416);
             d = ff(d,a,b,c,buffer[i + 9],12,2336552879);
             c = ff(c,d,a,b,buffer[i + 10],17,4294925233);
             b = ff(b,c,d,a,buffer[i + 11],22,2304563134);
             a = ff(a,b,c,d,buffer[i + 12],7,1804603682);
             d = ff(d,a,b,c,buffer[i + 13],12,4254626195);
             c = ff(c,d,a,b,buffer[i + 14],17,2792965006);
             b = ff(b,c,d,a,buffer[i + 15],22,1236535329);
             a = gg(a,b,c,d,buffer[i + 1],5,4129170786);
             d = gg(d,a,b,c,buffer[i + 6],9,3225465664);
             c = gg(c,d,a,b,buffer[i + 11],14,643717713);
             b = gg(b,c,d,a,buffer[i + 0],20,3921069994);
             a = gg(a,b,c,d,buffer[i + 5],5,3593408605);
             d = gg(d,a,b,c,buffer[i + 10],9,38016083);
             c = gg(c,d,a,b,buffer[i + 15],14,3634488961);
             b = gg(b,c,d,a,buffer[i + 4],20,3889429448);
             a = gg(a,b,c,d,buffer[i + 9],5,568446438);
             d = gg(d,a,b,c,buffer[i + 14],9,3275163606);
             c = gg(c,d,a,b,buffer[i + 3],14,4107603335);
             b = gg(b,c,d,a,buffer[i + 8],20,1163531501);
             a = gg(a,b,c,d,buffer[i + 13],5,2850285829);
             d = gg(d,a,b,c,buffer[i + 2],9,4243563512);
             c = gg(c,d,a,b,buffer[i + 7],14,1735328473);
             b = gg(b,c,d,a,buffer[i + 12],20,2368359562);
             a = hh(a,b,c,d,buffer[i + 5],4,4294588738);
             d = hh(d,a,b,c,buffer[i + 8],11,2272392833);
             c = hh(c,d,a,b,buffer[i + 11],16,1839030562);
             b = hh(b,c,d,a,buffer[i + 14],23,4259657740);
             a = hh(a,b,c,d,buffer[i + 1],4,2763975236);
             d = hh(d,a,b,c,buffer[i + 4],11,1272893353);
             c = hh(c,d,a,b,buffer[i + 7],16,4139469664);
             b = hh(b,c,d,a,buffer[i + 10],23,3200236656);
             a = hh(a,b,c,d,buffer[i + 13],4,681279174);
             d = hh(d,a,b,c,buffer[i + 0],11,3936430074);
             c = hh(c,d,a,b,buffer[i + 3],16,3572445317);
             b = hh(b,c,d,a,buffer[i + 6],23,76029189);
             a = hh(a,b,c,d,buffer[i + 9],4,3654602809);
             d = hh(d,a,b,c,buffer[i + 12],11,3873151461);
             c = hh(c,d,a,b,buffer[i + 15],16,530742520);
             b = hh(b,c,d,a,buffer[i + 2],23,3299628645);
             a = ii(a,b,c,d,buffer[i + 0],6,4096336452);
             d = ii(d,a,b,c,buffer[i + 7],10,1126891415);
             c = ii(c,d,a,b,buffer[i + 14],15,2878612391);
             b = ii(b,c,d,a,buffer[i + 5],21,4237533241);
             a = ii(a,b,c,d,buffer[i + 12],6,1700485571);
             d = ii(d,a,b,c,buffer[i + 3],10,2399980690);
             c = ii(c,d,a,b,buffer[i + 10],15,4293915773);
             b = ii(b,c,d,a,buffer[i + 1],21,2240044497);
             a = ii(a,b,c,d,buffer[i + 8],6,1873313359);
             d = ii(d,a,b,c,buffer[i + 15],10,4264355552);
             c = ii(c,d,a,b,buffer[i + 6],15,2734768916);
             b = ii(b,c,d,a,buffer[i + 13],21,1309151649);
             a = ii(a,b,c,d,buffer[i + 4],6,4149444226);
             d = ii(d,a,b,c,buffer[i + 11],10,3174756917);
             c = ii(c,d,a,b,buffer[i + 2],15,718787259);
             b = ii(b,c,d,a,buffer[i + 9],21,3951481745);
             w[0] = add(a,w[0]);
             w[1] = add(b,w[1]);
             w[2] = add(c,w[2]);
             w[3] = add(d,w[3])}
           var t=new Array(16);
           for(var i=0;i < 4;i++)
            for(var j=0;j < 4;j++)t[i * 4 + j] = w[i] >> 8 * j & 255;
           return t}
         return function(s,ofs,len)
          {var buf=[];
           switch(s.t & 6)
            {default:caml_convert_string_to_bytes(s);case 0:
              var b=s.c;
              for(var i=0;i < len;i += 4)
               {var j=i + ofs;
                buf[i >> 2]
                =
                b.charCodeAt(j)
                |
                b.charCodeAt(j + 1)
                <<
                8
                |
                b.charCodeAt(j + 2)
                <<
                16
                |
                b.charCodeAt(j + 3)
                <<
                24}
              for(;i < len;i++)
               buf[i >> 2] |= b.charCodeAt(i + ofs) << 8 * (i & 3);
              break;
             case 4:
              var a=s.c;
              for(var i=0;i < len;i += 4)
               {var j=i + ofs;
                buf[i >> 2]
                =
                a[j]
                |
                a[j + 1]
                <<
                8
                |
                a[j + 2]
                <<
                16
                |
                a[j + 3]
                <<
                24}
              for(;i < len;i++)buf[i >> 2] |= a[i + ofs] << 8 * (i & 3)
             }
           return caml_string_of_array(md5(buf,len))}}
       ();
    function caml_ml_bytes_length(s){return s.l}
    function caml_raise_sys_error(msg)
     {caml_raise_with_string(caml_global_data.Sys_error,msg)}
    var caml_ml_channels=new Array();
    function caml_ml_flush(chanid)
     {var chan=caml_ml_channels[chanid];
      if(!chan.opened)caml_raise_sys_error("Cannot flush a closed channel");
      if(!chan.buffer || chan.buffer == "")return 0;
      if
       (chan.fd
        &&
        caml_global_data.fds[chan.fd]
        &&
        caml_global_data.fds[chan.fd].output)
       {var output=caml_global_data.fds[chan.fd].output;
        switch(output.length)
         {case 2:output(chanid,chan.buffer);break;default:output(chan.buffer)}}
      chan.buffer = "";
      return 0}
    function caml_ml_refill_input(chan)
     {var str=chan.refill(),str_len=caml_ml_string_length(str);
      if(str_len == 0)chan.refill = null;
      chan.file.write(chan.file.length(),str,0,str_len);
      return str_len}
    function caml_ml_input(chanid,s,i,l)
     {var chan=caml_ml_channels[chanid],l2=chan.file.length() - chan.offset;
      if(l2 == 0 && chan.refill != null)l2 = caml_ml_refill_input(chan);
      if(l2 < l)l = l2;
      chan.file.read(chan.offset,s,i,l);
      chan.offset += l;
      return l}
    if(joo_global_object.process && joo_global_object.process.cwd)
     var caml_current_dir=joo_global_object.process.cwd().replace(/\\/g,"/");
    else
     var caml_current_dir="/static";
    if(caml_current_dir.slice(-1) !== "/")caml_current_dir += "/";
    function caml_make_path(name)
     {name = name instanceof MlString?name.toString():name;
      if(name.charCodeAt(0) != 47)name = caml_current_dir + name;
      var comp=name.split("/"),ncomp=[];
      for(var i=0;i < comp.length;i++)
       switch(comp[i])
        {case "..":if(ncomp.length > 1)ncomp.pop();break;
         case ".":break;
         case "":if(ncomp.length == 0)ncomp.push("");break;
         default:ncomp.push(comp[i]);break}
      ncomp.orig = name;
      return ncomp}
    function caml_raise_no_such_file(name)
     {name = name instanceof MlString?name.toString():name;
      caml_raise_sys_error(name + ": No such file or directory")}
    function caml_string_get(s,i)
     {if(i >>> 0 >= s.l)caml_string_bound_error();
      return caml_string_unsafe_get(s,i)}
    function caml_create_string(len)
     {if(len < 0)caml_invalid_argument("String.create");
      return new MlString(len?2:9,"",len)}
    function MlFile(){}
    function MlFakeFile(content){this.data = content}
    MlFakeFile.prototype = new MlFile();
    MlFakeFile.prototype.truncate
    =
    function(len)
     {var old=this.data;
      this.data = caml_create_string(len | 0);
      caml_blit_string(old,0,this.data,0,len)};
    MlFakeFile.prototype.length
    =
    function(){return caml_ml_string_length(this.data)};
    MlFakeFile.prototype.write
    =
    function(offset,buf,pos,len)
     {var clen=this.length();
      if(offset + len >= clen)
       {var new_str=caml_create_string(offset + len),old_data=this.data;
        this.data = new_str;
        caml_blit_string(old_data,0,this.data,0,clen)}
      caml_blit_string(buf,pos,this.data,offset,len);
      return 0};
    MlFakeFile.prototype.read
    =
    function(offset,buf,pos,len)
     {var clen=this.length();
      caml_blit_string(this.data,offset,buf,pos,len);
      return 0};
    MlFakeFile.prototype.read_one
    =
    function(offset){return caml_string_get(this.data,offset)};
    MlFakeFile.prototype.close = function(){};
    MlFakeFile.prototype.constructor = MlFakeFile;
    function MlFakeDevice(root,f)
     {this.content = {};this.root = root;this.lookupFun = f}
    MlFakeDevice.prototype.nm = function(name){return this.root + name};
    MlFakeDevice.prototype.lookup
    =
    function(name)
     {if(!this.content[name] && this.lookupFun)
       {var
         res=
          this.lookupFun(caml_new_string(this.root),caml_new_string(name));
        if(res != 0)this.content[name] = new MlFakeFile(res[1])}};
    MlFakeDevice.prototype.exists
    =
    function(name)
     {if(name == "")return 1;
      var name_slash=name + "/",r=new RegExp("^" + name_slash);
      for(var n in this.content)if(n.match(r))return 1;
      this.lookup(name);
      return this.content[name]?1:0};
    MlFakeDevice.prototype.readdir
    =
    function(name)
     {var
       name_slash=name == ""?"":name + "/",
       r=new RegExp("^" + name_slash + "([^/]*)"),
       seen={},
       a=[];
      for(var n in this.content)
       {var m=n.match(r);if(m && !seen[m[1]]){seen[m[1]] = true;a.push(m[1])}}
      return a};
    MlFakeDevice.prototype.is_dir
    =
    function(name)
     {var
       name_slash=name == ""?"":name + "/",
       r=new RegExp("^" + name_slash + "([^/]*)"),
       a=[];
      for(var n in this.content){var m=n.match(r);if(m)return 1}
      return 0};
    MlFakeDevice.prototype.unlink
    =
    function(name)
     {var ok=this.content[name]?true:false;
      delete this.content[name];
      return ok};
    MlFakeDevice.prototype.open
    =
    function(name,f)
     {if(f.rdonly && f.wronly)
       caml_raise_sys_error
        (this.nm(name)
         +
         " : flags Open_rdonly and Open_wronly are not compatible");
      if(f.text && f.binary)
       caml_raise_sys_error
        (this.nm(name)
         +
         " : flags Open_text and Open_binary are not compatible");
      this.lookup(name);
      if(this.content[name])
       {if(this.is_dir(name))
         caml_raise_sys_error(this.nm(name) + " : is a directory");
        if(f.create && f.excl)
         caml_raise_sys_error(this.nm(name) + " : file already exists");
        var file=this.content[name];
        if(f.truncate)file.truncate();
        return file}
      else
       if(f.create)
        {this.content[name] = new MlFakeFile(caml_create_string(0));
         return this.content[name]}
       else
        caml_raise_no_such_file(this.nm(name))};
    MlFakeDevice.prototype.register
    =
    function(name,content)
     {if(this.content[name])
       caml_raise_sys_error(this.nm(name) + " : file already exists");
      if(content instanceof MlString)
       this.content[name] = new MlFakeFile(content);
      else
       if(content instanceof Array)
        this.content[name] = new MlFakeFile(caml_string_of_array(content));
       else
        if(content.toString)
         {var mlstring=caml_new_string(content.toString());
          this.content[name] = new MlFakeFile(mlstring)}};
    MlFakeDevice.prototype.constructor = MlFakeDevice;
    function caml_array_of_string(s)
     {if(s.t != 4)caml_convert_string_to_array(s);return s.c}
    function caml_string_unsafe_set(s,i,c)
     {c &= 255;
      if(s.t != 4)
       {if(i == s.c.length)
         {s.c += String.fromCharCode(c);if(i + 1 == s.l)s.t = 0;return 0}
        caml_convert_string_to_array(s)}
      s.c[i] = c;
      return 0}
    function caml_string_set(s,i,c)
     {if(i >>> 0 >= s.l)caml_string_bound_error();
      return caml_string_unsafe_set(s,i,c)}
    var Buffer=joo_global_object.Buffer;
    function MlNodeFile(fd){this.fs = require("fs");this.fd = fd}
    MlNodeFile.prototype = new MlFile();
    MlNodeFile.prototype.truncate
    =
    function(len){this.fs.ftruncateSync(this.fd,len | 0)};
    MlNodeFile.prototype.length
    =
    function(){return this.fs.fstatSync(this.fd).size};
    MlNodeFile.prototype.write
    =
    function(offset,buf,buf_offset,len)
     {var a=caml_array_of_string(buf);
      if(!a instanceof joo_global_object.Uint8Array)
       a = new (joo_global_object.Uint8Array)(a);
      var buffer=new Buffer(a);
      this.fs.writeSync(this.fd,buffer,buf_offset,len,offset);
      return 0};
    MlNodeFile.prototype.read
    =
    function(offset,buf,buf_offset,len)
     {var a=caml_array_of_string(buf);
      if(!(a instanceof joo_global_object.Uint8Array))
       a = new (joo_global_object.Uint8Array)(a);
      var buffer=new Buffer(a);
      this.fs.readSync(this.fd,buffer,buf_offset,len,offset);
      for(var i=0;i < len;i++)
       caml_string_set(buf,buf_offset + i,buffer[buf_offset + i]);
      return 0};
    MlNodeFile.prototype.read_one
    =
    function(offset)
     {var a=new (joo_global_object.Uint8Array)(1),buffer=new Buffer(a);
      this.fs.readSync(this.fd,buffer,0,1,offset);
      return buffer[0]};
    MlNodeFile.prototype.close = function(){this.fs.closeSync(this.fd)};
    MlNodeFile.prototype.constructor = MlNodeFile;
    function MlNodeDevice(root){this.fs = require("fs");this.root = root}
    MlNodeDevice.prototype.nm = function(name){return this.root + name};
    MlNodeDevice.prototype.exists
    =
    function(name){return this.fs.existsSync(this.nm(name))?1:0};
    MlNodeDevice.prototype.readdir
    =
    function(name){return this.fs.readdirSync(this.nm(name))};
    MlNodeDevice.prototype.is_dir
    =
    function(name){return this.fs.statSync(this.nm(name)).isDirectory()?1:0};
    MlNodeDevice.prototype.unlink
    =
    function(name)
     {var b=this.fs.existsSync(this.nm(name))?1:0;
      this.fs.unlinkSync(this.nm(name));
      return b};
    MlNodeDevice.prototype.open
    =
    function(name,f)
     {var consts=require("constants"),res=0;
      for(var key in f)
       switch(key)
        {case "rdonly":res |= consts.O_RDONLY;break;
         case "wronly":res |= consts.O_WRONLY;break;
         case "append":res |= consts.O_WRONLY | consts.O_APPEND;break;
         case "create":res |= consts.O_CREAT;break;
         case "truncate":res |= consts.O_TRUNC;break;
         case "excl":res |= consts.O_EXCL;break;
         case "binary":res |= consts.O_BINARY;break;
         case "text":res |= consts.O_TEXT;break;
         case "nonblock":res |= consts.O_NONBLOCK;break
         }
      var fd=this.fs.openSync(this.nm(name),res);
      return new MlNodeFile(fd)};
    MlNodeDevice.prototype.rename
    =
    function(o,n){this.fs.renameSync(this.nm(o),this.nm(n))};
    MlNodeDevice.prototype.constructor = MlNodeDevice;
    var caml_root=caml_current_dir.match(/[^\/]*\//)[0],jsoo_mount_point=[];
    if
     (typeof module
      !==
      "undefined"
      &&
      module.exports
      &&
      typeof require
      !==
      "undefined")
     jsoo_mount_point.push
      ({path:caml_root,device:new MlNodeDevice(caml_root)});
    else
     jsoo_mount_point.push
      ({path:caml_root,device:new MlFakeDevice(caml_root)});
    jsoo_mount_point.push
     ({path:caml_root + "static/",
       device:new MlFakeDevice(caml_root + "static/")});
    function resolve_fs_device(name)
     {var
       path=caml_make_path(name),
       name=path.join("/"),
       name_slash=name + "/",
       res;
      for(var i=0;i < jsoo_mount_point.length;i++)
       {var m=jsoo_mount_point[i];
        if
         (name_slash.search(m.path)
          ==
          0
          &&
          (!res || res.path.length < m.path.length))
         res
         =
         {path:m.path,
          device:m.device,
          rest:name.substring(m.path.length,name.length)}}
      return res}
    function caml_std_output(chanid,s)
     {var
       chan=caml_ml_channels[chanid],
       str=caml_new_string(s),
       slen=caml_ml_string_length(str);
      chan.file.write(chan.offset,str,0,slen);
      chan.offset += slen;
      return 0}
    function js_print_stderr(s)
     {var g=joo_global_object;
      if(g.process && g.process.stdout && g.process.stdout.write)
       g.process.stderr.write(s);
      else
       {if(s.charCodeAt(s.length - 1) == 10)s = s.substr(0,s.length - 1);
        var v=g.console;
        v && v.error && v.error(s)}}
    function js_print_stdout(s)
     {var g=joo_global_object;
      if(g.process && g.process.stdout && g.process.stdout.write)
       g.process.stdout.write(s);
      else
       {if(s.charCodeAt(s.length - 1) == 10)s = s.substr(0,s.length - 1);
        var v=g.console;
        v && v.log && v.log(s)}}
    function caml_sys_open_internal(idx,output,file,flags)
     {if(caml_global_data.fds === undefined)
       caml_global_data.fds = new Array();
      flags = flags?flags:{};
      var info={};
      info.file = file;
      info.offset = flags.append?file.length():0;
      info.flags = flags;
      info.output = output;
      caml_global_data.fds[idx] = info;
      if(!caml_global_data.fd_last_idx || idx > caml_global_data.fd_last_idx)
       caml_global_data.fd_last_idx = idx;
      return idx}
    function caml_sys_open(name,flags,_perms)
     {var f={};
      while(flags)
       {switch(flags[1])
         {case 0:f.rdonly = 1;break;
          case 1:f.wronly = 1;break;
          case 2:f.append = 1;break;
          case 3:f.create = 1;break;
          case 4:f.truncate = 1;break;
          case 5:f.excl = 1;break;
          case 6:f.binary = 1;break;
          case 7:f.text = 1;break;
          case 8:f.nonblock = 1;break
          }
        flags = flags[2]}
      if(f.rdonly && f.wronly)
       caml_raise_sys_error
        (name.toString()
         +
         " : flags Open_rdonly and Open_wronly are not compatible");
      if(f.text && f.binary)
       caml_raise_sys_error
        (name.toString()
         +
         " : flags Open_text and Open_binary are not compatible");
      var
       root=resolve_fs_device(name),
       file=root.device.open(root.rest,f),
       idx=caml_global_data.fd_last_idx?caml_global_data.fd_last_idx:0;
      return caml_sys_open_internal(idx + 1,caml_std_output,file,f)}
    caml_sys_open_internal
     (0,caml_std_output,new MlFakeFile(caml_create_string(0)));
    caml_sys_open_internal
     (1,js_print_stdout,new MlFakeFile(caml_create_string(0)));
    caml_sys_open_internal
     (2,js_print_stderr,new MlFakeFile(caml_create_string(0)));
    function caml_ml_open_descriptor_in(fd)
     {var data=caml_global_data.fds[fd];
      if(data.flags.wronly)caml_raise_sys_error("fd " + fd + " is writeonly");
      var
       channel=
        {file:data.file,
         offset:data.offset,
         fd:fd,
         opened:true,
         out:false,
         refill:null};
      caml_ml_channels[channel.fd] = channel;
      return channel.fd}
    function caml_ml_open_descriptor_out(fd)
     {var data=caml_global_data.fds[fd];
      if(data.flags.rdonly)caml_raise_sys_error("fd " + fd + " is readonly");
      var
       channel=
        {file:data.file,
         offset:data.offset,
         fd:fd,
         opened:true,
         out:true,
         buffer:""};
      caml_ml_channels[channel.fd] = channel;
      return channel.fd}
    function caml_ml_out_channels_list()
     {var l=0;
      for(var c=0;c < caml_ml_channels.length;c++)
       if
        (caml_ml_channels[c]
         &&
         caml_ml_channels[c].opened
         &&
         caml_ml_channels[c].out)
        l = [0,caml_ml_channels[c].fd,l];
      return l}
    function caml_ml_output(chanid,buffer,offset,len)
     {var chan=caml_ml_channels[chanid];
      if(!chan.opened)
       caml_raise_sys_error("Cannot output to a closed channel");
      var string;
      if(offset == 0 && caml_ml_string_length(buffer) == len)
       string = buffer;
      else
       {string = caml_create_string(len);
        caml_blit_string(buffer,offset,string,0,len)}
      var jsstring=string.toString(),id=jsstring.lastIndexOf("\n");
      if(id < 0)
       chan.buffer += jsstring;
      else
       {chan.buffer += jsstring.substr(0,id + 1);
        caml_ml_flush(chanid);
        chan.buffer += jsstring.substr(id + 1)}
      return 0}
    function caml_ml_output_char(chanid,c)
     {var s=caml_new_string(String.fromCharCode(c));
      caml_ml_output(chanid,s,0,1);
      return 0}
    function caml_mod(x,y){if(y == 0)caml_raise_zero_divide();return x % y}
    function caml_modf_float(x)
     {if(isFinite(x))
       {var neg=1 / x < 0;
        x = Math.abs(x);
        var i=Math.floor(x),f=x - i;
        if(neg){i = -i;f = -f}
        return [0,f,i]}
      if(isNaN(x))return [0,NaN,NaN];
      return [0,1 / x,x]}
    function caml_notequal(x,y){return +(caml_compare_val(x,y,false) != 0)}
    function caml_obj_set_tag(x,tag){x[0] = tag;return 0}
    function caml_obj_tag(x)
     {return x instanceof Array?x[0]:x instanceof MlString?252:1e3}
    function caml_register_global(n,v,name_opt)
     {caml_global_data[n + 1] = v;if(name_opt)caml_global_data[name_opt] = v}
    var caml_named_values={};
    function caml_register_named_value(nm,v)
     {caml_named_values[caml_bytes_of_string(nm)] = v;return 0}
    function caml_sinh_float(x){return (Math.exp(x) - Math.exp(-x)) / 2}
    function caml_string_equal(s1,s2)
     {if(s1 === s2)return 1;
      s1.t & 6 && caml_convert_string_to_bytes(s1);
      s2.t & 6 && caml_convert_string_to_bytes(s2);
      return s1.c == s2.c?1:0}
    function caml_string_notequal(s1,s2){return 1 - caml_string_equal(s1,s2)}
    function caml_sys_const_max_wosize(){return 2147483647 / 4 | 0}
    function caml_sys_get_config(){return [0,caml_new_string("Unix"),32,0]}
    function caml_raise_not_found()
     {caml_raise_constant(caml_global_data.Not_found)}
    function caml_sys_getenv(name)
     {var g=joo_global_object,n=name.toString();
      if(g.process && g.process.env && g.process.env[n] != undefined)
       return caml_js_to_string(g.process.env[n]);
      caml_raise_not_found()}
    function caml_sys_random_seed()
     {var x=new Date() ^ 4294967295 * Math.random();return [0,x]}
    var caml_initial_time=new Date() * 0.001;
    function caml_sys_time(){return new Date() * 0.001 - caml_initial_time}
    function caml_tanh_float(x)
     {var y=Math.exp(x),z=Math.exp(-x);return (y - z) / (y + z)}
    function caml_trampoline(res)
     {var c=1;
      while(res && res.joo_tramp)
       {res = res.joo_tramp.apply(null,res.joo_args);c++}
      return res}
    function caml_trampoline_return(f,args)
     {return {joo_tramp:f,joo_args:args}}
    function caml_return_exn_constant(tag){return tag}
    function caml_named_value(nm){return caml_named_values[nm]}
    function caml_wrap_exception(e)
     {if(e instanceof Array)return e;
      if
       (joo_global_object.RangeError
        &&
        e instanceof joo_global_object.RangeError
        &&
        e.message
        &&
        e.message.match(/maximum call stack/i))
       return caml_return_exn_constant(caml_global_data.Stack_overflow);
      if
       (joo_global_object.InternalError
        &&
        e instanceof joo_global_object.InternalError
        &&
        e.message
        &&
        e.message.match(/too much recursion/i))
       return caml_return_exn_constant(caml_global_data.Stack_overflow);
      if(e instanceof joo_global_object.Error && caml_named_value("jsError"))
       return [0,caml_named_value("jsError"),e];
      return [0,caml_global_data.Failure,caml_js_to_string(String(e))]}
    function unix_gettimeofday(){return new Date().getTime() / 1e3}
    function unix_inet_addr_of_string(){return 0}
    function unix_localtime(t)
     {var
       d=new Date(t * 1e3),
       januaryfirst=new Date(d.getFullYear(),0,1),
       doy=Math.floor((d - januaryfirst) / 864e5),
       jan=new Date(d.getFullYear(),0,1),
       jul=new Date(d.getFullYear(),6,1),
       stdTimezoneOffset=
        Math.max(jan.getTimezoneOffset(),jul.getTimezoneOffset());
      return [0,
              d.getSeconds(),
              d.getMinutes(),
              d.getHours(),
              d.getDate(),
              d.getMonth(),
              d.getFullYear() - 1900,
              d.getDay(),
              doy,
              d.getTimezoneOffset() < stdTimezoneOffset | 0]}
    function caml_call1(f,a0)
     {return f.length == 1?f(a0):caml_call_gen(f,[a0])}
    function caml_call2(f,a0,a1)
     {return f.length == 2?f(a0,a1):caml_call_gen(f,[a0,a1])}
    function caml_call3(f,a0,a1,a2)
     {return f.length == 3?f(a0,a1,a2):caml_call_gen(f,[a0,a1,a2])}
    function caml_call4(f,a0,a1,a2,a3)
     {return f.length == 4?f(a0,a1,a2,a3):caml_call_gen(f,[a0,a1,a2,a3])}
    function caml_call5(f,a0,a1,a2,a3,a4)
     {return f.length == 5?f(a0,a1,a2,a3,a4):caml_call_gen(f,[a0,a1,a2,a3,a4])}
    function caml_call6(f,a0,a1,a2,a3,a4,a5)
     {return f.length == 6
              ?f(a0,a1,a2,a3,a4,a5)
              :caml_call_gen(f,[a0,a1,a2,a3,a4,a5])}
    function caml_call8(f,a0,a1,a2,a3,a4,a5,a6,a7)
     {return f.length == 8
              ?f(a0,a1,a2,a3,a4,a5,a6,a7)
              :caml_call_gen(f,[a0,a1,a2,a3,a4,a5,a6,a7])}
    var
     Out_of_memory=[248,caml_new_string("Out_of_memory"),-1],
     Sys_error=[248,caml_new_string("Sys_error"),-2],
     Failure=[248,caml_new_string("Failure"),-3],
     Invalid_argument=[248,caml_new_string("Invalid_argument"),-4],
     End_of_file=[248,caml_new_string("End_of_file"),-5],
     Division_by_zero=[248,caml_new_string("Division_by_zero"),-6],
     Not_found=[248,caml_new_string("Not_found"),-7],
     Match_failure=[248,caml_new_string("Match_failure"),-8],
     Stack_overflow=[248,caml_new_string("Stack_overflow"),-9],
     Sys_blocked_io=[248,caml_new_string("Sys_blocked_io"),-10],
     Assert_failure=[248,caml_new_string("Assert_failure"),-11],
     Undefined_recursive_module=
      [248,caml_new_string("Undefined_recursive_module"),-12],
     param=
      [0,
       [11,caml_new_string("invalid box description "),[3,0,0]],
       caml_new_string("invalid box description %S")],
     zero=[254,0,0],
     one=[254,1,0],
     partial=[11,caml_new_string(" t:"),[2,0,[11,caml_new_string(" }\n"),0]]],
     init$0=caml_new_string(""),
     row_prefix=caml_new_string("R"),
     col_prefix=caml_new_string("C"),
     partial$0=
      [4,
       0,
       [0,2,2],
       0,
       [12,46,[4,0,[0,2,3],0,[12,32,[2,0,[11,caml_new_string(" : "),0]]]]]],
     s=caml_new_string("INFO");
    caml_register_global
     (11,Undefined_recursive_module,"Undefined_recursive_module");
    caml_register_global(10,Assert_failure,"Assert_failure");
    caml_register_global(9,Sys_blocked_io,"Sys_blocked_io");
    caml_register_global(8,Stack_overflow,"Stack_overflow");
    caml_register_global(7,Match_failure,"Match_failure");
    caml_register_global(6,Not_found,"Not_found");
    caml_register_global(5,Division_by_zero,"Division_by_zero");
    caml_register_global(4,End_of_file,"End_of_file");
    caml_register_global(3,Invalid_argument,"Invalid_argument");
    caml_register_global(2,Failure,"Failure");
    caml_register_global(1,Sys_error,"Sys_error");
    caml_register_global(0,Out_of_memory,"Out_of_memory");
    var
     _j_=caml_new_string("%,"),
     _h_=caml_new_string("input"),
     _g_=caml_new_string("output_substring"),
     _e_=caml_new_string("true"),
     _f_=caml_new_string("false"),
     _a_=[255,1,0,32752],
     _b_=[255,16777215,16777215,32751],
     _c_=[255,0,0,16],
     _k_=caml_new_string("List.init"),
     _m_=caml_new_string("\\\\"),
     _n_=caml_new_string("\\'"),
     _o_=caml_new_string("\\b"),
     _p_=caml_new_string("\\t"),
     _q_=caml_new_string("\\n"),
     _r_=caml_new_string("\\r"),
     _u_=caml_new_string("String.blit / Bytes.blit_string"),
     _t_=caml_new_string("Bytes.blit"),
     _s_=caml_new_string("String.sub / Bytes.sub"),
     _x_=caml_new_string("String.contains_from / Bytes.contains_from"),
     _w_=caml_new_string(""),
     _v_=caml_new_string("String.concat"),
     _A_=caml_new_string("Array.map2: arrays must have the same length"),
     _z_=caml_new_string("Array.sub"),
     _y_=caml_new_string("Array.init"),
     _B_=caml_new_string("CamlinternalLazy.Undefined"),
     _E_=caml_new_string("Buffer.add_substring/add_subbytes"),
     _D_=caml_new_string("Buffer.add: cannot grow buffer"),
     _C_=caml_new_string("Buffer.sub"),
     _N_=caml_new_string("%c"),
     _O_=caml_new_string("%s"),
     _P_=caml_new_string("%i"),
     _Q_=caml_new_string("%li"),
     _R_=caml_new_string("%ni"),
     _S_=caml_new_string("%Li"),
     _T_=caml_new_string("%f"),
     _U_=caml_new_string("%B"),
     _V_=caml_new_string("%{"),
     _W_=caml_new_string("%}"),
     _X_=caml_new_string("%("),
     _Y_=caml_new_string("%)"),
     _Z_=caml_new_string("%a"),
     ___=caml_new_string("%t"),
     _$_=caml_new_string("%?"),
     _aa_=caml_new_string("%r"),
     _ab_=caml_new_string("%_r"),
     _ac_=[0,caml_new_string("camlinternalFormat.ml"),846,23],
     _an_=[0,caml_new_string("camlinternalFormat.ml"),810,21],
     _af_=[0,caml_new_string("camlinternalFormat.ml"),811,21],
     _ao_=[0,caml_new_string("camlinternalFormat.ml"),814,21],
     _ag_=[0,caml_new_string("camlinternalFormat.ml"),815,21],
     _ap_=[0,caml_new_string("camlinternalFormat.ml"),818,19],
     _ah_=[0,caml_new_string("camlinternalFormat.ml"),819,19],
     _aq_=[0,caml_new_string("camlinternalFormat.ml"),822,22],
     _ai_=[0,caml_new_string("camlinternalFormat.ml"),823,22],
     _ar_=[0,caml_new_string("camlinternalFormat.ml"),827,30],
     _aj_=[0,caml_new_string("camlinternalFormat.ml"),828,30],
     _al_=[0,caml_new_string("camlinternalFormat.ml"),832,26],
     _ad_=[0,caml_new_string("camlinternalFormat.ml"),833,26],
     _am_=[0,caml_new_string("camlinternalFormat.ml"),842,28],
     _ae_=[0,caml_new_string("camlinternalFormat.ml"),843,28],
     _ak_=[0,caml_new_string("camlinternalFormat.ml"),847,23],
     _bo_=caml_new_string("%u"),
     _bm_=[0,caml_new_string("camlinternalFormat.ml"),1525,4],
     _bn_=caml_new_string("Printf: bad conversion %["),
     _bp_=[0,caml_new_string("camlinternalFormat.ml"),1593,39],
     _bq_=[0,caml_new_string("camlinternalFormat.ml"),1616,31],
     _br_=[0,caml_new_string("camlinternalFormat.ml"),1617,31],
     _bs_=caml_new_string("Printf: bad conversion %_"),
     _bt_=[0,caml_new_string("camlinternalFormat.ml"),1797,8],
     _bu_=caml_new_string("@{"),
     _bv_=caml_new_string("@["),
     _bw_=caml_new_string("@{"),
     _bx_=caml_new_string("@["),
     _by_=caml_new_string(""),
     _bz_=[0,0,4],
     _bA_=caml_new_string(""),
     _bB_=caml_new_string("b"),
     _bC_=caml_new_string("h"),
     _bD_=caml_new_string("hov"),
     _bE_=caml_new_string("hv"),
     _bF_=caml_new_string("v"),
     _bk_=caml_new_string("nan"),
     _bl_=caml_new_string("."),
     _bi_=caml_new_string("neg_infinity"),
     _bj_=caml_new_string("infinity"),
     _bh_=caml_new_string("%.12g"),
     _a6_=caml_new_string("%nd"),
     _a7_=caml_new_string("%+nd"),
     _a8_=caml_new_string("% nd"),
     _a9_=caml_new_string("%ni"),
     _a__=caml_new_string("%+ni"),
     _a$_=caml_new_string("% ni"),
     _ba_=caml_new_string("%nx"),
     _bb_=caml_new_string("%#nx"),
     _bc_=caml_new_string("%nX"),
     _bd_=caml_new_string("%#nX"),
     _be_=caml_new_string("%no"),
     _bf_=caml_new_string("%#no"),
     _bg_=caml_new_string("%nu"),
     _aT_=caml_new_string("%ld"),
     _aU_=caml_new_string("%+ld"),
     _aV_=caml_new_string("% ld"),
     _aW_=caml_new_string("%li"),
     _aX_=caml_new_string("%+li"),
     _aY_=caml_new_string("% li"),
     _aZ_=caml_new_string("%lx"),
     _a0_=caml_new_string("%#lx"),
     _a1_=caml_new_string("%lX"),
     _a2_=caml_new_string("%#lX"),
     _a3_=caml_new_string("%lo"),
     _a4_=caml_new_string("%#lo"),
     _a5_=caml_new_string("%lu"),
     _aG_=caml_new_string("%Ld"),
     _aH_=caml_new_string("%+Ld"),
     _aI_=caml_new_string("% Ld"),
     _aJ_=caml_new_string("%Li"),
     _aK_=caml_new_string("%+Li"),
     _aL_=caml_new_string("% Li"),
     _aM_=caml_new_string("%Lx"),
     _aN_=caml_new_string("%#Lx"),
     _aO_=caml_new_string("%LX"),
     _aP_=caml_new_string("%#LX"),
     _aQ_=caml_new_string("%Lo"),
     _aR_=caml_new_string("%#Lo"),
     _aS_=caml_new_string("%Lu"),
     _at_=caml_new_string("%d"),
     _au_=caml_new_string("%+d"),
     _av_=caml_new_string("% d"),
     _aw_=caml_new_string("%i"),
     _ax_=caml_new_string("%+i"),
     _ay_=caml_new_string("% i"),
     _az_=caml_new_string("%x"),
     _aA_=caml_new_string("%#x"),
     _aB_=caml_new_string("%X"),
     _aC_=caml_new_string("%#X"),
     _aD_=caml_new_string("%o"),
     _aE_=caml_new_string("%#o"),
     _aF_=caml_new_string("%u"),
     _F_=caml_new_string("@]"),
     _G_=caml_new_string("@}"),
     _H_=caml_new_string("@?"),
     _I_=caml_new_string("@\n"),
     _J_=caml_new_string("@."),
     _K_=caml_new_string("@@"),
     _L_=caml_new_string("@%"),
     _M_=caml_new_string("@"),
     _as_=caml_new_string("CamlinternalFormat.Type_mismatch"),
     _bH_=caml_new_string("Random.int"),
     _bG_=caml_new_string("x"),
     _jj_=caml_new_string("OCAMLRUNPARAM"),
     _jh_=caml_new_string("CAMLRUNPARAM"),
     _bI_=caml_new_string(""),
     _bR_=[3,0,3],
     _bS_=caml_new_string("."),
     _bP_=caml_new_string(">"),
     _bQ_=caml_new_string("</"),
     _bN_=caml_new_string(">"),
     _bO_=caml_new_string("<"),
     _bM_=caml_new_string("\n"),
     _bK_=caml_new_string("Format.Empty_queue"),
     _bL_=[0,caml_new_string("")],
     _bT_=caml_new_string("-"),
     _jg_=caml_new_string("TMPDIR"),
     _jf_=caml_new_string("TEMP"),
     _bU_=caml_new_string("Cygwin"),
     _bV_=caml_new_string("Win32"),
     _b0_=caml_new_string("E2BIG"),
     _b2_=caml_new_string("EACCES"),
     _b3_=caml_new_string("EAGAIN"),
     _b4_=caml_new_string("EBADF"),
     _b5_=caml_new_string("EBUSY"),
     _b6_=caml_new_string("ECHILD"),
     _b7_=caml_new_string("EDEADLK"),
     _b8_=caml_new_string("EDOM"),
     _b9_=caml_new_string("EEXIST"),
     _b__=caml_new_string("EFAULT"),
     _b$_=caml_new_string("EFBIG"),
     _ca_=caml_new_string("EINTR"),
     _cb_=caml_new_string("EINVAL"),
     _cc_=caml_new_string("EIO"),
     _cd_=caml_new_string("EISDIR"),
     _ce_=caml_new_string("EMFILE"),
     _cf_=caml_new_string("EMLINK"),
     _cg_=caml_new_string("ENAMETOOLONG"),
     _ch_=caml_new_string("ENFILE"),
     _ci_=caml_new_string("ENODEV"),
     _cj_=caml_new_string("ENOENT"),
     _ck_=caml_new_string("ENOEXEC"),
     _cl_=caml_new_string("ENOLCK"),
     _cm_=caml_new_string("ENOMEM"),
     _cn_=caml_new_string("ENOSPC"),
     _co_=caml_new_string("ENOSYS"),
     _cp_=caml_new_string("ENOTDIR"),
     _cq_=caml_new_string("ENOTEMPTY"),
     _cr_=caml_new_string("ENOTTY"),
     _cs_=caml_new_string("ENXIO"),
     _ct_=caml_new_string("EPERM"),
     _cu_=caml_new_string("EPIPE"),
     _cv_=caml_new_string("ERANGE"),
     _cw_=caml_new_string("EROFS"),
     _cx_=caml_new_string("ESPIPE"),
     _cy_=caml_new_string("ESRCH"),
     _cz_=caml_new_string("EXDEV"),
     _cA_=caml_new_string("EWOULDBLOCK"),
     _cB_=caml_new_string("EINPROGRESS"),
     _cC_=caml_new_string("EALREADY"),
     _cD_=caml_new_string("ENOTSOCK"),
     _cE_=caml_new_string("EDESTADDRREQ"),
     _cF_=caml_new_string("EMSGSIZE"),
     _cG_=caml_new_string("EPROTOTYPE"),
     _cH_=caml_new_string("ENOPROTOOPT"),
     _cI_=caml_new_string("EPROTONOSUPPORT"),
     _cJ_=caml_new_string("ESOCKTNOSUPPORT"),
     _cK_=caml_new_string("EOPNOTSUPP"),
     _cL_=caml_new_string("EPFNOSUPPORT"),
     _cM_=caml_new_string("EAFNOSUPPORT"),
     _cN_=caml_new_string("EADDRINUSE"),
     _cO_=caml_new_string("EADDRNOTAVAIL"),
     _cP_=caml_new_string("ENETDOWN"),
     _cQ_=caml_new_string("ENETUNREACH"),
     _cR_=caml_new_string("ENETRESET"),
     _cS_=caml_new_string("ECONNABORTED"),
     _cT_=caml_new_string("ECONNRESET"),
     _cU_=caml_new_string("ENOBUFS"),
     _cV_=caml_new_string("EISCONN"),
     _cW_=caml_new_string("ENOTCONN"),
     _cX_=caml_new_string("ESHUTDOWN"),
     _cY_=caml_new_string("ETOOMANYREFS"),
     _cZ_=caml_new_string("ETIMEDOUT"),
     _c0_=caml_new_string("ECONNREFUSED"),
     _c1_=caml_new_string("EHOSTDOWN"),
     _c2_=caml_new_string("EHOSTUNREACH"),
     _c3_=caml_new_string("ELOOP"),
     _c4_=caml_new_string("EOVERFLOW"),
     _c5_=
      [0,
       [11,caml_new_string("EUNKNOWNERR "),[4,0,0,0,0]],
       caml_new_string("EUNKNOWNERR %d")],
     _b1_=
      [0,
       [11,
        caml_new_string("Unix.Unix_error(Unix."),
        [2,
         0,
         [11,
          caml_new_string(", "),
          [3,0,[11,caml_new_string(", "),[3,0,[12,41,0]]]]]]],
       caml_new_string("Unix.Unix_error(Unix.%s, %S, %S)")],
     _bW_=caml_new_string("Unix.Unix_error"),
     _bX_=caml_new_string(""),
     _bY_=caml_new_string(""),
     _bZ_=caml_new_string("Unix.Unix_error"),
     _c6_=caml_new_string("0.0.0.0"),
     _c7_=caml_new_string("127.0.0.1"),
     _je_=caml_new_string("::"),
     _jd_=caml_new_string("::1"),
     _c8_=caml_new_string("Bigarray.array1_of_genarray"),
     _c__=[255,1,0,0],
     _c9_=[255,0,0,0],
     _dl_=[0,[0,0],caml_new_string("%c")],
     _dk_=
      [0,
       [12,
        40,
        [8,
         12,
         0,
         0,
         [11,caml_new_string(", "),[8,12,0,0,[11,caml_new_string("i)"),0]]]]],
       caml_new_string("(%G, %Gi)")],
     _dj_=
      [0,
       [12,
        40,
        [8,
         12,
         0,
         0,
         [11,caml_new_string(", "),[8,12,0,0,[11,caml_new_string("i)"),0]]]]],
       caml_new_string("(%G, %Gi)")],
     _di_=[0,[6,0,0,0,0],caml_new_string("%nd")],
     _dh_=[0,[4,3,0,0,0],caml_new_string("%i")],
     _dg_=[0,[7,0,0,0,0],caml_new_string("%Ld")],
     _df_=[0,[5,0,0,0,0],caml_new_string("%ld")],
     _de_=[0,[4,3,0,0,0],caml_new_string("%i")],
     _dd_=[0,[4,3,0,0,0],caml_new_string("%i")],
     _dc_=[0,[4,3,0,0,0],caml_new_string("%i")],
     _db_=[0,[4,3,0,0,0],caml_new_string("%i")],
     _da_=[0,[8,12,0,0,0],caml_new_string("%G")],
     _c$_=[0,[8,12,0,0,0],caml_new_string("%G")],
     _dq_=caml_new_string("owl_utils:eps"),
     _dp_=caml_new_string(""),
     _do_=caml_new_string(""),
     _dn_=caml_new_string(","),
     _dm_=[0,[2,0,[2,0,[2,0,0]]],caml_new_string("%s%s%s")],
     _dt_=[0,0],
     _hf_=[0,[2,0,0],caml_new_string("%s")],
     _he_=
      [0,
       [11,
        caml_new_string("digraph CG {\nnode [shape=record];\n"),
        [2,0,[12,125,0]]],
       caml_new_string("digraph CG {\nnode [shape=record];\n%s}")],
     _hb_=caml_new_string("Const"),
     _hc_=
      [0,
       [4,
        3,
        0,
        0,
        [11,
         caml_new_string(' [ label="#'),
         [4,
          3,
          0,
          0,
          [11,
           caml_new_string(" | { "),
           [2,
            0,
            [11,
             caml_new_string(" | "),
             [2,
              0,
              [11,caml_new_string(' }" fillcolor=gray, style=filled ];\n'),0]]]]]]]],
       caml_new_string
        ('%i [ label="#%i | { %s | %s }" fillcolor=gray, style=filled ];\n')],
     _hd_=
      [0,
       [4,
        3,
        0,
        0,
        [11,
         caml_new_string(' [ label="#'),
         [4,
          3,
          0,
          0,
          [11,
           caml_new_string(" | { "),
           [2,
            0,
            [11,
             caml_new_string(" | "),
             [2,0,[11,caml_new_string(' }" ];\n'),0]]]]]]]],
       caml_new_string('%i [ label="#%i | { %s | %s }" ];\n')],
     _g$_=
      [0,
       [12,
        9,
        [4,
         3,
         0,
         0,
         [11,caml_new_string(" -> "),[4,3,0,0,[11,caml_new_string(";\n"),0]]]]],
       caml_new_string("\t%i -> %i;\n")],
     _g__=caml_new_string(""),
     _g9_=caml_new_string(""),
     _ha_=caml_new_string(""),
     _g8_=
      [0,
       [11,
        caml_new_string("{ i:"),
        [4,
         3,
         0,
         0,
         [11,
          caml_new_string(" o:"),
          [2,
           0,
           [11,
            caml_new_string(" t:"),
            [2,
             0,
             [11,
              caml_new_string(" } -> { i:"),
              [4,3,0,0,[11,caml_new_string(" o:"),[2,0,partial]]]]]]]]]],
       caml_new_string("{ i:%i o:%s t:%s } -> { i:%i o:%s t:%s }\n")],
     _g7_=caml_new_string(""),
     _g6_=caml_new_string(""),
     _fD_=[0,[11,caml_new_string("Const"),0],caml_new_string("Const")],
     _fE_=[0,[11,caml_new_string("Const"),0],caml_new_string("Const")],
     _fF_=[0,[11,caml_new_string("DF"),0],caml_new_string("DF")],
     _fG_=[0,caml_new_string("Noop"),0],
     _fH_=caml_new_string("Add_D_D"),
     _fI_=caml_new_string("Add_D_C"),
     _fJ_=caml_new_string("Add_C_D"),
     _fK_=caml_new_string("Sub_D_D"),
     _fL_=caml_new_string("Sub_D_C"),
     _fM_=caml_new_string("Sub_C_D"),
     _fN_=caml_new_string("Mul_D_D"),
     _fO_=caml_new_string("Mul_D_C"),
     _fP_=caml_new_string("Mul_C_D"),
     _fQ_=caml_new_string("Div_D_D"),
     _fR_=caml_new_string("Div_D_C"),
     _fS_=caml_new_string("Div_C_D"),
     _fT_=caml_new_string("Pow_D_D"),
     _fU_=caml_new_string("Pow_D_C"),
     _fV_=caml_new_string("Pow_C_D"),
     _fW_=caml_new_string("Atan2_D_D"),
     _fX_=caml_new_string("Atan2_D_C"),
     _fY_=caml_new_string("Atan2_C_D"),
     _fZ_=caml_new_string("Neg_D"),
     _f0_=caml_new_string("Abs_D"),
     _f1_=caml_new_string("Signum_D"),
     _f2_=caml_new_string("Floor_D"),
     _f3_=caml_new_string("Ceil_D"),
     _f4_=caml_new_string("Round_D"),
     _f5_=caml_new_string("Sqr_D"),
     _f6_=caml_new_string("Sqrt_D"),
     _f7_=caml_new_string("Log_D"),
     _f8_=caml_new_string("Log2_D"),
     _f9_=caml_new_string("Log10_D"),
     _f__=caml_new_string("Exp_D"),
     _f$_=caml_new_string("Sin_D"),
     _ga_=caml_new_string("Cos_D"),
     _gb_=caml_new_string("Tan_D"),
     _gc_=caml_new_string("Sinh_D"),
     _gd_=caml_new_string("Cosh_D"),
     _ge_=caml_new_string("Tanh_D"),
     _gf_=caml_new_string("Asin_D"),
     _gg_=caml_new_string("Acos_D"),
     _gh_=caml_new_string("Atan_D"),
     _gi_=caml_new_string("Asinh_D"),
     _gj_=caml_new_string("Acosh_D"),
     _gk_=caml_new_string("Atanh_D"),
     _gl_=caml_new_string("Get_Item"),
     _gm_=caml_new_string("SetI_D_D"),
     _gn_=caml_new_string("SetI_D_C"),
     _go_=caml_new_string("SetI_C_D"),
     _gp_=caml_new_string("AddI_D_D"),
     _gq_=caml_new_string("AddI_D_C"),
     _gr_=caml_new_string("AddI_C_D"),
     _gs_=caml_new_string("Get_Slice_D"),
     _gt_=caml_new_string("Set_Slice_D_D"),
     _gu_=caml_new_string("Set_Slice_D_C"),
     _gv_=caml_new_string("Set_Slice_C_D"),
     _gw_=caml_new_string("Sum_D"),
     _gx_=caml_new_string("Sum__D"),
     _gy_=caml_new_string("Dot_D_D"),
     _gz_=caml_new_string("Dot_D_C"),
     _gA_=caml_new_string("Dot_C_D"),
     _gB_=caml_new_string("Trans_D"),
     _gC_=caml_new_string("L1Norm_D"),
     _gD_=caml_new_string("L2Norm_D"),
     _gE_=caml_new_string("L2NormS_D"),
     _gF_=caml_new_string("Sigmoid_D"),
     _gG_=caml_new_string("Relu_D"),
     _gH_=caml_new_string("Inv_D"),
     _gI_=caml_new_string("Add_Row_D_D"),
     _gJ_=caml_new_string("Add_Row_D_C"),
     _gK_=caml_new_string("Add_Row_C_D"),
     _gL_=caml_new_string("Get_Row_D"),
     _gM_=caml_new_string("Of_Rows_D"),
     _gN_=caml_new_string("Concat_D_D"),
     _gO_=caml_new_string("Concat_D_C"),
     _gP_=caml_new_string("Concat_C_D"),
     _gQ_=caml_new_string("Conv1D_D_D"),
     _gR_=caml_new_string("Conv1D_D_C"),
     _gS_=caml_new_string("Conv1D_C_D"),
     _gT_=caml_new_string("Conv2D_D_D"),
     _gU_=caml_new_string("Conv2D_D_C"),
     _gV_=caml_new_string("Conv2D_C_D"),
     _gW_=caml_new_string("Conv3D_D_D"),
     _gX_=caml_new_string("Conv3D_D_C"),
     _gY_=caml_new_string("Conv3D_C_D"),
     _gZ_=caml_new_string("Reshape_D"),
     _g0_=caml_new_string("Maxpool1D_D"),
     _g1_=caml_new_string("Maxpool2D_D"),
     _g2_=caml_new_string("Maxpool3D_D"),
     _g3_=caml_new_string("Avgpool1D_D"),
     _g4_=caml_new_string("Avgpool2D_D"),
     _g5_=caml_new_string("Avgpool3D_D"),
     _fB_=caml_new_string("error: jacobian"),
     _fC_=caml_new_string("error: jacobian"),
     _fA_=[0,1],
     _fz_=[0,1],
     _fj_=[0,1],
     _fk_=[0,1],
     _fl_=[0,2],
     _fm_=[0,2],
     _fn_=[0,1],
     _fo_=[0,1],
     _fp_=[0,1],
     _fq_=[0,1],
     _fr_=[0,1],
     _fs_=[0,1],
     _ft_=[0,0],
     _fu_=[0,0],
     _fv_=[0,2],
     _fw_=[0,1],
     _fx_=[0,2],
     _fy_=[0,1],
     _dS_=
      caml_new_string("error: forward and reverse clash at the same level"),
     _dT_=
      caml_new_string("error: forward and reverse clash at the same level"),
     _dU_=caml_new_string("( + )"),
     _dV_=caml_new_string("( - )"),
     _dW_=caml_new_string("( * )"),
     _dX_=caml_new_string("( / )"),
     _d0_=[0,1],
     _dZ_=[0,1],
     _dY_=caml_new_string("( ** )"),
     _d1_=caml_new_string("atan2"),
     _d2_=[0,2],
     _d3_=[0,2],
     _d5_=[0,0],
     _d4_=caml_new_string("neg"),
     _d6_=caml_new_string("abs"),
     _d7_=caml_new_string("signum"),
     _d8_=caml_new_string("floor"),
     _d9_=caml_new_string("ceil"),
     _d__=caml_new_string("round"),
     _ea_=[0,2],
     _d$_=caml_new_string("sqr"),
     _ec_=[0,2],
     _eb_=caml_new_string("sqrt"),
     _ed_=caml_new_string("log"),
     _ee_=caml_new_string("log2"),
     _ef_=caml_new_string("log10"),
     _eg_=caml_new_string("exp"),
     _eh_=caml_new_string("sin"),
     _ei_=caml_new_string("cos"),
     _ej_=caml_new_string("tan"),
     _ek_=caml_new_string("sinh"),
     _el_=caml_new_string("cosh"),
     _em_=caml_new_string("tanh"),
     _eo_=[0,1],
     _en_=caml_new_string("asin"),
     _eq_=[0,1],
     _ep_=caml_new_string("acos"),
     _es_=[0,1],
     _er_=caml_new_string("atan"),
     _eu_=[0,1],
     _et_=caml_new_string("asinh"),
     _ew_=[0,1],
     _ev_=caml_new_string("acosh"),
     _ey_=[0,1],
     _ex_=caml_new_string("atanh"),
     _ez_=caml_new_string("get_item"),
     _eA_=[0,0],
     _eC_=[0,0],
     _eB_=caml_new_string("set_item"),
     _eD_=caml_new_string("add_item"),
     _eE_=caml_new_string("slice"),
     _eF_=caml_new_string("set_slice"),
     _eG_=caml_new_string("sum"),
     _eH_=caml_new_string("sum"),
     _eI_=caml_new_string("( *@ )"),
     _eJ_=caml_new_string("transpose"),
     _eK_=caml_new_string("l1norm'"),
     _eL_=caml_new_string("l2norm'"),
     _eN_=[0,2],
     _eM_=caml_new_string("l2norm_sqr'"),
     _eP_=[0,1],
     _eO_=caml_new_string("sigmoid"),
     _eR_=[0,2],
     _eS_=[0,1],
     _eQ_=caml_new_string("relu"),
     _eT_=caml_new_string("inv"),
     _eU_=[0,1],
     _eV_=[0,1],
     _eW_=caml_new_string("add_row"),
     _eX_=caml_new_string("get_row"),
     _eY_=caml_new_string("of_rows a.(0)"),
     _e2_=caml_new_string("conv1d:df_dab"),
     _e1_=caml_new_string("conv1d:df_db"),
     _e0_=caml_new_string("conv1d:df_da"),
     _eZ_=caml_new_string("conv1d"),
     _e3_=caml_new_string("conv2d"),
     _e4_=caml_new_string("conv3d"),
     _e5_=caml_new_string("reshape"),
     _e7_=caml_new_string("max_pool1d:df"),
     _e6_=caml_new_string("max_pool1d"),
     _e9_=caml_new_string("max_pool2d:df"),
     _e8_=caml_new_string("max_pool2d"),
     _e$_=caml_new_string("max_pool3d:df"),
     _e__=caml_new_string("max_pool3d"),
     _fb_=caml_new_string("avg_pool1d:df"),
     _fa_=caml_new_string("avg_pool1d"),
     _fd_=caml_new_string("avg_pool2d:df"),
     _fc_=caml_new_string("avg_pool2d"),
     _ff_=caml_new_string("avg_pool3d:df"),
     _fe_=caml_new_string("avg_pool3d"),
     _fg_=caml_new_string("dropout"),
     _fh_=caml_new_string("concat"),
     _fi_=caml_new_string("split"),
     _dR_=caml_new_string(" : "),
     _dN_=caml_new_string("#0:"),
     _dO_=caml_new_string("#1:"),
     _dP_=caml_new_string(", "),
     _dQ_=caml_new_string(" : "),
     _dJ_=[0,[12,91,[2,0,[12,93,0]]],caml_new_string("[%s]")],
     _dK_=[0,[12,91,[2,0,[12,93,0]]],caml_new_string("[%s]")],
     _dL_=
      [0,
       [11,
        caml_new_string("[DF tag:"),
        [4,3,0,0,[11,caml_new_string(" ap:"),[2,0,[12,93,0]]]]],
       caml_new_string("[DF tag:%i ap:%s]")],
     _dM_=
      [0,
       [11,
        caml_new_string("[DR tag:"),
        [4,3,0,0,[11,caml_new_string(" ap:"),[2,0,[12,93,0]]]]],
       caml_new_string("[DR tag:%i ap:%s]")],
     _dG_=
      [0,
       [11,caml_new_string("F("),[8,9,0,0,[12,41,0]]],
       caml_new_string("F(%g)")],
     _dH_=
      [0,
       [11,caml_new_string("Arr("),[2,0,[12,41,0]]],
       caml_new_string("Arr(%s)")],
     _dI_=caml_new_string("you should not have reached here!"),
     _dF_=caml_new_string("error: AD.unpack_flt"),
     _dE_=caml_new_string("error: AD.unpack_arr"),
     _dD_=caml_new_string("error: AD.repeat"),
     _dC_=caml_new_string("error: AD.tile"),
     _dB_=caml_new_string("error: AD.copy"),
     _dA_=caml_new_string("error: AD.clip_by_l2norm"),
     _dz_=caml_new_string("error: AD.clip_by_value"),
     _dy_=caml_new_string("error: AD.numel"),
     _dx_=caml_new_string("error: AD.shape"),
     _dw_=caml_new_string("error: no adjval for DF"),
     _dv_=caml_new_string("error: no adjref for DF"),
     _du_=caml_new_string("error: no tangent for DR"),
     _dr_=[0,0],
     _ds_=caml_new_string("error: reset_zero"),
     _hg_=[0,caml_new_string("src/base/stats/owl_base_stats.ml"),9,2],
     _hk_=caml_new_string("_div: unsupported operation"),
     _hj_=caml_new_string("_mul_elt: unsupported operation"),
     _hi_=caml_new_string("_sub_elt: unsupported operation"),
     _hh_=caml_new_string("_add_elt: unsupported operation"),
     _hx_=[0,[2,0,0],caml_new_string("%s")],
     _hu_=caml_new_string("\n"),
     _hw_=caml_new_string(" "),
     _hv_=caml_new_string("\n"),
     _ht_=caml_new_string(""),
     _hs_=caml_new_string("..."),
     _hr_=caml_new_string(""),
     _hq_=[0,[2,0,[4,3,0,0,0]],caml_new_string("%s%i")],
     _hp_=caml_new_string(""),
     _hn_=[0,caml_new_string("]")],
     _ho_=[0,caml_new_string("[")],
     _hl_=caml_new_string(""),
     _hm_=[0,[2,0,[2,0,0]],caml_new_string("%s%s")],
     _i3_=caml_new_string("no inverse - the matrix is not square"),
     _i4_=caml_new_string("the matrix does not have an inverse"),
     _i2_=caml_new_string("Argument is not a square matrix"),
     _i1_=caml_new_string("Matrices cannot be multipled"),
     _i0_=caml_new_string("Vector is not a column vector"),
     _iZ_=
      caml_new_string
       ("Column vector does not have the same length as the number of rows in the matrix"),
     _iY_=caml_new_string("The given NDarray is not a matrix!"),
     _iX_=[0,1,0],
     _iW_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2250,
       2],
     _iV_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2251,
       2],
     _iU_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2252,
       2],
     _iT_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2219,
       2],
     _iS_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2220,
       2],
     _iR_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2221,
       2],
     _iQ_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2098,
       2],
     _iP_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2099,
       2],
     _iO_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2100,
       2],
     _iN_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2121,
       2],
     _iM_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2122,
       2],
     _iL_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1993,
       2],
     _iK_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1994,
       2],
     _iJ_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1995,
       2],
     _iI_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2012,
       2],
     _iH_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       2013,
       2],
     _iG_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1913,
       2],
     _iF_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1914,
       2],
     _iE_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1915,
       2],
     _iD_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1916,
       2],
     _iC_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1930,
       2],
     _iB_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1936,
       2],
     _iA_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1937,
       2],
     _iz_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1830,
       2],
     _iy_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1831,
       2],
     _ix_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1832,
       2],
     _iw_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1833,
       2],
     _iv_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1847,
       2],
     _iu_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1853,
       2],
     _it_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1854,
       2],
     _is_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1793,
       2],
     _ir_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1794,
       2],
     _iq_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1795,
       2],
     _ip_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1796,
       2],
     _io_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1808,
       2],
     _in_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1814,
       2],
     _im_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1815,
       2],
     _il_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1757,
       2],
     _ik_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1758,
       2],
     _ij_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1759,
       2],
     _ii_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1760,
       2],
     _ih_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1772,
       2],
     _ig_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1778,
       2],
     _if_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1779,
       2],
     _ie_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1692,
       2],
     _id_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1693,
       2],
     _ic_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1694,
       2],
     _ib_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1695,
       2],
     _ia_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1707,
       2],
     _h$_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1712,
       2],
     _h__=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1713,
       2],
     _h9_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1623,
       2],
     _h8_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1624,
       2],
     _h7_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1625,
       2],
     _h6_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1626,
       2],
     _h5_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1638,
       2],
     _h4_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1643,
       2],
     _h3_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1644,
       2],
     _h2_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1584,
       2],
     _h1_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1585,
       2],
     _h0_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1586,
       2],
     _hZ_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1529,
       2],
     _hY_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1530,
       2],
     _hX_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1531,
       2],
     _hW_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1439,
       2],
     _hV_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1440,
       2],
     _hU_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1441,
       2],
     _hT_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1383,
       2],
     _hS_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1384,
       2],
     _hR_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1385,
       2],
     _hQ_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1303,
       4],
     _hP_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1304,
       4],
     _hO_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1305,
       4],
     _hN_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1319,
       4],
     _hM_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1270,
       2],
     _hL_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1271,
       2],
     _hK_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1272,
       2],
     _hJ_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1283,
       2],
     _hI_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1201,
       2],
     _hH_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1202,
       2],
     _hG_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1203,
       2],
     _hF_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       1215,
       2],
     _hE_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       364,
       2],
     _hD_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       304,
       2],
     _hC_=caml_new_string("incorrect slice definition"),
     _hB_=
      [0,
       caml_new_string("src/base/dense/owl_base_dense_ndarray_generic.ml"),
       121,
       4],
     _hA_=
      caml_new_string
       ("cannot draw that many samples from the given range, without replacement"),
     _hz_=caml_new_string("not broadcasted correctly"),
     _hy_=
      caml_new_string("The arrays cannot be broadcast into the same shape"),
     _i9_=[0,[12,10,[10,0]],caml_new_string("\n%!")],
     _i__=[0,[2,0,0],caml_new_string("%s")],
     _i8_=
      [0,
       [4,
        0,
        [0,2,4],
        0,
        [12,
         45,
         [4,
          0,
          [0,2,2],
          0,
          [12,
           45,
           [4,
            0,
            [0,2,2],
            0,
            [12,32,[4,0,[0,2,2],0,[12,58,[4,0,[0,2,2],0,[12,58,partial$0]]]]]]]]]],
       caml_new_string("%04d-%02d-%02d %02d:%02d:%02d.%03d %s : ")],
     _i7_=caml_new_string("\x1b[0m"),
     _i5_=caml_new_string("\x1b[32m"),
     _i$_=[0,0.01],
     _ja_=
      [0,
       [11,
        caml_new_string("Execution time: "),
        [8,0,0,0,[11,caml_new_string(" seconds\n"),0]]],
       caml_new_string("Execution time: %f seconds\n")],
     _jc_=
      [0,
       [11,caml_new_string("argmin f(x) = "),[8,9,0,0,0]],
       caml_new_string("argmin f(x) = %g")];
    function erase_rel(param)
     {if(typeof param === "number")
       return 0;
      else
       switch(param[0])
        {case 0:var rest=param[1];return [0,erase_rel(rest)];
         case 1:var rest$0=param[1];return [1,erase_rel(rest$0)];
         case 2:var rest$1=param[1];return [2,erase_rel(rest$1)];
         case 3:var rest$2=param[1];return [3,erase_rel(rest$2)];
         case 4:var rest$3=param[1];return [4,erase_rel(rest$3)];
         case 5:var rest$4=param[1];return [5,erase_rel(rest$4)];
         case 6:var rest$5=param[1];return [6,erase_rel(rest$5)];
         case 7:var rest$6=param[1];return [7,erase_rel(rest$6)];
         case 8:
          var rest$7=param[2],ty=param[1];return [8,ty,erase_rel(rest$7)];
         case 9:
          var rest$8=param[3],ty1=param[1];
          return [9,ty1,ty1,erase_rel(rest$8)];
         case 10:var rest$9=param[1];return [10,erase_rel(rest$9)];
         case 11:var rest$10=param[1];return [11,erase_rel(rest$10)];
         case 12:var rest$11=param[1];return [12,erase_rel(rest$11)];
         case 13:var rest$12=param[1];return [13,erase_rel(rest$12)];
         default:var rest$13=param[1];return [14,erase_rel(rest$13)]}}
    function concat_fmtty(fmtty1,fmtty2)
     {if(typeof fmtty1 === "number")
       return fmtty2;
      else
       switch(fmtty1[0])
        {case 0:var rest=fmtty1[1];return [0,concat_fmtty(rest,fmtty2)];
         case 1:var rest$0=fmtty1[1];return [1,concat_fmtty(rest$0,fmtty2)];
         case 2:var rest$1=fmtty1[1];return [2,concat_fmtty(rest$1,fmtty2)];
         case 3:var rest$2=fmtty1[1];return [3,concat_fmtty(rest$2,fmtty2)];
         case 4:var rest$3=fmtty1[1];return [4,concat_fmtty(rest$3,fmtty2)];
         case 5:var rest$4=fmtty1[1];return [5,concat_fmtty(rest$4,fmtty2)];
         case 6:var rest$5=fmtty1[1];return [6,concat_fmtty(rest$5,fmtty2)];
         case 7:var rest$6=fmtty1[1];return [7,concat_fmtty(rest$6,fmtty2)];
         case 8:
          var rest$7=fmtty1[2],ty=fmtty1[1];
          return [8,ty,concat_fmtty(rest$7,fmtty2)];
         case 9:
          var rest$8=fmtty1[3],ty2=fmtty1[2],ty1=fmtty1[1];
          return [9,ty1,ty2,concat_fmtty(rest$8,fmtty2)];
         case 10:var rest$9=fmtty1[1];return [10,concat_fmtty(rest$9,fmtty2)];
         case 11:
          var rest$10=fmtty1[1];return [11,concat_fmtty(rest$10,fmtty2)];
         case 12:
          var rest$11=fmtty1[1];return [12,concat_fmtty(rest$11,fmtty2)];
         case 13:
          var rest$12=fmtty1[1];return [13,concat_fmtty(rest$12,fmtty2)];
         default:
          var rest$13=fmtty1[1];return [14,concat_fmtty(rest$13,fmtty2)]}}
    function concat_fmt(fmt1,fmt2)
     {if(typeof fmt1 === "number")
       return fmt2;
      else
       switch(fmt1[0])
        {case 0:var rest=fmt1[1];return [0,concat_fmt(rest,fmt2)];
         case 1:var rest$0=fmt1[1];return [1,concat_fmt(rest$0,fmt2)];
         case 2:
          var rest$1=fmt1[2],pad=fmt1[1];
          return [2,pad,concat_fmt(rest$1,fmt2)];
         case 3:
          var rest$2=fmt1[2],pad$0=fmt1[1];
          return [3,pad$0,concat_fmt(rest$2,fmt2)];
         case 4:
          var rest$3=fmt1[4],prec=fmt1[3],pad$1=fmt1[2],iconv=fmt1[1];
          return [4,iconv,pad$1,prec,concat_fmt(rest$3,fmt2)];
         case 5:
          var rest$4=fmt1[4],prec$0=fmt1[3],pad$2=fmt1[2],iconv$0=fmt1[1];
          return [5,iconv$0,pad$2,prec$0,concat_fmt(rest$4,fmt2)];
         case 6:
          var rest$5=fmt1[4],prec$1=fmt1[3],pad$3=fmt1[2],iconv$1=fmt1[1];
          return [6,iconv$1,pad$3,prec$1,concat_fmt(rest$5,fmt2)];
         case 7:
          var rest$6=fmt1[4],prec$2=fmt1[3],pad$4=fmt1[2],iconv$2=fmt1[1];
          return [7,iconv$2,pad$4,prec$2,concat_fmt(rest$6,fmt2)];
         case 8:
          var rest$7=fmt1[4],prec$3=fmt1[3],pad$5=fmt1[2],fconv=fmt1[1];
          return [8,fconv,pad$5,prec$3,concat_fmt(rest$7,fmt2)];
         case 9:
          var rest$8=fmt1[2],pad$6=fmt1[1];
          return [9,pad$6,concat_fmt(rest$8,fmt2)];
         case 10:var rest$9=fmt1[1];return [10,concat_fmt(rest$9,fmt2)];
         case 11:
          var rest$10=fmt1[2],str=fmt1[1];
          return [11,str,concat_fmt(rest$10,fmt2)];
         case 12:
          var rest$11=fmt1[2],chr=fmt1[1];
          return [12,chr,concat_fmt(rest$11,fmt2)];
         case 13:
          var rest$12=fmt1[3],fmtty=fmt1[2],pad$7=fmt1[1];
          return [13,pad$7,fmtty,concat_fmt(rest$12,fmt2)];
         case 14:
          var rest$13=fmt1[3],fmtty$0=fmt1[2],pad$8=fmt1[1];
          return [14,pad$8,fmtty$0,concat_fmt(rest$13,fmt2)];
         case 15:var rest$14=fmt1[1];return [15,concat_fmt(rest$14,fmt2)];
         case 16:var rest$15=fmt1[1];return [16,concat_fmt(rest$15,fmt2)];
         case 17:
          var rest$16=fmt1[2],fmting_lit=fmt1[1];
          return [17,fmting_lit,concat_fmt(rest$16,fmt2)];
         case 18:
          var rest$17=fmt1[2],fmting_gen=fmt1[1];
          return [18,fmting_gen,concat_fmt(rest$17,fmt2)];
         case 19:var rest$18=fmt1[1];return [19,concat_fmt(rest$18,fmt2)];
         case 20:
          var rest$19=fmt1[3],char_set=fmt1[2],width_opt=fmt1[1];
          return [20,width_opt,char_set,concat_fmt(rest$19,fmt2)];
         case 21:
          var rest$20=fmt1[2],counter=fmt1[1];
          return [21,counter,concat_fmt(rest$20,fmt2)];
         case 22:var rest$21=fmt1[1];return [22,concat_fmt(rest$21,fmt2)];
         case 23:
          var rest$22=fmt1[2],ign=fmt1[1];
          return [23,ign,concat_fmt(rest$22,fmt2)];
         default:
          var rest$23=fmt1[3],f=fmt1[2],arity=fmt1[1];
          return [24,arity,f,concat_fmt(rest$23,fmt2)]}}
    function failwith(s){throw [0,Failure,s]}
    function invalid_arg(s){throw [0,Invalid_argument,s]}
    caml_fresh_oo_id(0);
    function min(x,y){return caml_lessequal(x,y)?x:y}
    function max(x,y){return caml_greaterequal(x,y)?x:y}
    function abs(x){return 0 <= x?x:-x | 0}
    var
     nan=caml_int64_float_of_bits(_a_),
     max_float=caml_int64_float_of_bits(_b_),
     min_float=caml_int64_float_of_bits(_c_),
     max_int=2147483647;
    function _d_(s1,s2)
     {var
       l1=caml_ml_string_length(s1),
       l2=caml_ml_string_length(s2),
       s=caml_create_bytes(l1 + l2 | 0);
      caml_blit_string(s1,0,s,0,l1);
      caml_blit_string(s2,0,s,l1,l2);
      return s}
    function string_of_bool(b){return b?_e_:_f_}
    function string_of_int(n){return caml_new_string("" + n)}
    function append(l1,l2)
     {if(l1){var tl=l1[2],hd=l1[1];return [0,hd,append(tl,l2)]}return l2}
    var
     stdin=caml_ml_open_descriptor_in(0),
     stdout=caml_ml_open_descriptor_out(1),
     oc=caml_ml_open_descriptor_out(2);
    function flush_all(param)
     {function iter(param)
       {var param$0=param;
        for(;;)
         {if(param$0)
           {var l=param$0[2],a=param$0[1];
            try
             {caml_ml_flush(a)}
            catch(_B5_)
             {_B5_ = caml_wrap_exception(_B5_);
              if(_B5_[1] !== Sys_error)throw _B5_}
            var param$0=l;
            continue}
          return 0}}
      return iter(caml_ml_out_channels_list(0))}
    function output_string(oc,s)
     {return caml_ml_output(oc,s,0,caml_ml_string_length(s))}
    function _i_(param,_B3_)
     {var
       str2=_B3_[2],
       fmt2=_B3_[1],
       str1=param[2],
       fmt1=param[1],
       _B4_=_d_(str1,_d_(_j_,str2));
      return [0,concat_fmt(fmt1,fmt2),_B4_]}
    var exit_function=[0,flush_all];
    function at_exit(f)
     {var g=exit_function[1];
      exit_function[1]
      =
      function(param){caml_call1(f,0);return caml_call1(g,0)};
      return 0}
    function do_at_exit(param){return caml_call1(exit_function[1],0)}
    function rev(l)
     {var l1=l,l2=0;
      for(;;)
       {if(l1){var l1$0=l1[2],a=l1[1],l2$0=[0,a,l2],l1=l1$0,l2=l2$0;continue}
        return l2}}
    function init_aux(i,n,f)
     {if(n <= i)return 0;
      var r=caml_call1(f,i);
      return [0,r,init_aux(i + 1 | 0,n,f)]}
    function map(f,param)
     {if(param)
       {var l=param[2],a=param[1],r=caml_call1(f,a);return [0,r,map(f,l)]}
      return 0}
    function _l_(i,f,param)
     {if(param)
       {var l=param[2],a=param[1],r=caml_call2(f,i,a);
        return [0,r,_l_(i + 1 | 0,f,l)]}
      return 0}
    function mapi(f,l){return _l_(0,f,l)}
    function fold_left(f,accu,l)
     {var accu$0=accu,l$0=l;
      for(;;)
       {if(l$0)
         {var
           l$1=l$0[2],
           a=l$0[1],
           accu$1=caml_call2(f,accu$0,a),
           accu$0=accu$1,
           l$0=l$1;
          continue}
        return accu$0}}
    function make(n,c)
     {var s=caml_create_bytes(n);caml_fill_bytes(s,0,n,c);return s}
    function sub(s,ofs,len)
     {if(0 <= ofs)
       if(0 <= len)
        if(!((caml_ml_bytes_length(s) - len | 0) < ofs))
         {var r=caml_create_bytes(len);
          caml_blit_bytes(s,ofs,r,0,len);
          return r}
      return invalid_arg(_s_)}
    function sub_string(b,ofs,len){return sub(b,ofs,len)}
    function blit(s1,ofs1,s2,ofs2,len)
     {if(0 <= len)
       if(0 <= ofs1)
        if(!((caml_ml_bytes_length(s1) - len | 0) < ofs1))
         if(0 <= ofs2)
          if(!((caml_ml_bytes_length(s2) - len | 0) < ofs2))
           return caml_blit_bytes(s1,ofs1,s2,ofs2,len);
      return invalid_arg(_t_)}
    function blit$0(s1,ofs1,s2,ofs2,len)
     {if(0 <= len)
       if(0 <= ofs1)
        if(!((caml_ml_string_length(s1) - len | 0) < ofs1))
         if(0 <= ofs2)
          if(!((caml_ml_bytes_length(s2) - len | 0) < ofs2))
           return caml_blit_string(s1,ofs1,s2,ofs2,len);
      return invalid_arg(_u_)}
    function make$0(n,c){return make(n,c)}
    function sub$0(s,ofs,len){return sub(s,ofs,len)}
    function index_rec(s,lim,i,c)
     {var i$0=i;
      for(;;)
       {if(lim <= i$0)throw Not_found;
        if(caml_string_unsafe_get(s,i$0) === c)return i$0;
        var i$1=i$0 + 1 | 0,i$0=i$1;
        continue}}
    function contains_from(s,i,c)
     {var l=caml_ml_string_length(s);
      if(0 <= i)
       if(!(l < i))
        try
         {index_rec(s,l,i,c);var _B1_=1;return _B1_}
        catch(_B2_)
         {_B2_ = caml_wrap_exception(_B2_);
          if(_B2_ === Not_found)return 0;
          throw _B2_}
      return invalid_arg(_x_)}
    function contains(s,c){return contains_from(s,0,c)}
    var
     match=caml_sys_get_config(0),
     os_type=match[1],
     max_array_length=caml_sys_const_max_wosize(0),
     max_string_length=(4 * max_array_length | 0) - 1 | 0;
    caml_fresh_oo_id(0);
    function init(l,f)
     {if(0 === l)return [0];
      if(0 <= l)
       {var res=caml_make_vect(l,caml_call1(f,0)),_BZ_=l - 1 | 0,_BY_=1;
        if(!(_BZ_ < 1))
         {var i=_BY_;
          for(;;)
           {res[i + 1] = caml_call1(f,i);
            var _B0_=i + 1 | 0;
            if(_BZ_ !== i){var i=_B0_;continue}
            break}}
        return res}
      return invalid_arg(_y_)}
    function copy(a)
     {var l=a.length - 1;return 0 === l?[0]:caml_array_sub(a,0,l)}
    function append$0(a1,a2)
     {var l1=a1.length - 1;
      return 0 === l1
              ?copy(a2)
              :0 === a2.length - 1
                ?caml_array_sub(a1,0,l1)
                :caml_array_append(a1,a2)}
    function sub$1(a,ofs,len)
     {if(0 <= ofs)
       if(0 <= len)
        if(!((a.length - 1 - len | 0) < ofs))return caml_array_sub(a,ofs,len);
      return invalid_arg(_z_)}
    function map$0(f,a)
     {var l=a.length - 1;
      if(0 === l)return [0];
      var r=caml_make_vect(l,caml_call1(f,a[1])),_BW_=l - 1 | 0,_BV_=1;
      if(!(_BW_ < 1))
       {var i=_BV_;
        for(;;)
         {r[i + 1] = caml_call1(f,a[i + 1]);
          var _BX_=i + 1 | 0;
          if(_BW_ !== i){var i=_BX_;continue}
          break}}
      return r}
    function iteri(f,a)
     {var _BT_=a.length - 1 - 1 | 0,_BS_=0;
      if(!(_BT_ < 0))
       {var i=_BS_;
        for(;;)
         {caml_call2(f,i,a[i + 1]);
          var _BU_=i + 1 | 0;
          if(_BT_ !== i){var i=_BU_;continue}
          break}}
      return 0}
    function to_list(a)
     {var i$1=a.length - 1 - 1 | 0,i=i$1,res=0;
      for(;;)
       {if(0 <= i)
         {var res$0=[0,a[i + 1],res],i$0=i - 1 | 0,i=i$0,res=res$0;continue}
        return res}}
    function of_list(l)
     {if(l)
       {var tl=l[2],hd=l[1],accu=0,param=l;
        for(;;)
         {if(param)
           {var
             param$0=param[2],
             accu$0=accu + 1 | 0,
             accu=accu$0,
             param=param$0;
            continue}
          var a=caml_make_vect(accu,hd),i=1,param$1=tl;
          for(;;)
           {if(param$1)
             {var tl$0=param$1[2],hd$0=param$1[1];
              a[i + 1] = hd$0;
              var i$0=i + 1 | 0,i=i$0,param$1=tl$0;
              continue}
            return a}}}
      return [0]}
    function fold_left$0(f,x,a)
     {var r=[0,x],_BQ_=a.length - 1 - 1 | 0,_BP_=0;
      if(!(_BQ_ < 0))
       {var i=_BP_;
        for(;;)
         {r[1] = caml_call2(f,r[1],a[i + 1]);
          var _BR_=i + 1 | 0;
          if(_BQ_ !== i){var i=_BR_;continue}
          break}}
      return r[1]}
    caml_fresh_oo_id(0);
    var Undefined=[248,_B_,caml_fresh_oo_id(0)];
    function raise_undefined(param){throw Undefined}
    function force_lazy_block(blk)
     {var closure=blk[1];
      blk[1] = raise_undefined;
      try
       {var result=caml_call1(closure,0);
        blk[1] = result;
        caml_obj_set_tag(blk,250);
        return result}
      catch(e)
       {e = caml_wrap_exception(e);blk[1] = function(param){throw e};throw e}}
    function create(n)
     {var
       n$0=1 <= n?n:1,
       n$1=max_string_length < n$0?max_string_length:n$0,
       s=caml_create_bytes(n$1);
      return [0,s,0,n$1,s]}
    function contents(b){return sub_string(b[1],0,b[2])}
    function resize(b,more)
     {var len=b[3],new_len=[0,len];
      for(;;)
       {if(new_len[1] < (b[2] + more | 0))
         {new_len[1] = 2 * new_len[1] | 0;continue}
        if(max_string_length < new_len[1])
         if((b[2] + more | 0) <= max_string_length)
          new_len[1] = max_string_length;
         else
          failwith(_D_);
        var new_buffer=caml_create_bytes(new_len[1]);
        blit(b[1],0,new_buffer,0,b[2]);
        b[1] = new_buffer;
        b[3] = new_len[1];
        return 0}}
    function add_string(b,s)
     {var len=caml_ml_string_length(s),new_position=b[2] + len | 0;
      if(b[3] < new_position)resize(b,len);
      blit$0(s,0,b[1],b[2],len);
      b[2] = new_position;
      return 0}
    var default_float_precision=-6;
    function buffer_create(init_size)
     {return [0,0,caml_create_bytes(init_size)]}
    function buffer_check_size(buf,overhead)
     {var
       len=caml_ml_bytes_length(buf[2]),
       min_len=buf[1] + overhead | 0,
       _BN_=len < min_len?1:0;
      if(_BN_)
       {var
         new_len=max(len * 2 | 0,min_len),
         new_str=caml_create_bytes(new_len);
        blit(buf[2],0,new_str,0,len);
        buf[2] = new_str;
        var _BO_=0}
      else
       var _BO_=_BN_;
      return _BO_}
    function buffer_add_char(buf,c)
     {buffer_check_size(buf,1);
      caml_bytes_set(buf[2],buf[1],c);
      buf[1] = buf[1] + 1 | 0;
      return 0}
    function buffer_add_string(buf,s)
     {var str_len=caml_ml_string_length(s);
      buffer_check_size(buf,str_len);
      blit$0(s,0,buf[2],buf[1],str_len);
      buf[1] = buf[1] + str_len | 0;
      return 0}
    function buffer_contents(buf){return sub_string(buf[2],0,buf[1])}
    function string_of_formatting_lit(formatting_lit)
     {if(typeof formatting_lit === "number")
       switch(formatting_lit)
        {case 0:return _F_;
         case 1:return _G_;
         case 2:return _H_;
         case 3:return _I_;
         case 4:return _J_;
         case 5:return _K_;
         default:return _L_}
      else
       switch(formatting_lit[0])
        {case 0:var str=formatting_lit[1];return str;
         case 1:var str$0=formatting_lit[1];return str$0;
         default:var c=formatting_lit[1];return _d_(_M_,make$0(1,c))}}
    function bprint_fmtty(buf,fmtty)
     {var fmtty$0=fmtty;
      for(;;)
       if(typeof fmtty$0 === "number")
        return 0;
       else
        switch(fmtty$0[0])
         {case 0:
           var rest=fmtty$0[1];
           buffer_add_string(buf,_N_);
           var fmtty$0=rest;
           continue;
          case 1:
           var rest$0=fmtty$0[1];
           buffer_add_string(buf,_O_);
           var fmtty$0=rest$0;
           continue;
          case 2:
           var rest$1=fmtty$0[1];
           buffer_add_string(buf,_P_);
           var fmtty$0=rest$1;
           continue;
          case 3:
           var rest$2=fmtty$0[1];
           buffer_add_string(buf,_Q_);
           var fmtty$0=rest$2;
           continue;
          case 4:
           var rest$3=fmtty$0[1];
           buffer_add_string(buf,_R_);
           var fmtty$0=rest$3;
           continue;
          case 5:
           var rest$4=fmtty$0[1];
           buffer_add_string(buf,_S_);
           var fmtty$0=rest$4;
           continue;
          case 6:
           var rest$5=fmtty$0[1];
           buffer_add_string(buf,_T_);
           var fmtty$0=rest$5;
           continue;
          case 7:
           var rest$6=fmtty$0[1];
           buffer_add_string(buf,_U_);
           var fmtty$0=rest$6;
           continue;
          case 8:
           var rest$7=fmtty$0[2],sub_fmtty=fmtty$0[1];
           buffer_add_string(buf,_V_);
           bprint_fmtty(buf,sub_fmtty);
           buffer_add_string(buf,_W_);
           var fmtty$0=rest$7;
           continue;
          case 9:
           var rest$8=fmtty$0[3],sub_fmtty$0=fmtty$0[1];
           buffer_add_string(buf,_X_);
           bprint_fmtty(buf,sub_fmtty$0);
           buffer_add_string(buf,_Y_);
           var fmtty$0=rest$8;
           continue;
          case 10:
           var rest$9=fmtty$0[1];
           buffer_add_string(buf,_Z_);
           var fmtty$0=rest$9;
           continue;
          case 11:
           var rest$10=fmtty$0[1];
           buffer_add_string(buf,___);
           var fmtty$0=rest$10;
           continue;
          case 12:
           var rest$11=fmtty$0[1];
           buffer_add_string(buf,_$_);
           var fmtty$0=rest$11;
           continue;
          case 13:
           var rest$12=fmtty$0[1];
           buffer_add_string(buf,_aa_);
           var fmtty$0=rest$12;
           continue;
          default:
           var rest$13=fmtty$0[1];
           buffer_add_string(buf,_ab_);
           var fmtty$0=rest$13;
           continue}}
    function symm(param)
     {if(typeof param === "number")
       return 0;
      else
       switch(param[0])
        {case 0:var rest=param[1];return [0,symm(rest)];
         case 1:var rest$0=param[1];return [1,symm(rest$0)];
         case 2:var rest$1=param[1];return [2,symm(rest$1)];
         case 3:var rest$2=param[1];return [3,symm(rest$2)];
         case 4:var rest$3=param[1];return [4,symm(rest$3)];
         case 5:var rest$4=param[1];return [5,symm(rest$4)];
         case 6:var rest$5=param[1];return [6,symm(rest$5)];
         case 7:var rest$6=param[1];return [7,symm(rest$6)];
         case 8:var rest$7=param[2],ty=param[1];return [8,ty,symm(rest$7)];
         case 9:
          var rest$8=param[3],ty2=param[2],ty1=param[1];
          return [9,ty2,ty1,symm(rest$8)];
         case 10:var rest$9=param[1];return [10,symm(rest$9)];
         case 11:var rest$10=param[1];return [11,symm(rest$10)];
         case 12:var rest$11=param[1];return [12,symm(rest$11)];
         case 13:var rest$12=param[1];return [13,symm(rest$12)];
         default:var rest$13=param[1];return [14,symm(rest$13)]}}
    function fmtty_rel_det(param)
     {if(typeof param === "number")
       {var
         _Bp_=function(param){return 0},
         _Bq_=function(param){return 0},
         _Br_=function(param){return 0};
        return [0,function(param){return 0},_Br_,_Bq_,_Bp_]}
      else
       switch(param[0])
        {case 0:
          var
           rest=param[1],
           match=fmtty_rel_det(rest),
           de=match[4],
           ed=match[3],
           af=match[2],
           fa=match[1],
           _Bs_=function(param){caml_call1(af,0);return 0};
          return [0,function(param){caml_call1(fa,0);return 0},_Bs_,ed,de];
         case 1:
          var
           rest$0=param[1],
           match$0=fmtty_rel_det(rest$0),
           de$0=match$0[4],
           ed$0=match$0[3],
           af$0=match$0[2],
           fa$0=match$0[1],
           _Bt_=function(param){caml_call1(af$0,0);return 0};
          return [0,
                  function(param){caml_call1(fa$0,0);return 0},
                  _Bt_,
                  ed$0,
                  de$0];
         case 2:
          var
           rest$1=param[1],
           match$1=fmtty_rel_det(rest$1),
           de$1=match$1[4],
           ed$1=match$1[3],
           af$1=match$1[2],
           fa$1=match$1[1],
           _Bu_=function(param){caml_call1(af$1,0);return 0};
          return [0,
                  function(param){caml_call1(fa$1,0);return 0},
                  _Bu_,
                  ed$1,
                  de$1];
         case 3:
          var
           rest$2=param[1],
           match$2=fmtty_rel_det(rest$2),
           de$2=match$2[4],
           ed$2=match$2[3],
           af$2=match$2[2],
           fa$2=match$2[1],
           _Bv_=function(param){caml_call1(af$2,0);return 0};
          return [0,
                  function(param){caml_call1(fa$2,0);return 0},
                  _Bv_,
                  ed$2,
                  de$2];
         case 4:
          var
           rest$3=param[1],
           match$3=fmtty_rel_det(rest$3),
           de$3=match$3[4],
           ed$3=match$3[3],
           af$3=match$3[2],
           fa$3=match$3[1],
           _Bw_=function(param){caml_call1(af$3,0);return 0};
          return [0,
                  function(param){caml_call1(fa$3,0);return 0},
                  _Bw_,
                  ed$3,
                  de$3];
         case 5:
          var
           rest$4=param[1],
           match$4=fmtty_rel_det(rest$4),
           de$4=match$4[4],
           ed$4=match$4[3],
           af$4=match$4[2],
           fa$4=match$4[1],
           _Bx_=function(param){caml_call1(af$4,0);return 0};
          return [0,
                  function(param){caml_call1(fa$4,0);return 0},
                  _Bx_,
                  ed$4,
                  de$4];
         case 6:
          var
           rest$5=param[1],
           match$5=fmtty_rel_det(rest$5),
           de$5=match$5[4],
           ed$5=match$5[3],
           af$5=match$5[2],
           fa$5=match$5[1],
           _By_=function(param){caml_call1(af$5,0);return 0};
          return [0,
                  function(param){caml_call1(fa$5,0);return 0},
                  _By_,
                  ed$5,
                  de$5];
         case 7:
          var
           rest$6=param[1],
           match$6=fmtty_rel_det(rest$6),
           de$6=match$6[4],
           ed$6=match$6[3],
           af$6=match$6[2],
           fa$6=match$6[1],
           _Bz_=function(param){caml_call1(af$6,0);return 0};
          return [0,
                  function(param){caml_call1(fa$6,0);return 0},
                  _Bz_,
                  ed$6,
                  de$6];
         case 8:
          var
           rest$7=param[2],
           match$7=fmtty_rel_det(rest$7),
           de$7=match$7[4],
           ed$7=match$7[3],
           af$7=match$7[2],
           fa$7=match$7[1],
           _BA_=function(param){caml_call1(af$7,0);return 0};
          return [0,
                  function(param){caml_call1(fa$7,0);return 0},
                  _BA_,
                  ed$7,
                  de$7];
         case 9:
          var
           rest$8=param[3],
           ty2=param[2],
           ty1=param[1],
           match$8=fmtty_rel_det(rest$8),
           de$8=match$8[4],
           ed$8=match$8[3],
           af$8=match$8[2],
           fa$8=match$8[1],
           ty=trans(symm(ty1),ty2),
           match$9=fmtty_rel_det(ty),
           jd=match$9[4],
           dj=match$9[3],
           ga=match$9[2],
           ag=match$9[1],
           _BB_=function(param){caml_call1(jd,0);caml_call1(de$8,0);return 0},
           _BC_=function(param){caml_call1(ed$8,0);caml_call1(dj,0);return 0},
           _BD_=function(param){caml_call1(ga,0);caml_call1(af$8,0);return 0};
          return [0,
                  function(param)
                   {caml_call1(fa$8,0);caml_call1(ag,0);return 0},
                  _BD_,
                  _BC_,
                  _BB_];
         case 10:
          var
           rest$9=param[1],
           match$10=fmtty_rel_det(rest$9),
           de$9=match$10[4],
           ed$9=match$10[3],
           af$9=match$10[2],
           fa$9=match$10[1],
           _BE_=function(param){caml_call1(af$9,0);return 0};
          return [0,
                  function(param){caml_call1(fa$9,0);return 0},
                  _BE_,
                  ed$9,
                  de$9];
         case 11:
          var
           rest$10=param[1],
           match$11=fmtty_rel_det(rest$10),
           de$10=match$11[4],
           ed$10=match$11[3],
           af$10=match$11[2],
           fa$10=match$11[1],
           _BF_=function(param){caml_call1(af$10,0);return 0};
          return [0,
                  function(param){caml_call1(fa$10,0);return 0},
                  _BF_,
                  ed$10,
                  de$10];
         case 12:
          var
           rest$11=param[1],
           match$12=fmtty_rel_det(rest$11),
           de$11=match$12[4],
           ed$11=match$12[3],
           af$11=match$12[2],
           fa$11=match$12[1],
           _BG_=function(param){caml_call1(af$11,0);return 0};
          return [0,
                  function(param){caml_call1(fa$11,0);return 0},
                  _BG_,
                  ed$11,
                  de$11];
         case 13:
          var
           rest$12=param[1],
           match$13=fmtty_rel_det(rest$12),
           de$12=match$13[4],
           ed$12=match$13[3],
           af$12=match$13[2],
           fa$12=match$13[1],
           _BH_=function(param){caml_call1(de$12,0);return 0},
           _BI_=function(param){caml_call1(ed$12,0);return 0},
           _BJ_=function(param){caml_call1(af$12,0);return 0};
          return [0,
                  function(param){caml_call1(fa$12,0);return 0},
                  _BJ_,
                  _BI_,
                  _BH_];
         default:
          var
           rest$13=param[1],
           match$14=fmtty_rel_det(rest$13),
           de$13=match$14[4],
           ed$13=match$14[3],
           af$13=match$14[2],
           fa$13=match$14[1],
           _BK_=function(param){caml_call1(de$13,0);return 0},
           _BL_=function(param){caml_call1(ed$13,0);return 0},
           _BM_=function(param){caml_call1(af$13,0);return 0};
          return [0,
                  function(param){caml_call1(fa$13,0);return 0},
                  _BM_,
                  _BL_,
                  _BK_]}}
    function trans(ty1,match)
     {if(typeof ty1 === "number")
       if(typeof match === "number")
        return 0;
       else
        switch(match[0])
         {case 10:var switch$0=0;break;
          case 11:var switch$0=1;break;
          case 12:var switch$0=2;break;
          case 13:var switch$0=3;break;
          case 14:var switch$0=4;break;
          case 8:var switch$0=5;break;
          case 9:var switch$0=6;break;
          default:throw [0,Assert_failure,_ac_]}
      else
       switch(ty1[0])
        {case 0:
          var _A8_=ty1[1];
          if(typeof match === "number")
           var switch$1=1;
          else
           switch(match[0])
            {case 0:var rest2=match[1];return [0,trans(_A8_,rest2)];
             case 8:var switch$0=5,switch$1=0;break;
             case 9:var switch$0=6,switch$1=0;break;
             case 10:var switch$0=0,switch$1=0;break;
             case 11:var switch$0=1,switch$1=0;break;
             case 12:var switch$0=2,switch$1=0;break;
             case 13:var switch$0=3,switch$1=0;break;
             case 14:var switch$0=4,switch$1=0;break;
             default:var switch$1=1}
          if(switch$1)var switch$0=7;
          break;
         case 1:
          var _A9_=ty1[1];
          if(typeof match === "number")
           var switch$2=1;
          else
           switch(match[0])
            {case 1:var rest2$0=match[1];return [1,trans(_A9_,rest2$0)];
             case 8:var switch$0=5,switch$2=0;break;
             case 9:var switch$0=6,switch$2=0;break;
             case 10:var switch$0=0,switch$2=0;break;
             case 11:var switch$0=1,switch$2=0;break;
             case 12:var switch$0=2,switch$2=0;break;
             case 13:var switch$0=3,switch$2=0;break;
             case 14:var switch$0=4,switch$2=0;break;
             default:var switch$2=1}
          if(switch$2)var switch$0=7;
          break;
         case 2:
          var _A__=ty1[1];
          if(typeof match === "number")
           var switch$3=1;
          else
           switch(match[0])
            {case 2:var rest2$1=match[1];return [2,trans(_A__,rest2$1)];
             case 8:var switch$0=5,switch$3=0;break;
             case 9:var switch$0=6,switch$3=0;break;
             case 10:var switch$0=0,switch$3=0;break;
             case 11:var switch$0=1,switch$3=0;break;
             case 12:var switch$0=2,switch$3=0;break;
             case 13:var switch$0=3,switch$3=0;break;
             case 14:var switch$0=4,switch$3=0;break;
             default:var switch$3=1}
          if(switch$3)var switch$0=7;
          break;
         case 3:
          var _A$_=ty1[1];
          if(typeof match === "number")
           var switch$4=1;
          else
           switch(match[0])
            {case 3:var rest2$2=match[1];return [3,trans(_A$_,rest2$2)];
             case 8:var switch$0=5,switch$4=0;break;
             case 9:var switch$0=6,switch$4=0;break;
             case 10:var switch$0=0,switch$4=0;break;
             case 11:var switch$0=1,switch$4=0;break;
             case 12:var switch$0=2,switch$4=0;break;
             case 13:var switch$0=3,switch$4=0;break;
             case 14:var switch$0=4,switch$4=0;break;
             default:var switch$4=1}
          if(switch$4)var switch$0=7;
          break;
         case 4:
          var _Ba_=ty1[1];
          if(typeof match === "number")
           var switch$5=1;
          else
           switch(match[0])
            {case 4:var rest2$3=match[1];return [4,trans(_Ba_,rest2$3)];
             case 8:var switch$0=5,switch$5=0;break;
             case 9:var switch$0=6,switch$5=0;break;
             case 10:var switch$0=0,switch$5=0;break;
             case 11:var switch$0=1,switch$5=0;break;
             case 12:var switch$0=2,switch$5=0;break;
             case 13:var switch$0=3,switch$5=0;break;
             case 14:var switch$0=4,switch$5=0;break;
             default:var switch$5=1}
          if(switch$5)var switch$0=7;
          break;
         case 5:
          var _Bb_=ty1[1];
          if(typeof match === "number")
           var switch$6=1;
          else
           switch(match[0])
            {case 5:var rest2$4=match[1];return [5,trans(_Bb_,rest2$4)];
             case 8:var switch$0=5,switch$6=0;break;
             case 9:var switch$0=6,switch$6=0;break;
             case 10:var switch$0=0,switch$6=0;break;
             case 11:var switch$0=1,switch$6=0;break;
             case 12:var switch$0=2,switch$6=0;break;
             case 13:var switch$0=3,switch$6=0;break;
             case 14:var switch$0=4,switch$6=0;break;
             default:var switch$6=1}
          if(switch$6)var switch$0=7;
          break;
         case 6:
          var _Bc_=ty1[1];
          if(typeof match === "number")
           var switch$7=1;
          else
           switch(match[0])
            {case 6:var rest2$5=match[1];return [6,trans(_Bc_,rest2$5)];
             case 8:var switch$0=5,switch$7=0;break;
             case 9:var switch$0=6,switch$7=0;break;
             case 10:var switch$0=0,switch$7=0;break;
             case 11:var switch$0=1,switch$7=0;break;
             case 12:var switch$0=2,switch$7=0;break;
             case 13:var switch$0=3,switch$7=0;break;
             case 14:var switch$0=4,switch$7=0;break;
             default:var switch$7=1}
          if(switch$7)var switch$0=7;
          break;
         case 7:
          var _Bd_=ty1[1];
          if(typeof match === "number")
           var switch$8=1;
          else
           switch(match[0])
            {case 7:var rest2$6=match[1];return [7,trans(_Bd_,rest2$6)];
             case 8:var switch$0=5,switch$8=0;break;
             case 9:var switch$0=6,switch$8=0;break;
             case 10:var switch$0=0,switch$8=0;break;
             case 11:var switch$0=1,switch$8=0;break;
             case 12:var switch$0=2,switch$8=0;break;
             case 13:var switch$0=3,switch$8=0;break;
             case 14:var switch$0=4,switch$8=0;break;
             default:var switch$8=1}
          if(switch$8)var switch$0=7;
          break;
         case 8:
          var _Be_=ty1[2],_Bf_=ty1[1];
          if(typeof match === "number")
           var switch$9=1;
          else
           switch(match[0])
            {case 8:
              var rest2$7=match[2],ty2=match[1],_Bg_=trans(_Be_,rest2$7);
              return [8,trans(_Bf_,ty2),_Bg_];
             case 10:var switch$0=0,switch$9=0;break;
             case 11:var switch$0=1,switch$9=0;break;
             case 12:var switch$0=2,switch$9=0;break;
             case 13:var switch$0=3,switch$9=0;break;
             case 14:var switch$0=4,switch$9=0;break;
             default:var switch$9=1}
          if(switch$9)throw [0,Assert_failure,_al_];
          break;
         case 9:
          var _Bh_=ty1[3],_Bi_=ty1[2],_Bj_=ty1[1];
          if(typeof match === "number")
           var switch$10=1;
          else
           switch(match[0])
            {case 8:var switch$0=5,switch$10=0;break;
             case 9:
              var
               rest2$8=match[3],
               ty22=match[2],
               ty21=match[1],
               ty=trans(symm(_Bi_),ty21),
               match$0=fmtty_rel_det(ty),
               f4=match$0[4],
               f2=match$0[2];
              caml_call1(f2,0);
              caml_call1(f4,0);
              return [9,_Bj_,ty22,trans(_Bh_,rest2$8)];
             case 10:var switch$0=0,switch$10=0;break;
             case 11:var switch$0=1,switch$10=0;break;
             case 12:var switch$0=2,switch$10=0;break;
             case 13:var switch$0=3,switch$10=0;break;
             case 14:var switch$0=4,switch$10=0;break;
             default:var switch$10=1}
          if(switch$10)throw [0,Assert_failure,_am_];
          break;
         case 10:
          var _Bk_=ty1[1];
          if(typeof match !== "number" && 10 === match[0])
           {var rest2$9=match[1];return [10,trans(_Bk_,rest2$9)]}
          throw [0,Assert_failure,_an_];
         case 11:
          var _Bl_=ty1[1];
          if(typeof match === "number")
           var switch$11=1;
          else
           switch(match[0])
            {case 10:var switch$0=0,switch$11=0;break;
             case 11:var rest2$10=match[1];return [11,trans(_Bl_,rest2$10)];
             default:var switch$11=1}
          if(switch$11)throw [0,Assert_failure,_ao_];
          break;
         case 12:
          var _Bm_=ty1[1];
          if(typeof match === "number")
           var switch$12=1;
          else
           switch(match[0])
            {case 10:var switch$0=0,switch$12=0;break;
             case 11:var switch$0=1,switch$12=0;break;
             case 12:var rest2$11=match[1];return [12,trans(_Bm_,rest2$11)];
             default:var switch$12=1}
          if(switch$12)throw [0,Assert_failure,_ap_];
          break;
         case 13:
          var _Bn_=ty1[1];
          if(typeof match === "number")
           var switch$13=1;
          else
           switch(match[0])
            {case 10:var switch$0=0,switch$13=0;break;
             case 11:var switch$0=1,switch$13=0;break;
             case 12:var switch$0=2,switch$13=0;break;
             case 13:var rest2$12=match[1];return [13,trans(_Bn_,rest2$12)];
             default:var switch$13=1}
          if(switch$13)throw [0,Assert_failure,_aq_];
          break;
         default:
          var _Bo_=ty1[1];
          if(typeof match === "number")
           var switch$14=1;
          else
           switch(match[0])
            {case 10:var switch$0=0,switch$14=0;break;
             case 11:var switch$0=1,switch$14=0;break;
             case 12:var switch$0=2,switch$14=0;break;
             case 13:var switch$0=3,switch$14=0;break;
             case 14:var rest2$13=match[1];return [14,trans(_Bo_,rest2$13)];
             default:var switch$14=1}
          if(switch$14)throw [0,Assert_failure,_ar_]}
      switch(switch$0)
       {case 0:throw [0,Assert_failure,_af_];
        case 1:throw [0,Assert_failure,_ag_];
        case 2:throw [0,Assert_failure,_ah_];
        case 3:throw [0,Assert_failure,_ai_];
        case 4:throw [0,Assert_failure,_aj_];
        case 5:throw [0,Assert_failure,_ad_];
        case 6:throw [0,Assert_failure,_ae_];
        default:throw [0,Assert_failure,_ak_]}}
    var Type_mismatch=[248,_as_,caml_fresh_oo_id(0)];
    function type_padding(pad,match)
     {if(typeof pad === "number")
       return [0,0,match];
      else
       {if(0 === pad[0])
         {var w=pad[2],padty=pad[1];return [0,[0,padty,w],match]}
        if(typeof match !== "number" && 2 === match[0])
         {var rest=match[1],padty$0=pad[1];return [0,[1,padty$0],rest]}
        throw Type_mismatch}}
    function type_padprec(pad,prec,fmtty)
     {var match=type_padding(pad,fmtty);
      if(typeof prec === "number")
       {if(0 === prec)
         {var rest=match[2],pad$0=match[1];return [0,pad$0,0,rest]}
        var _A7_=match[2];
        if(typeof _A7_ !== "number" && 2 === _A7_[0])
         {var rest$0=_A7_[1],pad$1=match[1];return [0,pad$1,1,rest$0]}
        throw Type_mismatch}
      var rest$1=match[2],pad$2=match[1],p=prec[1];
      return [0,pad$2,[0,p],rest$1]}
    function type_ignored_param_one(ign,fmt,fmtty)
     {var match=type_format_gen(fmt,fmtty),fmtty$0=match[2],fmt$0=match[1];
      return [0,[23,ign,fmt$0],fmtty$0]}
    function type_format_gen(fmt,fmtty)
     {if(typeof fmt === "number")
       return [0,0,fmtty];
      else
       switch(fmt[0])
        {case 0:
          if(typeof fmtty !== "number" && 0 === fmtty[0])
           {var
             fmtty_rest=fmtty[1],
             fmt_rest=fmt[1],
             match=type_format_gen(fmt_rest,fmtty_rest),
             fmtty$0=match[2],
             fmt$0=match[1];
            return [0,[0,fmt$0],fmtty$0]}
          break;
         case 1:
          if(typeof fmtty !== "number" && 0 === fmtty[0])
           {var
             fmtty_rest$0=fmtty[1],
             fmt_rest$0=fmt[1],
             match$0=type_format_gen(fmt_rest$0,fmtty_rest$0),
             fmtty$1=match$0[2],
             fmt$1=match$0[1];
            return [0,[1,fmt$1],fmtty$1]}
          break;
         case 2:
          var
           fmt_rest$1=fmt[2],
           pad=fmt[1],
           _AC_=type_padding(pad,fmtty),
           _AD_=_AC_[2],
           _AE_=_AC_[1];
          if(typeof _AD_ !== "number" && 1 === _AD_[0])
           {var
             fmtty_rest$1=_AD_[1],
             match$1=type_format_gen(fmt_rest$1,fmtty_rest$1),
             fmtty$2=match$1[2],
             fmt$2=match$1[1];
            return [0,[2,_AE_,fmt$2],fmtty$2]}
          throw Type_mismatch;
         case 3:
          var
           fmt_rest$2=fmt[2],
           pad$0=fmt[1],
           _AF_=type_padding(pad$0,fmtty),
           _AG_=_AF_[2],
           _AH_=_AF_[1];
          if(typeof _AG_ !== "number" && 1 === _AG_[0])
           {var
             fmtty_rest$2=_AG_[1],
             match$2=type_format_gen(fmt_rest$2,fmtty_rest$2),
             fmtty$3=match$2[2],
             fmt$3=match$2[1];
            return [0,[3,_AH_,fmt$3],fmtty$3]}
          throw Type_mismatch;
         case 4:
          var
           fmt_rest$3=fmt[4],
           prec=fmt[3],
           pad$1=fmt[2],
           iconv=fmt[1],
           _AI_=type_padprec(pad$1,prec,fmtty),
           _AJ_=_AI_[3],
           _AK_=_AI_[2],
           _AL_=_AI_[1];
          if(typeof _AJ_ !== "number" && 2 === _AJ_[0])
           {var
             fmtty_rest$3=_AJ_[1],
             match$3=type_format_gen(fmt_rest$3,fmtty_rest$3),
             fmtty$4=match$3[2],
             fmt$4=match$3[1];
            return [0,[4,iconv,_AL_,_AK_,fmt$4],fmtty$4]}
          throw Type_mismatch;
         case 5:
          var
           fmt_rest$4=fmt[4],
           prec$0=fmt[3],
           pad$2=fmt[2],
           iconv$0=fmt[1],
           _AM_=type_padprec(pad$2,prec$0,fmtty),
           _AN_=_AM_[3],
           _AO_=_AM_[2],
           _AP_=_AM_[1];
          if(typeof _AN_ !== "number" && 3 === _AN_[0])
           {var
             fmtty_rest$4=_AN_[1],
             match$4=type_format_gen(fmt_rest$4,fmtty_rest$4),
             fmtty$5=match$4[2],
             fmt$5=match$4[1];
            return [0,[5,iconv$0,_AP_,_AO_,fmt$5],fmtty$5]}
          throw Type_mismatch;
         case 6:
          var
           fmt_rest$5=fmt[4],
           prec$1=fmt[3],
           pad$3=fmt[2],
           iconv$1=fmt[1],
           _AQ_=type_padprec(pad$3,prec$1,fmtty),
           _AR_=_AQ_[3],
           _AS_=_AQ_[2],
           _AT_=_AQ_[1];
          if(typeof _AR_ !== "number" && 4 === _AR_[0])
           {var
             fmtty_rest$5=_AR_[1],
             match$5=type_format_gen(fmt_rest$5,fmtty_rest$5),
             fmtty$6=match$5[2],
             fmt$6=match$5[1];
            return [0,[6,iconv$1,_AT_,_AS_,fmt$6],fmtty$6]}
          throw Type_mismatch;
         case 7:
          var
           fmt_rest$6=fmt[4],
           prec$2=fmt[3],
           pad$4=fmt[2],
           iconv$2=fmt[1],
           _AU_=type_padprec(pad$4,prec$2,fmtty),
           _AV_=_AU_[3],
           _AW_=_AU_[2],
           _AX_=_AU_[1];
          if(typeof _AV_ !== "number" && 5 === _AV_[0])
           {var
             fmtty_rest$6=_AV_[1],
             match$6=type_format_gen(fmt_rest$6,fmtty_rest$6),
             fmtty$7=match$6[2],
             fmt$7=match$6[1];
            return [0,[7,iconv$2,_AX_,_AW_,fmt$7],fmtty$7]}
          throw Type_mismatch;
         case 8:
          var
           fmt_rest$7=fmt[4],
           prec$3=fmt[3],
           pad$5=fmt[2],
           fconv=fmt[1],
           _AY_=type_padprec(pad$5,prec$3,fmtty),
           _AZ_=_AY_[3],
           _A0_=_AY_[2],
           _A1_=_AY_[1];
          if(typeof _AZ_ !== "number" && 6 === _AZ_[0])
           {var
             fmtty_rest$7=_AZ_[1],
             match$7=type_format_gen(fmt_rest$7,fmtty_rest$7),
             fmtty$8=match$7[2],
             fmt$8=match$7[1];
            return [0,[8,fconv,_A1_,_A0_,fmt$8],fmtty$8]}
          throw Type_mismatch;
         case 9:
          var
           fmt_rest$8=fmt[2],
           pad$6=fmt[1],
           _A2_=type_padding(pad$6,fmtty),
           _A3_=_A2_[2],
           _A4_=_A2_[1];
          if(typeof _A3_ !== "number" && 7 === _A3_[0])
           {var
             fmtty_rest$8=_A3_[1],
             match$8=type_format_gen(fmt_rest$8,fmtty_rest$8),
             fmtty$9=match$8[2],
             fmt$9=match$8[1];
            return [0,[9,_A4_,fmt$9],fmtty$9]}
          throw Type_mismatch;
         case 10:
          var
           fmt_rest$9=fmt[1],
           match$9=type_format_gen(fmt_rest$9,fmtty),
           fmtty$10=match$9[2],
           fmt$10=match$9[1];
          return [0,[10,fmt$10],fmtty$10];
         case 11:
          var
           fmt_rest$10=fmt[2],
           str=fmt[1],
           match$10=type_format_gen(fmt_rest$10,fmtty),
           fmtty$11=match$10[2],
           fmt$11=match$10[1];
          return [0,[11,str,fmt$11],fmtty$11];
         case 12:
          var
           fmt_rest$11=fmt[2],
           chr=fmt[1],
           match$11=type_format_gen(fmt_rest$11,fmtty),
           fmtty$12=match$11[2],
           fmt$12=match$11[1];
          return [0,[12,chr,fmt$12],fmtty$12];
         case 13:
          if(typeof fmtty !== "number" && 8 === fmtty[0])
           {var
             fmtty_rest$9=fmtty[2],
             sub_fmtty=fmtty[1],
             fmt_rest$12=fmt[3],
             sub_fmtty$0=fmt[2],
             pad_opt=fmt[1];
            if(caml_notequal([0,sub_fmtty$0],[0,sub_fmtty]))
             throw Type_mismatch;
            var
             match$12=type_format_gen(fmt_rest$12,fmtty_rest$9),
             fmtty$13=match$12[2],
             fmt$13=match$12[1];
            return [0,[13,pad_opt,sub_fmtty,fmt$13],fmtty$13]}
          break;
         case 14:
          if(typeof fmtty !== "number" && 9 === fmtty[0])
           {var
             fmtty_rest$10=fmtty[3],
             sub_fmtty1=fmtty[1],
             fmt_rest$13=fmt[3],
             sub_fmtty$1=fmt[2],
             pad_opt$0=fmt[1],
             _A5_=[0,erase_rel(sub_fmtty1)];
            if(caml_notequal([0,erase_rel(sub_fmtty$1)],_A5_))
             throw Type_mismatch;
            var
             match$13=type_format_gen(fmt_rest$13,erase_rel(fmtty_rest$10)),
             fmtty$14=match$13[2],
             fmt$14=match$13[1];
            return [0,[14,pad_opt$0,sub_fmtty1,fmt$14],fmtty$14]}
          break;
         case 15:
          if(typeof fmtty !== "number" && 10 === fmtty[0])
           {var
             fmtty_rest$11=fmtty[1],
             fmt_rest$14=fmt[1],
             match$14=type_format_gen(fmt_rest$14,fmtty_rest$11),
             fmtty$15=match$14[2],
             fmt$15=match$14[1];
            return [0,[15,fmt$15],fmtty$15]}
          break;
         case 16:
          if(typeof fmtty !== "number" && 11 === fmtty[0])
           {var
             fmtty_rest$12=fmtty[1],
             fmt_rest$15=fmt[1],
             match$15=type_format_gen(fmt_rest$15,fmtty_rest$12),
             fmtty$16=match$15[2],
             fmt$16=match$15[1];
            return [0,[16,fmt$16],fmtty$16]}
          break;
         case 17:
          var
           fmt_rest$16=fmt[2],
           formatting_lit=fmt[1],
           match$16=type_format_gen(fmt_rest$16,fmtty),
           fmtty$17=match$16[2],
           fmt$17=match$16[1];
          return [0,[17,formatting_lit,fmt$17],fmtty$17];
         case 18:
          var fmt_rest$17=fmt[2],formatting_gen=fmt[1];
          if(0 === formatting_gen[0])
           {var
             match$20=formatting_gen[1],
             str$0=match$20[2],
             fmt1=match$20[1],
             match$21=type_format_gen(fmt1,fmtty),
             fmtty2=match$21[2],
             fmt2=match$21[1],
             match$22=type_format_gen(fmt_rest$17,fmtty2),
             fmtty3=match$22[2],
             fmt3=match$22[1];
            return [0,[18,[0,[0,fmt2,str$0]],fmt3],fmtty3]}
          var
           match$23=formatting_gen[1],
           str$1=match$23[2],
           fmt1$0=match$23[1],
           match$24=type_format_gen(fmt1$0,fmtty),
           fmtty2$0=match$24[2],
           fmt2$0=match$24[1],
           match$25=type_format_gen(fmt_rest$17,fmtty2$0),
           fmtty3$0=match$25[2],
           fmt3$0=match$25[1];
          return [0,[18,[1,[0,fmt2$0,str$1]],fmt3$0],fmtty3$0];
         case 19:
          if(typeof fmtty !== "number" && 13 === fmtty[0])
           {var
             fmtty_rest$13=fmtty[1],
             fmt_rest$18=fmt[1],
             match$17=type_format_gen(fmt_rest$18,fmtty_rest$13),
             fmtty$18=match$17[2],
             fmt$18=match$17[1];
            return [0,[19,fmt$18],fmtty$18]}
          break;
         case 20:
          if(typeof fmtty !== "number" && 1 === fmtty[0])
           {var
             fmtty_rest$14=fmtty[1],
             fmt_rest$19=fmt[3],
             char_set=fmt[2],
             width_opt=fmt[1],
             match$18=type_format_gen(fmt_rest$19,fmtty_rest$14),
             fmtty$19=match$18[2],
             fmt$19=match$18[1];
            return [0,[20,width_opt,char_set,fmt$19],fmtty$19]}
          break;
         case 21:
          if(typeof fmtty !== "number" && 2 === fmtty[0])
           {var
             fmtty_rest$15=fmtty[1],
             fmt_rest$20=fmt[2],
             counter=fmt[1],
             match$19=type_format_gen(fmt_rest$20,fmtty_rest$15),
             fmtty$20=match$19[2],
             fmt$20=match$19[1];
            return [0,[21,counter,fmt$20],fmtty$20]}
          break;
         case 23:
          var rest=fmt[2],ign=fmt[1];
          if(typeof ign === "number")
           switch(ign)
            {case 0:return type_ignored_param_one(ign,rest,fmtty);
             case 1:return type_ignored_param_one(ign,rest,fmtty);
             case 2:
              if(typeof fmtty !== "number" && 14 === fmtty[0])
               {var
                 fmtty_rest$16=fmtty[1],
                 match$26=type_format_gen(rest,fmtty_rest$16),
                 fmtty$21=match$26[2],
                 fmt$21=match$26[1];
                return [0,[23,2,fmt$21],fmtty$21]}
              throw Type_mismatch;
             default:return type_ignored_param_one(ign,rest,fmtty)}
          else
           switch(ign[0])
            {case 0:return type_ignored_param_one(ign,rest,fmtty);
             case 1:return type_ignored_param_one(ign,rest,fmtty);
             case 2:return type_ignored_param_one(ign,rest,fmtty);
             case 3:return type_ignored_param_one(ign,rest,fmtty);
             case 4:return type_ignored_param_one(ign,rest,fmtty);
             case 5:return type_ignored_param_one(ign,rest,fmtty);
             case 6:return type_ignored_param_one(ign,rest,fmtty);
             case 7:return type_ignored_param_one(ign,rest,fmtty);
             case 8:
              var sub_fmtty$2=ign[2],pad_opt$1=ign[1];
              return type_ignored_param_one
                      ([8,pad_opt$1,sub_fmtty$2],rest,fmtty);
             case 9:
              var
               sub_fmtty$3=ign[2],
               pad_opt$2=ign[1],
               _A6_=type_ignored_format_substitution(sub_fmtty$3,rest,fmtty),
               match$27=_A6_[2],
               fmtty$22=match$27[2],
               fmt$22=match$27[1],
               sub_fmtty$4=_A6_[1];
              return [0,[23,[9,pad_opt$2,sub_fmtty$4],fmt$22],fmtty$22];
             case 10:return type_ignored_param_one(ign,rest,fmtty);
             default:return type_ignored_param_one(ign,rest,fmtty)}
         }
      throw Type_mismatch}
    function type_ignored_format_substitution(sub_fmtty,fmt,match)
     {if(typeof sub_fmtty === "number")
       return [0,0,type_format_gen(fmt,match)];
      else
       switch(sub_fmtty[0])
        {case 0:
          if(typeof match !== "number" && 0 === match[0])
           {var
             fmtty_rest=match[1],
             sub_fmtty_rest=sub_fmtty[1],
             match$0=
              type_ignored_format_substitution(sub_fmtty_rest,fmt,fmtty_rest),
             fmt$0=match$0[2],
             sub_fmtty_rest$0=match$0[1];
            return [0,[0,sub_fmtty_rest$0],fmt$0]}
          break;
         case 1:
          if(typeof match !== "number" && 1 === match[0])
           {var
             fmtty_rest$0=match[1],
             sub_fmtty_rest$1=sub_fmtty[1],
             match$1=
              type_ignored_format_substitution
               (sub_fmtty_rest$1,fmt,fmtty_rest$0),
             fmt$1=match$1[2],
             sub_fmtty_rest$2=match$1[1];
            return [0,[1,sub_fmtty_rest$2],fmt$1]}
          break;
         case 2:
          if(typeof match !== "number" && 2 === match[0])
           {var
             fmtty_rest$1=match[1],
             sub_fmtty_rest$3=sub_fmtty[1],
             match$2=
              type_ignored_format_substitution
               (sub_fmtty_rest$3,fmt,fmtty_rest$1),
             fmt$2=match$2[2],
             sub_fmtty_rest$4=match$2[1];
            return [0,[2,sub_fmtty_rest$4],fmt$2]}
          break;
         case 3:
          if(typeof match !== "number" && 3 === match[0])
           {var
             fmtty_rest$2=match[1],
             sub_fmtty_rest$5=sub_fmtty[1],
             match$3=
              type_ignored_format_substitution
               (sub_fmtty_rest$5,fmt,fmtty_rest$2),
             fmt$3=match$3[2],
             sub_fmtty_rest$6=match$3[1];
            return [0,[3,sub_fmtty_rest$6],fmt$3]}
          break;
         case 4:
          if(typeof match !== "number" && 4 === match[0])
           {var
             fmtty_rest$3=match[1],
             sub_fmtty_rest$7=sub_fmtty[1],
             match$4=
              type_ignored_format_substitution
               (sub_fmtty_rest$7,fmt,fmtty_rest$3),
             fmt$4=match$4[2],
             sub_fmtty_rest$8=match$4[1];
            return [0,[4,sub_fmtty_rest$8],fmt$4]}
          break;
         case 5:
          if(typeof match !== "number" && 5 === match[0])
           {var
             fmtty_rest$4=match[1],
             sub_fmtty_rest$9=sub_fmtty[1],
             match$5=
              type_ignored_format_substitution
               (sub_fmtty_rest$9,fmt,fmtty_rest$4),
             fmt$5=match$5[2],
             sub_fmtty_rest$10=match$5[1];
            return [0,[5,sub_fmtty_rest$10],fmt$5]}
          break;
         case 6:
          if(typeof match !== "number" && 6 === match[0])
           {var
             fmtty_rest$5=match[1],
             sub_fmtty_rest$11=sub_fmtty[1],
             match$6=
              type_ignored_format_substitution
               (sub_fmtty_rest$11,fmt,fmtty_rest$5),
             fmt$6=match$6[2],
             sub_fmtty_rest$12=match$6[1];
            return [0,[6,sub_fmtty_rest$12],fmt$6]}
          break;
         case 7:
          if(typeof match !== "number" && 7 === match[0])
           {var
             fmtty_rest$6=match[1],
             sub_fmtty_rest$13=sub_fmtty[1],
             match$7=
              type_ignored_format_substitution
               (sub_fmtty_rest$13,fmt,fmtty_rest$6),
             fmt$7=match$7[2],
             sub_fmtty_rest$14=match$7[1];
            return [0,[7,sub_fmtty_rest$14],fmt$7]}
          break;
         case 8:
          if(typeof match !== "number" && 8 === match[0])
           {var
             fmtty_rest$7=match[2],
             sub2_fmtty=match[1],
             sub_fmtty_rest$15=sub_fmtty[2],
             sub2_fmtty$0=sub_fmtty[1];
            if(caml_notequal([0,sub2_fmtty$0],[0,sub2_fmtty]))
             throw Type_mismatch;
            var
             match$8=
              type_ignored_format_substitution
               (sub_fmtty_rest$15,fmt,fmtty_rest$7),
             fmt$8=match$8[2],
             sub_fmtty_rest$16=match$8[1];
            return [0,[8,sub2_fmtty,sub_fmtty_rest$16],fmt$8]}
          break;
         case 9:
          if(typeof match !== "number" && 9 === match[0])
           {var
             fmtty_rest$8=match[3],
             sub2_fmtty$1=match[2],
             sub1_fmtty=match[1],
             sub_fmtty_rest$17=sub_fmtty[3],
             sub2_fmtty$2=sub_fmtty[2],
             sub1_fmtty$0=sub_fmtty[1],
             _AA_=[0,erase_rel(sub1_fmtty)];
            if(caml_notequal([0,erase_rel(sub1_fmtty$0)],_AA_))
             throw Type_mismatch;
            var _AB_=[0,erase_rel(sub2_fmtty$1)];
            if(caml_notequal([0,erase_rel(sub2_fmtty$2)],_AB_))
             throw Type_mismatch;
            var
             sub_fmtty$0=trans(symm(sub1_fmtty),sub2_fmtty$1),
             match$9=fmtty_rel_det(sub_fmtty$0),
             f4=match$9[4],
             f2=match$9[2];
            caml_call1(f2,0);
            caml_call1(f4,0);
            var
             match$10=
              type_ignored_format_substitution
               (erase_rel(sub_fmtty_rest$17),fmt,fmtty_rest$8),
             fmt$9=match$10[2],
             sub_fmtty_rest$18=match$10[1];
            return [0,
                    [9,sub1_fmtty,sub2_fmtty$1,symm(sub_fmtty_rest$18)],
                    fmt$9]}
          break;
         case 10:
          if(typeof match !== "number" && 10 === match[0])
           {var
             fmtty_rest$9=match[1],
             sub_fmtty_rest$19=sub_fmtty[1],
             match$11=
              type_ignored_format_substitution
               (sub_fmtty_rest$19,fmt,fmtty_rest$9),
             fmt$10=match$11[2],
             sub_fmtty_rest$20=match$11[1];
            return [0,[10,sub_fmtty_rest$20],fmt$10]}
          break;
         case 11:
          if(typeof match !== "number" && 11 === match[0])
           {var
             fmtty_rest$10=match[1],
             sub_fmtty_rest$21=sub_fmtty[1],
             match$12=
              type_ignored_format_substitution
               (sub_fmtty_rest$21,fmt,fmtty_rest$10),
             fmt$11=match$12[2],
             sub_fmtty_rest$22=match$12[1];
            return [0,[11,sub_fmtty_rest$22],fmt$11]}
          break;
         case 13:
          if(typeof match !== "number" && 13 === match[0])
           {var
             fmtty_rest$11=match[1],
             sub_fmtty_rest$23=sub_fmtty[1],
             match$13=
              type_ignored_format_substitution
               (sub_fmtty_rest$23,fmt,fmtty_rest$11),
             fmt$12=match$13[2],
             sub_fmtty_rest$24=match$13[1];
            return [0,[13,sub_fmtty_rest$24],fmt$12]}
          break;
         case 14:
          if(typeof match !== "number" && 14 === match[0])
           {var
             fmtty_rest$12=match[1],
             sub_fmtty_rest$25=sub_fmtty[1],
             match$14=
              type_ignored_format_substitution
               (sub_fmtty_rest$25,fmt,fmtty_rest$12),
             fmt$13=match$14[2],
             sub_fmtty_rest$26=match$14[1];
            return [0,[14,sub_fmtty_rest$26],fmt$13]}
          break
         }
      throw Type_mismatch}
    function recast(fmt$0,fmtty)
     {var fmtty$0=erase_rel(symm(fmtty)),_Az_=type_format_gen(fmt$0,fmtty$0);
      if(typeof _Az_[2] === "number"){var fmt=_Az_[1];return fmt}
      throw Type_mismatch}
    function fix_padding(padty,width,str)
     {var
       len=caml_ml_string_length(str),
       padty$0=0 <= width?padty:0,
       width$0=abs(width);
      if(width$0 <= len)return str;
      var _Ay_=2 === padty$0?48:32,res=make(width$0,_Ay_);
      switch(padty$0)
       {case 0:blit$0(str,0,res,0,len);break;
        case 1:blit$0(str,0,res,width$0 - len | 0,len);break;
        default:
         if(0 < len)
          {if(43 === caml_string_get(str,0))
            var switch$1=1;
           else
            if(45 === caml_string_get(str,0))
             var switch$1=1;
            else
             if(32 === caml_string_get(str,0))
              var switch$1=1;
             else
              var switch$0=0,switch$1=0;
           if(switch$1)
            {caml_bytes_set(res,0,caml_string_get(str,0));
             blit$0(str,1,res,(width$0 - len | 0) + 1 | 0,len - 1 | 0);
             var switch$0=1}}
         else
          var switch$0=0;
         if(!switch$0)
          {if(1 < len)
            if(48 === caml_string_get(str,0))
             {if(120 === caml_string_get(str,1))
               var switch$3=1;
              else
               if(88 === caml_string_get(str,1))
                var switch$3=1;
               else
                var switch$2=0,switch$3=0;
              if(switch$3)
               {caml_bytes_set(res,1,caml_string_get(str,1));
                blit$0(str,2,res,(width$0 - len | 0) + 2 | 0,len - 2 | 0);
                var switch$2=1}}
            else
             var switch$2=0;
           else
            var switch$2=0;
           if(!switch$2)blit$0(str,0,res,width$0 - len | 0,len)}}
      return res}
    function fix_int_precision(prec,str)
     {var
       prec$0=abs(prec),
       len=caml_ml_string_length(str),
       c=caml_string_get(str,0);
      if(58 <= c)
       var switch$0=71 <= c?5 < (c - 97 | 0) >>> 0?1:0:65 <= c?0:1;
      else
       {if(32 === c)
         var switch$1=1;
        else
         if(43 <= c)
          {var switcher=c - 43 | 0;
           switch(switcher)
            {case 5:
              if(len < (prec$0 + 2 | 0))
               if(1 < len)
                {var
                  switch$2=
                   120 === caml_string_get(str,1)
                    ?0
                    :88 === caml_string_get(str,1)?0:1;
                 if(!switch$2)
                  {var res$1=make(prec$0 + 2 | 0,48);
                   caml_bytes_set(res$1,1,caml_string_get(str,1));
                   blit$0(str,2,res$1,(prec$0 - len | 0) + 4 | 0,len - 2 | 0);
                   return res$1}}
              var switch$0=0,switch$1=0;
              break;
             case 0:
             case 2:var switch$1=1;break;
             case 1:
             case 3:
             case 4:var switch$0=1,switch$1=0;break;
             default:var switch$0=0,switch$1=0}}
         else
          var switch$0=1,switch$1=0;
        if(switch$1)
         {if(len < (prec$0 + 1 | 0))
           {var res$0=make(prec$0 + 1 | 0,48);
            caml_bytes_set(res$0,0,c);
            blit$0(str,1,res$0,(prec$0 - len | 0) + 2 | 0,len - 1 | 0);
            return res$0}
          var switch$0=1}}
      if(!switch$0)
       if(len < prec$0)
        {var res=make(prec$0,48);
         blit$0(str,0,res,prec$0 - len | 0,len);
         return res}
      return str}
    function string_to_caml_string(str)
     {var i$1=0;
      for(;;)
       {if(caml_ml_string_length(str) <= i$1)
         var _Ax_=0;
        else
         {var match$0=caml_string_unsafe_get(str,i$1);
          if(32 <= match$0)
           {var _Aw_=match$0 - 34 | 0;
            if(58 < _Aw_ >>> 0)
             if(93 <= _Aw_)var switch$0=0,switch$1=0;else var switch$1=1;
            else
             if(56 < (_Aw_ - 1 | 0) >>> 0)
              var switch$0=1,switch$1=0;
             else
              var switch$1=1;
            if(switch$1){var i$2=i$1 + 1 | 0,i$1=i$2;continue}}
          else
           var switch$0=11 <= match$0?13 === match$0?1:0:8 <= match$0?1:0;
          var _Ax_=switch$0?1:1}
        if(_Ax_)
         {var n=[0,0],_Ap_=caml_ml_bytes_length(str) - 1 | 0,_Ao_=0;
          if(!(_Ap_ < 0))
           {var i$0=_Ao_;
            for(;;)
             {var match=caml_string_unsafe_get(str,i$0);
              if(32 <= match)
               {var _At_=match - 34 | 0;
                if(58 < _At_ >>> 0)
                 if(93 <= _At_)var switch$2=0,switch$3=0;else var switch$3=1;
                else
                 if(56 < (_At_ - 1 | 0) >>> 0)
                  var switch$2=1,switch$3=0;
                 else
                  var switch$3=1;
                if(switch$3)var _Au_=1,switch$2=2}
              else
               var switch$2=11 <= match?13 === match?1:0:8 <= match?1:0;
              switch(switch$2)
               {case 0:var _Au_=4;break;case 1:var _Au_=2;break}
              n[1] = n[1] + _Au_ | 0;
              var _Av_=i$0 + 1 | 0;
              if(_Ap_ !== i$0){var i$0=_Av_;continue}
              break}}
          if(n[1] === caml_ml_bytes_length(str))
           {var len=caml_ml_bytes_length(str),r=caml_create_bytes(len);
            caml_blit_bytes(str,0,r,0,len);
            var str$0=r}
          else
           {var s=caml_create_bytes(n[1]);
            n[1] = 0;
            var _Ar_=caml_ml_bytes_length(str) - 1 | 0,_Aq_=0;
            if(!(_Ar_ < 0))
             {var i=_Aq_;
              for(;;)
               {var c=caml_string_unsafe_get(str,i);
                if(35 <= c)
                 var switch$4=92 === c?1:127 <= c?0:2;
                else
                 if(32 <= c)
                  var switch$4=34 <= c?1:2;
                 else
                  if(14 <= c)
                   var switch$4=0;
                  else
                   switch(c)
                    {case 8:
                      caml_string_unsafe_set(s,n[1],92);
                      n[1]++;
                      caml_string_unsafe_set(s,n[1],98);
                      var switch$4=3;
                      break;
                     case 9:
                      caml_string_unsafe_set(s,n[1],92);
                      n[1]++;
                      caml_string_unsafe_set(s,n[1],116);
                      var switch$4=3;
                      break;
                     case 10:
                      caml_string_unsafe_set(s,n[1],92);
                      n[1]++;
                      caml_string_unsafe_set(s,n[1],110);
                      var switch$4=3;
                      break;
                     case 13:
                      caml_string_unsafe_set(s,n[1],92);
                      n[1]++;
                      caml_string_unsafe_set(s,n[1],114);
                      var switch$4=3;
                      break;
                     default:var switch$4=0}
                switch(switch$4)
                 {case 0:
                   caml_string_unsafe_set(s,n[1],92);
                   n[1]++;
                   caml_string_unsafe_set(s,n[1],48 + (c / 100 | 0) | 0);
                   n[1]++;
                   caml_string_unsafe_set
                    (s,n[1],48 + ((c / 10 | 0) % 10 | 0) | 0);
                   n[1]++;
                   caml_string_unsafe_set(s,n[1],48 + (c % 10 | 0) | 0);
                   break;
                  case 1:
                   caml_string_unsafe_set(s,n[1],92);
                   n[1]++;
                   caml_string_unsafe_set(s,n[1],c);
                   break;
                  case 2:caml_string_unsafe_set(s,n[1],c);break
                  }
                n[1]++;
                var _As_=i + 1 | 0;
                if(_Ar_ !== i){var i=_As_;continue}
                break}}
            var str$0=s}}
        else
         var str$0=str;
        var l=caml_ml_string_length(str$0),res=make(l + 2 | 0,34);
        caml_blit_string(str$0,0,res,1,l);
        return res}}
    function convert_int(iconv,n)
     {switch(iconv)
       {case 0:var _An_=_at_;break;
        case 1:var _An_=_au_;break;
        case 2:var _An_=_av_;break;
        case 3:var _An_=_aw_;break;
        case 4:var _An_=_ax_;break;
        case 5:var _An_=_ay_;break;
        case 6:var _An_=_az_;break;
        case 7:var _An_=_aA_;break;
        case 8:var _An_=_aB_;break;
        case 9:var _An_=_aC_;break;
        case 10:var _An_=_aD_;break;
        case 11:var _An_=_aE_;break;
        default:var _An_=_aF_}
      return caml_format_int(_An_,n)}
    function convert_int32(iconv,n)
     {switch(iconv)
       {case 0:var _Am_=_aT_;break;
        case 1:var _Am_=_aU_;break;
        case 2:var _Am_=_aV_;break;
        case 3:var _Am_=_aW_;break;
        case 4:var _Am_=_aX_;break;
        case 5:var _Am_=_aY_;break;
        case 6:var _Am_=_aZ_;break;
        case 7:var _Am_=_a0_;break;
        case 8:var _Am_=_a1_;break;
        case 9:var _Am_=_a2_;break;
        case 10:var _Am_=_a3_;break;
        case 11:var _Am_=_a4_;break;
        default:var _Am_=_a5_}
      return caml_format_int(_Am_,n)}
    function convert_nativeint(iconv,n)
     {switch(iconv)
       {case 0:var _Al_=_a6_;break;
        case 1:var _Al_=_a7_;break;
        case 2:var _Al_=_a8_;break;
        case 3:var _Al_=_a9_;break;
        case 4:var _Al_=_a__;break;
        case 5:var _Al_=_a$_;break;
        case 6:var _Al_=_ba_;break;
        case 7:var _Al_=_bb_;break;
        case 8:var _Al_=_bc_;break;
        case 9:var _Al_=_bd_;break;
        case 10:var _Al_=_be_;break;
        case 11:var _Al_=_bf_;break;
        default:var _Al_=_bg_}
      return caml_format_int(_Al_,n)}
    function convert_int64(iconv,n)
     {switch(iconv)
       {case 0:var _Ak_=_aG_;break;
        case 1:var _Ak_=_aH_;break;
        case 2:var _Ak_=_aI_;break;
        case 3:var _Ak_=_aJ_;break;
        case 4:var _Ak_=_aK_;break;
        case 5:var _Ak_=_aL_;break;
        case 6:var _Ak_=_aM_;break;
        case 7:var _Ak_=_aN_;break;
        case 8:var _Ak_=_aO_;break;
        case 9:var _Ak_=_aP_;break;
        case 10:var _Ak_=_aQ_;break;
        case 11:var _Ak_=_aR_;break;
        default:var _Ak_=_aS_}
      return caml_int64_format(_Ak_,n)}
    function convert_float(fconv,prec$0,x)
     {if(16 <= fconv)
       {if(17 <= fconv)
         switch(fconv - 17 | 0)
          {case 2:var switch$0=0;break;
           case 0:
           case 3:var sign=43,switch$0=1;break;
           default:var sign=32,switch$0=1}
        else
         var switch$0=0;
        if(!switch$0)var sign=45;
        var s=caml_hexstring_of_float(x,prec$0,sign);
        if(19 <= fconv)
         {var l=caml_ml_bytes_length(s);
          if(0 === l)return s;
          var r=caml_create_bytes(l),_Ae_=l - 1 | 0,_Ad_=0;
          if(!(_Ae_ < 0))
           {var i=_Ad_;
            for(;;)
             {var c=caml_string_unsafe_get(s,i);
              if(97 <= c)
               if(122 < c)var switch$1=0;else var _Af_=c - 32 | 0,switch$1=1;
              else
               var switch$1=0;
              if(!switch$1)var _Af_=c;
              caml_string_unsafe_set(r,i,_Af_);
              var _Ag_=i + 1 | 0;
              if(_Ae_ !== i){var i=_Ag_;continue}
              break}}
          return r}
        return s}
      if(15 === fconv)
       var _Ah_=_bh_;
      else
       {var prec=abs(prec$0);
        switch(fconv)
         {case 15:var symb=70;break;
          case 0:
          case 1:
          case 2:var symb=102;break;
          case 3:
          case 4:
          case 5:var symb=101;break;
          case 6:
          case 7:
          case 8:var symb=69;break;
          case 9:
          case 10:
          case 11:var symb=103;break;
          case 12:
          case 13:
          case 14:var symb=71;break;
          case 16:
          case 17:
          case 18:var symb=104;break;
          default:var symb=72}
        var buf=buffer_create(16);
        buffer_add_char(buf,37);
        switch(fconv)
         {case 1:
          case 4:
          case 7:
          case 10:
          case 13:
          case 17:
          case 20:buffer_add_char(buf,43);break;
          case 2:
          case 5:
          case 8:
          case 11:
          case 14:
          case 18:
          case 21:buffer_add_char(buf,32);break
          }
        buffer_add_char(buf,46);
        buffer_add_string(buf,caml_new_string("" + prec));
        buffer_add_char(buf,symb);
        var _Ah_=buffer_contents(buf)}
      var str=caml_format_float(_Ah_,x);
      if(15 === fconv)
       {var len=caml_ml_string_length(str),match$0=caml_classify_float(x);
        if(3 === match$0)return x < 0?_bi_:_bj_;
        if(4 <= match$0)return _bk_;
        var i$0=0;
        for(;;)
         {if(i$0 === len)
           var _Aj_=0;
          else
           {var
             match=caml_string_get(str,i$0),
             _Ai_=match - 46 | 0,
             switch$2=
              23 < _Ai_ >>> 0?55 === _Ai_?1:0:21 < (_Ai_ - 1 | 0) >>> 0?1:0;
            if(!switch$2){var i$1=i$0 + 1 | 0,i$0=i$1;continue}
            var _Aj_=1}
          return _Aj_?str:_d_(str,_bl_)}}
      return str}
    function make_int_padding_precision(k,o,acc,fmt,pad,match,trans,iconv)
     {if(typeof pad === "number")
       {if(typeof match === "number")
         return 0 === match
                 ?function(x)
                   {var str=caml_call2(trans,iconv,x);
                    return make_printf(k,o,[4,acc,str],fmt)}
                 :function(p,x)
                   {var str=fix_int_precision(p,caml_call2(trans,iconv,x));
                    return make_printf(k,o,[4,acc,str],fmt)};
        var p=match[1];
        return function(x)
         {var str=fix_int_precision(p,caml_call2(trans,iconv,x));
          return make_printf(k,o,[4,acc,str],fmt)}}
      else
       {if(0 === pad[0])
         {var _Aa_=pad[2],_Ab_=pad[1];
          if(typeof match === "number")
           return 0 === match
                   ?function(x)
                     {var str=fix_padding(_Ab_,_Aa_,caml_call2(trans,iconv,x));
                      return make_printf(k,o,[4,acc,str],fmt)}
                   :function(p,x)
                     {var
                       str=
                        fix_padding
                         (_Ab_,_Aa_,fix_int_precision(p,caml_call2(trans,iconv,x)));
                      return make_printf(k,o,[4,acc,str],fmt)};
          var p$0=match[1];
          return function(x)
           {var
             str=
              fix_padding
               (_Ab_,_Aa_,fix_int_precision(p$0,caml_call2(trans,iconv,x)));
            return make_printf(k,o,[4,acc,str],fmt)}}
        var _Ac_=pad[1];
        if(typeof match === "number")
         return 0 === match
                 ?function(w,x)
                   {var str=fix_padding(_Ac_,w,caml_call2(trans,iconv,x));
                    return make_printf(k,o,[4,acc,str],fmt)}
                 :function(w,p,x)
                   {var
                     str=
                      fix_padding
                       (_Ac_,w,fix_int_precision(p,caml_call2(trans,iconv,x)));
                    return make_printf(k,o,[4,acc,str],fmt)};
        var p$1=match[1];
        return function(w,x)
         {var
           str=
            fix_padding
             (_Ac_,w,fix_int_precision(p$1,caml_call2(trans,iconv,x)));
          return make_printf(k,o,[4,acc,str],fmt)}}}
    function make_padding(k,o,acc,fmt,pad,trans)
     {if(typeof pad === "number")
       return function(x)
        {var new_acc=[4,acc,caml_call1(trans,x)];
         return make_printf(k,o,new_acc,fmt)};
      else
       {if(0 === pad[0])
         {var width=pad[2],padty=pad[1];
          return function(x)
           {var new_acc=[4,acc,fix_padding(padty,width,caml_call1(trans,x))];
            return make_printf(k,o,new_acc,fmt)}}
        var padty$0=pad[1];
        return function(w,x)
         {var new_acc=[4,acc,fix_padding(padty$0,w,caml_call1(trans,x))];
          return make_printf(k,o,new_acc,fmt)}}}
    function make_printf$0(counter,k,o,acc,fmt)
     {var k$0=k,acc$0=acc,fmt$0=fmt;
      for(;;)
       if(typeof fmt$0 === "number")
        return caml_call2(k$0,o,acc$0);
       else
        switch(fmt$0[0])
         {case 0:
           var rest=fmt$0[1];
           return function(c)
            {var new_acc=[5,acc$0,c];return make_printf(k$0,o,new_acc,rest)};
          case 1:
           var rest$0=fmt$0[1];
           return function(c)
            {if(40 <= c)
              if(92 === c)
               var str=_m_,switch$0=2;
              else
               var switch$0=127 <= c?0:1;
             else
              if(32 <= c)
               if(39 <= c)var str=_n_,switch$0=2;else var switch$0=1;
              else
               if(14 <= c)
                var switch$0=0;
               else
                switch(c)
                 {case 8:var str=_o_,switch$0=2;break;
                  case 9:var str=_p_,switch$0=2;break;
                  case 10:var str=_q_,switch$0=2;break;
                  case 13:var str=_r_,switch$0=2;break;
                  default:var switch$0=0}
             switch(switch$0)
              {case 0:
                var s=caml_create_bytes(4);
                caml_string_unsafe_set(s,0,92);
                caml_string_unsafe_set(s,1,48 + (c / 100 | 0) | 0);
                caml_string_unsafe_set(s,2,48 + ((c / 10 | 0) % 10 | 0) | 0);
                caml_string_unsafe_set(s,3,48 + (c % 10 | 0) | 0);
                var str=s;
                break;
               case 1:
                var s$0=caml_create_bytes(1);
                caml_string_unsafe_set(s$0,0,c);
                var str=s$0;
                break
               }
             var l=caml_ml_string_length(str),res=make(l + 2 | 0,39);
             caml_blit_string(str,0,res,1,l);
             var new_acc=[4,acc$0,res];
             return make_printf(k$0,o,new_acc,rest$0)};
          case 2:
           var rest$1=fmt$0[2],pad=fmt$0[1];
           return make_padding
                   (k$0,o,acc$0,rest$1,pad,function(str){return str});
          case 3:
           var rest$2=fmt$0[2],pad$0=fmt$0[1];
           return make_padding(k$0,o,acc$0,rest$2,pad$0,string_to_caml_string);
          case 4:
           var rest$3=fmt$0[4],prec=fmt$0[3],pad$1=fmt$0[2],iconv=fmt$0[1];
           return make_int_padding_precision
                   (k$0,o,acc$0,rest$3,pad$1,prec,convert_int,iconv);
          case 5:
           var
            rest$4=fmt$0[4],
            prec$0=fmt$0[3],
            pad$2=fmt$0[2],
            iconv$0=fmt$0[1];
           return make_int_padding_precision
                   (k$0,o,acc$0,rest$4,pad$2,prec$0,convert_int32,iconv$0);
          case 6:
           var
            rest$5=fmt$0[4],
            prec$1=fmt$0[3],
            pad$3=fmt$0[2],
            iconv$1=fmt$0[1];
           return make_int_padding_precision
                   (k$0,o,acc$0,rest$5,pad$3,prec$1,convert_nativeint,iconv$1);
          case 7:
           var
            rest$6=fmt$0[4],
            prec$2=fmt$0[3],
            pad$4=fmt$0[2],
            iconv$2=fmt$0[1];
           return make_int_padding_precision
                   (k$0,o,acc$0,rest$6,pad$4,prec$2,convert_int64,iconv$2);
          case 8:
           var rest$7=fmt$0[4],prec$3=fmt$0[3],pad$5=fmt$0[2],fconv=fmt$0[1];
           if(typeof pad$5 === "number")
            {if(typeof prec$3 === "number")
              return 0 === prec$3
                      ?function(x)
                        {var str=convert_float(fconv,default_float_precision,x);
                         return make_printf(k$0,o,[4,acc$0,str],rest$7)}
                      :function(p,x)
                        {var str=convert_float(fconv,p,x);
                         return make_printf(k$0,o,[4,acc$0,str],rest$7)};
             var p=prec$3[1];
             return function(x)
              {var str=convert_float(fconv,p,x);
               return make_printf(k$0,o,[4,acc$0,str],rest$7)}}
           else
            {if(0 === pad$5[0])
              {var _z9_=pad$5[2],_z__=pad$5[1];
               if(typeof prec$3 === "number")
                return 0 === prec$3
                        ?function(x)
                          {var
                            str=convert_float(fconv,default_float_precision,x),
                            str$0=fix_padding(_z__,_z9_,str);
                           return make_printf(k$0,o,[4,acc$0,str$0],rest$7)}
                        :function(p,x)
                          {var str=fix_padding(_z__,_z9_,convert_float(fconv,p,x));
                           return make_printf(k$0,o,[4,acc$0,str],rest$7)};
               var p$0=prec$3[1];
               return function(x)
                {var str=fix_padding(_z__,_z9_,convert_float(fconv,p$0,x));
                 return make_printf(k$0,o,[4,acc$0,str],rest$7)}}
             var _z$_=pad$5[1];
             if(typeof prec$3 === "number")
              return 0 === prec$3
                      ?function(w,x)
                        {var
                          str=convert_float(fconv,default_float_precision,x),
                          str$0=fix_padding(_z$_,w,str);
                         return make_printf(k$0,o,[4,acc$0,str$0],rest$7)}
                      :function(w,p,x)
                        {var str=fix_padding(_z$_,w,convert_float(fconv,p,x));
                         return make_printf(k$0,o,[4,acc$0,str],rest$7)};
             var p$1=prec$3[1];
             return function(w,x)
              {var str=fix_padding(_z$_,w,convert_float(fconv,p$1,x));
               return make_printf(k$0,o,[4,acc$0,str],rest$7)}}
          case 9:
           var rest$8=fmt$0[2],pad$6=fmt$0[1];
           return make_padding(k$0,o,acc$0,rest$8,pad$6,string_of_bool);
          case 10:
           var fmt$1=fmt$0[1],acc$1=[7,acc$0],acc$0=acc$1,fmt$0=fmt$1;
           continue;
          case 11:
           var
            fmt$2=fmt$0[2],
            str=fmt$0[1],
            acc$2=[2,acc$0,str],
            acc$0=acc$2,
            fmt$0=fmt$2;
           continue;
          case 12:
           var
            fmt$3=fmt$0[2],
            chr=fmt$0[1],
            acc$3=[3,acc$0,chr],
            acc$0=acc$3,
            fmt$0=fmt$3;
           continue;
          case 13:
           var rest$9=fmt$0[3],sub_fmtty=fmt$0[2],buf=buffer_create(16);
           bprint_fmtty(buf,sub_fmtty);
           var ty=buffer_contents(buf);
           return function(str)
            {return make_printf(k$0,o,[4,acc$0,ty],rest$9)};
          case 14:
           var rest$10=fmt$0[3],fmtty=fmt$0[2];
           return function(param)
            {var fmt=param[1];
             return make_printf
                     (k$0,o,acc$0,concat_fmt(recast(fmt,fmtty),rest$10))};
          case 15:
           var rest$11=fmt$0[1];
           return function(f,x)
            {return make_printf
                     (k$0,
                      o,
                      [6,acc$0,function(o){return caml_call2(f,o,x)}],
                      rest$11)};
          case 16:
           var rest$12=fmt$0[1];
           return function(f){return make_printf(k$0,o,[6,acc$0,f],rest$12)};
          case 17:
           var
            fmt$4=fmt$0[2],
            fmting_lit=fmt$0[1],
            acc$4=[0,acc$0,fmting_lit],
            acc$0=acc$4,
            fmt$0=fmt$4;
           continue;
          case 18:
           var _z7_=fmt$0[1];
           if(0 === _z7_[0])
            {var
              rest$13=fmt$0[2],
              match=_z7_[1],
              fmt$5=match[1],
              k$3=
               function(acc,k,rest)
                {function k$0(koc,kacc)
                  {return make_printf(k,koc,[1,acc,[0,kacc]],rest)}
                 return k$0},
              k$1=k$3(acc$0,k$0,rest$13),
              k$0=k$1,
              acc$0=0,
              fmt$0=fmt$5;
             continue}
           var
            rest$14=fmt$0[2],
            match$0=_z7_[1],
            fmt$6=match$0[1],
            k$4=
             function(acc,k,rest)
              {function k$0(koc,kacc)
                {return make_printf(k,koc,[1,acc,[1,kacc]],rest)}
               return k$0},
            k$2=k$4(acc$0,k$0,rest$14),
            k$0=k$2,
            acc$0=0,
            fmt$0=fmt$6;
           continue;
          case 19:throw [0,Assert_failure,_bm_];
          case 20:
           var rest$15=fmt$0[3],new_acc=[8,acc$0,_bn_];
           return function(param){return make_printf(k$0,o,new_acc,rest$15)};
          case 21:
           var rest$16=fmt$0[2];
           return function(n)
            {var new_acc=[4,acc$0,caml_format_int(_bo_,n)];
             return make_printf(k$0,o,new_acc,rest$16)};
          case 22:
           var rest$17=fmt$0[1];
           return function(c)
            {var new_acc=[5,acc$0,c];
             return make_printf(k$0,o,new_acc,rest$17)};
          case 23:
           var rest$18=fmt$0[2],ign=fmt$0[1];
           if(counter < 50)
            {var counter$1=counter + 1 | 0;
             return make_ignored_param$0(counter$1,k$0,o,acc$0,ign,rest$18)}
           return caml_trampoline_return
                   (make_ignored_param$0,[0,k$0,o,acc$0,ign,rest$18]);
          default:
           var
            rest$19=fmt$0[3],
            f=fmt$0[2],
            arity=fmt$0[1],
            _z8_=caml_call1(f,0);
           if(counter < 50)
            {var counter$0=counter + 1 | 0;
             return make_custom$0(counter$0,k$0,o,acc$0,rest$19,arity,_z8_)}
           return caml_trampoline_return
                   (make_custom$0,[0,k$0,o,acc$0,rest$19,arity,_z8_])}}
    function make_ignored_param$0(counter,k,o,acc,ign,fmt)
     {if(typeof ign === "number")
       switch(ign)
        {case 0:
          if(counter < 50)
           {var counter$0=counter + 1 | 0;
            return make_invalid_arg(counter$0,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 1:
          if(counter < 50)
           {var counter$1=counter + 1 | 0;
            return make_invalid_arg(counter$1,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 2:throw [0,Assert_failure,_bp_];
         default:
          if(counter < 50)
           {var counter$2=counter + 1 | 0;
            return make_invalid_arg(counter$2,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt])}
      else
       switch(ign[0])
        {case 0:
          if(counter < 50)
           {var counter$3=counter + 1 | 0;
            return make_invalid_arg(counter$3,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 1:
          if(counter < 50)
           {var counter$4=counter + 1 | 0;
            return make_invalid_arg(counter$4,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 2:
          if(counter < 50)
           {var counter$5=counter + 1 | 0;
            return make_invalid_arg(counter$5,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 3:
          if(counter < 50)
           {var counter$6=counter + 1 | 0;
            return make_invalid_arg(counter$6,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 4:
          if(counter < 50)
           {var counter$7=counter + 1 | 0;
            return make_invalid_arg(counter$7,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 5:
          if(counter < 50)
           {var counter$8=counter + 1 | 0;
            return make_invalid_arg(counter$8,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 6:
          if(counter < 50)
           {var counter$9=counter + 1 | 0;
            return make_invalid_arg(counter$9,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 7:
          if(counter < 50)
           {var counter$10=counter + 1 | 0;
            return make_invalid_arg(counter$10,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 8:
          if(counter < 50)
           {var counter$11=counter + 1 | 0;
            return make_invalid_arg(counter$11,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         case 9:
          var fmtty=ign[2];
          if(counter < 50)
           {var counter$14=counter + 1 | 0;
            return make_from_fmtty$0(counter$14,k,o,acc,fmtty,fmt)}
          return caml_trampoline_return
                  (make_from_fmtty$0,[0,k,o,acc,fmtty,fmt]);
         case 10:
          if(counter < 50)
           {var counter$12=counter + 1 | 0;
            return make_invalid_arg(counter$12,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt]);
         default:
          if(counter < 50)
           {var counter$13=counter + 1 | 0;
            return make_invalid_arg(counter$13,k,o,acc,fmt)}
          return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt])}}
    function make_from_fmtty$0(counter,k,o,acc,fmtty,fmt)
     {if(typeof fmtty === "number")
       {if(counter < 50)
         {var counter$0=counter + 1 | 0;
          return make_invalid_arg(counter$0,k,o,acc,fmt)}
        return caml_trampoline_return(make_invalid_arg,[0,k,o,acc,fmt])}
      else
       switch(fmtty[0])
        {case 0:
          var rest=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest,fmt)};
         case 1:
          var rest$0=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$0,fmt)};
         case 2:
          var rest$1=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$1,fmt)};
         case 3:
          var rest$2=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$2,fmt)};
         case 4:
          var rest$3=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$3,fmt)};
         case 5:
          var rest$4=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$4,fmt)};
         case 6:
          var rest$5=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$5,fmt)};
         case 7:
          var rest$6=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$6,fmt)};
         case 8:
          var rest$7=fmtty[2];
          return function(param){return make_from_fmtty(k,o,acc,rest$7,fmt)};
         case 9:
          var
           rest$8=fmtty[3],
           ty2=fmtty[2],
           ty1=fmtty[1],
           ty=trans(symm(ty1),ty2);
          return function(param)
           {return make_from_fmtty(k,o,acc,concat_fmtty(ty,rest$8),fmt)};
         case 10:
          var rest$9=fmtty[1];
          return function(param,_z6_)
           {return make_from_fmtty(k,o,acc,rest$9,fmt)};
         case 11:
          var rest$10=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$10,fmt)};
         case 12:
          var rest$11=fmtty[1];
          return function(param){return make_from_fmtty(k,o,acc,rest$11,fmt)};
         case 13:throw [0,Assert_failure,_bq_];
         default:throw [0,Assert_failure,_br_]}}
    function make_invalid_arg(counter,k,o,acc,fmt)
     {var _z5_=[8,acc,_bs_];
      if(counter < 50)
       {var counter$0=counter + 1 | 0;
        return make_printf$0(counter$0,k,o,_z5_,fmt)}
      return caml_trampoline_return(make_printf$0,[0,k,o,_z5_,fmt])}
    function make_custom$0(counter,k,o,acc,rest,arity,f)
     {if(arity)
       {var arity$0=arity[1];
        return function(x)
         {return make_custom(k,o,acc,rest,arity$0,caml_call1(f,x))}}
      var _z4_=[4,acc,f];
      if(counter < 50)
       {var counter$0=counter + 1 | 0;
        return make_printf$0(counter$0,k,o,_z4_,rest)}
      return caml_trampoline_return(make_printf$0,[0,k,o,_z4_,rest])}
    function make_printf(k,o,acc,fmt)
     {return caml_trampoline(make_printf$0(0,k,o,acc,fmt))}
    function make_ignored_param(k,o,acc,ign,fmt)
     {return caml_trampoline(make_ignored_param$0(0,k,o,acc,ign,fmt))}
    function make_from_fmtty(k,o,acc,fmtty,fmt)
     {return caml_trampoline(make_from_fmtty$0(0,k,o,acc,fmtty,fmt))}
    function make_custom(k,o,acc,rest,arity,f)
     {return caml_trampoline(make_custom$0(0,k,o,acc,rest,arity,f))}
    function fn_of_padding_precision(k,o,fmt,pad,prec)
     {if(typeof pad === "number")
       {if(typeof prec === "number")
         {if(0 === prec)
           {var _zA_=make_iprintf(k,o,fmt);return function(_zS_){return _zA_}}
          var _zB_=make_iprintf(k,o,fmt),_zC_=function(_zR_){return _zB_};
          return function(_zQ_){return _zC_}}
        var _zD_=make_iprintf(k,o,fmt);
        return function(_zP_){return _zD_}}
      else
       {if(0 === pad[0])
         {if(typeof prec === "number")
           {if(0 === prec)
             {var _zE_=make_iprintf(k,o,fmt);
              return function(_z3_){return _zE_}}
            var _zF_=make_iprintf(k,o,fmt),_zG_=function(_z2_){return _zF_};
            return function(_z1_){return _zG_}}
          var _zH_=make_iprintf(k,o,fmt);
          return function(_z0_){return _zH_}}
        if(typeof prec === "number")
         {if(0 === prec)
           {var _zI_=make_iprintf(k,o,fmt),_zJ_=function(_zZ_){return _zI_};
            return function(_zY_){return _zJ_}}
          var
           _zK_=make_iprintf(k,o,fmt),
           _zL_=function(_zX_){return _zK_},
           _zM_=function(_zW_){return _zL_};
          return function(_zV_){return _zM_}}
        var _zN_=make_iprintf(k,o,fmt),_zO_=function(_zU_){return _zN_};
        return function(_zT_){return _zO_}}}
    function make_iprintf$0(counter,k,o,fmt)
     {var k$0=k,fmt$0=fmt;
      for(;;)
       if(typeof fmt$0 === "number")
        return caml_call1(k$0,o);
       else
        switch(fmt$0[0])
         {case 0:
           var rest=fmt$0[1],_yR_=make_iprintf(k$0,o,rest);
           return function(_zz_){return _yR_};
          case 1:
           var rest$0=fmt$0[1],_yS_=make_iprintf(k$0,o,rest$0);
           return function(_zy_){return _yS_};
          case 2:
           var _yT_=fmt$0[1];
           if(typeof _yT_ === "number")
            {var rest$1=fmt$0[2],_yU_=make_iprintf(k$0,o,rest$1);
             return function(_zu_){return _yU_}}
           else
            {if(0 === _yT_[0])
              {var rest$2=fmt$0[2],_yV_=make_iprintf(k$0,o,rest$2);
               return function(_zx_){return _yV_}}
             var
              rest$3=fmt$0[2],
              _yW_=make_iprintf(k$0,o,rest$3),
              _yX_=function(_zw_){return _yW_};
             return function(_zv_){return _yX_}}
          case 3:
           var _yY_=fmt$0[1];
           if(typeof _yY_ === "number")
            {var rest$4=fmt$0[2],_yZ_=make_iprintf(k$0,o,rest$4);
             return function(_zq_){return _yZ_}}
           else
            {if(0 === _yY_[0])
              {var rest$5=fmt$0[2],_y0_=make_iprintf(k$0,o,rest$5);
               return function(_zt_){return _y0_}}
             var
              rest$6=fmt$0[2],
              _y1_=make_iprintf(k$0,o,rest$6),
              _y2_=function(_zs_){return _y1_};
             return function(_zr_){return _y2_}}
          case 4:
           var rest$7=fmt$0[4],prec=fmt$0[3],pad=fmt$0[2];
           return fn_of_padding_precision(k$0,o,rest$7,pad,prec);
          case 5:
           var rest$8=fmt$0[4],prec$0=fmt$0[3],pad$0=fmt$0[2];
           return fn_of_padding_precision(k$0,o,rest$8,pad$0,prec$0);
          case 6:
           var rest$9=fmt$0[4],prec$1=fmt$0[3],pad$1=fmt$0[2];
           return fn_of_padding_precision(k$0,o,rest$9,pad$1,prec$1);
          case 7:
           var rest$10=fmt$0[4],prec$2=fmt$0[3],pad$2=fmt$0[2];
           return fn_of_padding_precision(k$0,o,rest$10,pad$2,prec$2);
          case 8:
           var rest$11=fmt$0[4],prec$3=fmt$0[3],pad$3=fmt$0[2];
           return fn_of_padding_precision(k$0,o,rest$11,pad$3,prec$3);
          case 9:
           var _y3_=fmt$0[1];
           if(typeof _y3_ === "number")
            {var rest$12=fmt$0[2],_y4_=make_iprintf(k$0,o,rest$12);
             return function(_zm_){return _y4_}}
           else
            {if(0 === _y3_[0])
              {var rest$13=fmt$0[2],_y5_=make_iprintf(k$0,o,rest$13);
               return function(_zp_){return _y5_}}
             var
              rest$14=fmt$0[2],
              _y6_=make_iprintf(k$0,o,rest$14),
              _y7_=function(_zo_){return _y6_};
             return function(_zn_){return _y7_}}
          case 10:var fmt$1=fmt$0[1],fmt$0=fmt$1;continue;
          case 11:var fmt$2=fmt$0[2],fmt$0=fmt$2;continue;
          case 12:var fmt$3=fmt$0[2],fmt$0=fmt$3;continue;
          case 13:
           var rest$15=fmt$0[3],_y8_=make_iprintf(k$0,o,rest$15);
           return function(_zl_){return _y8_};
          case 14:
           var rest$16=fmt$0[3],fmtty=fmt$0[2];
           return function(param)
            {var fmt=param[1];
             return make_iprintf(k$0,o,concat_fmt(recast(fmt,fmtty),rest$16))};
          case 15:
           var
            rest$17=fmt$0[1],
            _y9_=make_iprintf(k$0,o,rest$17),
            _y__=function(_zk_){return _y9_};
           return function(_zj_){return _y__};
          case 16:
           var rest$18=fmt$0[1],_y$_=make_iprintf(k$0,o,rest$18);
           return function(_zi_){return _y$_};
          case 17:var fmt$4=fmt$0[2],fmt$0=fmt$4;continue;
          case 18:
           var _za_=fmt$0[1];
           if(0 === _za_[0])
            {var
              rest$19=fmt$0[2],
              match=_za_[1],
              fmt$5=match[1],
              k$3=
               function(k,rest)
                {function k$0(koc){return make_iprintf(k,koc,rest)}return k$0},
              k$1=k$3(k$0,rest$19),
              k$0=k$1,
              fmt$0=fmt$5;
             continue}
           var
            rest$20=fmt$0[2],
            match$0=_za_[1],
            fmt$6=match$0[1],
            k$4=
             function(k,rest)
              {function k$0(koc){return make_iprintf(k,koc,rest)}return k$0},
            k$2=k$4(k$0,rest$20),
            k$0=k$2,
            fmt$0=fmt$6;
           continue;
          case 19:throw [0,Assert_failure,_bt_];
          case 20:
           var rest$21=fmt$0[3],_zb_=make_iprintf(k$0,o,rest$21);
           return function(_zh_){return _zb_};
          case 21:
           var rest$22=fmt$0[2],_zc_=make_iprintf(k$0,o,rest$22);
           return function(_zg_){return _zc_};
          case 22:
           var rest$23=fmt$0[1],_zd_=make_iprintf(k$0,o,rest$23);
           return function(_zf_){return _zd_};
          case 23:
           var rest$24=fmt$0[2],ign=fmt$0[1],_ze_=0;
           return make_ignored_param
                   (function(x,param){return caml_call1(k$0,x)},
                    o,
                    _ze_,
                    ign,
                    rest$24);
          default:
           var rest$25=fmt$0[3],arity=fmt$0[1];
           if(counter < 50)
            {var counter$0=counter + 1 | 0;
             return fn_of_custom_arity$0(counter$0,k$0,o,rest$25,arity)}
           return caml_trampoline_return
                   (fn_of_custom_arity$0,[0,k$0,o,rest$25,arity])}}
    function fn_of_custom_arity$0(counter,k,o,fmt,param)
     {if(param)
       {var arity=param[1],_yP_=fn_of_custom_arity(k,o,fmt,arity);
        return function(_yQ_){return _yP_}}
      if(counter < 50)
       {var counter$0=counter + 1 | 0;
        return make_iprintf$0(counter$0,k,o,fmt)}
      return caml_trampoline_return(make_iprintf$0,[0,k,o,fmt])}
    function make_iprintf(k,o,fmt)
     {return caml_trampoline(make_iprintf$0(0,k,o,fmt))}
    function fn_of_custom_arity(k,o,fmt,param)
     {return caml_trampoline(fn_of_custom_arity$0(0,k,o,fmt,param))}
    function output_acc(o,acc)
     {var acc$0=acc;
      for(;;)
       if(typeof acc$0 === "number")
        return 0;
       else
        switch(acc$0[0])
         {case 0:
           var
            fmting_lit=acc$0[2],
            p=acc$0[1],
            s=string_of_formatting_lit(fmting_lit);
           output_acc(o,p);
           return output_string(o,s);
          case 1:
           var _yN_=acc$0[2],_yO_=acc$0[1];
           if(0 === _yN_[0])
            {var acc$1=_yN_[1];
             output_acc(o,_yO_);
             output_string(o,_bu_);
             var acc$0=acc$1;
             continue}
           var acc$2=_yN_[1];
           output_acc(o,_yO_);
           output_string(o,_bv_);
           var acc$0=acc$2;
           continue;
          case 6:
           var f=acc$0[2],p$2=acc$0[1];
           output_acc(o,p$2);
           return caml_call1(f,o);
          case 7:var p$3=acc$0[1];output_acc(o,p$3);return caml_ml_flush(o);
          case 8:
           var msg=acc$0[2],p$4=acc$0[1];
           output_acc(o,p$4);
           return invalid_arg(msg);
          case 2:
          case 4:
           var s$0=acc$0[2],p$0=acc$0[1];
           output_acc(o,p$0);
           return output_string(o,s$0);
          default:
           var c=acc$0[2],p$1=acc$0[1];
           output_acc(o,p$1);
           return caml_ml_output_char(o,c)}}
    function strput_acc(b,acc)
     {var acc$0=acc;
      for(;;)
       if(typeof acc$0 === "number")
        return 0;
       else
        switch(acc$0[0])
         {case 0:
           var
            fmting_lit=acc$0[2],
            p=acc$0[1],
            s=string_of_formatting_lit(fmting_lit);
           strput_acc(b,p);
           return add_string(b,s);
          case 1:
           var _yL_=acc$0[2],_yM_=acc$0[1];
           if(0 === _yL_[0])
            {var acc$1=_yL_[1];
             strput_acc(b,_yM_);
             add_string(b,_bw_);
             var acc$0=acc$1;
             continue}
           var acc$2=_yL_[1];
           strput_acc(b,_yM_);
           add_string(b,_bx_);
           var acc$0=acc$2;
           continue;
          case 6:
           var f=acc$0[2],p$2=acc$0[1];
           strput_acc(b,p$2);
           return add_string(b,caml_call1(f,0));
          case 7:var acc$3=acc$0[1],acc$0=acc$3;continue;
          case 8:
           var msg=acc$0[2],p$3=acc$0[1];
           strput_acc(b,p$3);
           return invalid_arg(msg);
          case 2:
          case 4:
           var s$0=acc$0[2],p$0=acc$0[1];
           strput_acc(b,p$0);
           return add_string(b,s$0);
          default:
           var c=acc$0[2],p$1=acc$0[1];
           strput_acc(b,p$1);
           var pos=b[2];
           if(b[3] <= pos)resize(b,1);
           caml_string_unsafe_set(b[1],pos,c);
           b[2] = pos + 1 | 0;
           return 0}}
    function open_box_of_string(str)
     {if(caml_string_equal(str,_by_))return _bz_;
      var len=caml_ml_string_length(str);
      function invalid_box(param$0)
       {var fmt=param[1],buf=create(256);
        function k(param,acc)
         {strput_acc(buf,acc);return failwith(contents(buf))}
        return caml_call1(make_printf(k,0,0,fmt),str)}
      function parse_spaces(i)
       {var i$0=i;
        for(;;)
         {if(i$0 === len)return i$0;
          var match=caml_string_get(str,i$0);
          if(9 !== match)if(32 !== match)return i$0;
          var i$1=i$0 + 1 | 0,i$0=i$1;
          continue}}
      function parse_lword(i,j)
       {var j$0=j;
        for(;;)
         {if(j$0 === len)return j$0;
          var match=caml_string_get(str,j$0),switcher=match - 97 | 0;
          if(25 < switcher >>> 0)return j$0;
          var j$1=j$0 + 1 | 0,j$0=j$1;
          continue}}
      function parse_int(i,j)
       {var j$0=j;
        for(;;)
         {if(j$0 === len)return j$0;
          var
           match=caml_string_get(str,j$0),
           switch$0=48 <= match?58 <= match?0:1:45 === match?1:0;
          if(switch$0){var j$1=j$0 + 1 | 0,j$0=j$1;continue}
          return j$0}}
      var
       wstart=parse_spaces(0),
       wend=parse_lword(wstart,wstart),
       box_name=sub$0(str,wstart,wend - wstart | 0),
       nstart=parse_spaces(wend),
       nend=parse_int(nstart,nstart);
      if(nstart === nend)
       var indent=0;
      else
       try
        {var
          _yJ_=caml_int_of_string(sub$0(str,nstart,nend - nstart | 0)),
          indent=_yJ_}
       catch(_yK_)
        {_yK_ = caml_wrap_exception(_yK_);
         if(_yK_[1] !== Failure)throw _yK_;
         var indent=invalid_box(0)}
      var exp_end=parse_spaces(nend);
      if(exp_end !== len)invalid_box(0);
      if(caml_string_notequal(box_name,_bA_))
       if(caml_string_notequal(box_name,_bB_))
        if(caml_string_notequal(box_name,_bC_))
         if(caml_string_notequal(box_name,_bD_))
          if(caml_string_notequal(box_name,_bE_))
           if(caml_string_notequal(box_name,_bF_))
            var box_type=invalid_box(0),switch$0=1;
           else
            var box_type=1,switch$0=1;
          else
           var box_type=2,switch$0=1;
         else
          var box_type=3,switch$0=1;
        else
         var box_type=0,switch$0=1;
       else
        var switch$0=0;
      else
       var switch$0=0;
      if(!switch$0)var box_type=4;
      return [0,indent,box_type]}
    function fprintf(oc,fmt$0)
     {var fmt=fmt$0[1],_yI_=0;
      return make_printf
              (function(o,acc){output_acc(o,acc);return 0},oc,_yI_,fmt)}
    function printf(fmt){return fprintf(stdout,fmt)}
    function sprintf(fmt$0)
     {var fmt=fmt$0[1];
      function k(param,acc)
       {var buf=create(64);strput_acc(buf,acc);return contents(buf)}
      return make_printf(k,0,0,fmt)}
    var printers=[0,0];
    function register_printer(fn){printers[1] = [0,fn,printers[1]];return 0}
    function make_self_init(param)
     {var
       seed$0=caml_sys_random_seed(0),
       result=[0,caml_make_vect(55,0),0],
       seed=0 === seed$0.length - 1?[0,0]:seed$0,
       l=seed.length - 1,
       i$0=0;
      for(;;)
       {caml_check_bound(result[1],i$0)[i$0 + 1] = i$0;
        var _yH_=i$0 + 1 | 0;
        if(54 !== i$0){var i$0=_yH_;continue}
        var accu=[0,_bG_],_yD_=54 + max(55,l) | 0,_yC_=0;
        if(!(_yD_ < 0))
         {var i=_yC_;
          for(;;)
           {var
             j=i % 55 | 0,
             k=caml_mod(i,l),
             x=caml_check_bound(seed,k)[k + 1],
             str=_d_(accu[1],caml_new_string("" + x));
            accu[1] = caml_md5_string(str,0,caml_ml_string_length(str));
            var
             _yE_=accu[1],
             _yy_=caml_string_get(_yE_,3) << 24,
             _yz_=caml_string_get(_yE_,2) << 16,
             _yA_=caml_string_get(_yE_,1) << 8,
             _yB_=((caml_string_get(_yE_,0) + _yA_ | 0) + _yz_ | 0) + _yy_ | 0,
             _yF_=(caml_check_bound(result[1],j)[j + 1] ^ _yB_) & 1073741823;
            caml_check_bound(result[1],j)[j + 1] = _yF_;
            var _yG_=i + 1 | 0;
            if(_yD_ !== i){var i=_yG_;continue}
            break}}
        result[2] = 0;
        return result}}
    function bits(s)
     {s[2] = (s[2] + 1 | 0) % 55 | 0;
      var
       _yv_=s[2],
       curval=caml_check_bound(s[1],_yv_)[_yv_ + 1],
       _yw_=(s[2] + 24 | 0) % 55 | 0,
       newval=
        caml_check_bound(s[1],_yw_)[_yw_ + 1]
        +
        (curval ^ (curval >>> 25 | 0) & 31)
        |
        0,
       newval30=newval & 1073741823,
       _yx_=s[2];
      caml_check_bound(s[1],_yx_)[_yx_ + 1] = newval30;
      return newval30}
    function float$0(s,bound)
     {var r1=bits(s),r2=bits(s);
      return (r1 / 1073741824 + r2) / 1073741824 * bound}
    function ongoing_traversal(h)
     {var _yt_=h.length - 1 < 4?1:0,_yu_=_yt_ || (h[4] < 0?1:0);return _yu_}
    function flip_ongoing_traversal(h){h[4] = -h[4] | 0;return 0}
    try
     {var _jk_=caml_sys_getenv(_jj_),params=_jk_}
    catch(_yr_)
     {_yr_ = caml_wrap_exception(_yr_);
      if(_yr_ !== Not_found)throw _yr_;
      try
       {var _ji_=caml_sys_getenv(_jh_),_bJ_=_ji_}
      catch(_ys_)
       {_ys_ = caml_wrap_exception(_ys_);
        if(_ys_ !== Not_found)throw _ys_;
        var _bJ_=_bI_}
      var params=_bJ_}
    var
     randomized_default=contains(params,82),
     prng=[246,function(_yq_){return make_self_init(0)}];
    function create$0(opt,initial_size)
     {if(opt)var sth=opt[1],random=sth;else var random=randomized_default;
      var x=16;
      for(;;)
       {if(!(initial_size <= x))
         if(!(max_array_length < (x * 2 | 0)))
          {var x$0=x * 2 | 0,x=x$0;continue}
        if(random)
         var
          _yo_=caml_obj_tag(prng),
          _yp_=250 === _yo_?prng[1]:246 === _yo_?force_lazy_block(prng):prng,
          seed=bits(_yp_);
        else
         var seed=0;
        return [0,0,caml_make_vect(x,0),seed,x]}}
    function indexfun(h,key)
     {return 3 <= h.length - 1
              ?caml_hash(10,100,h[3],key) & (h[2].length - 1 - 1 | 0)
              :caml_mod(caml_hash_univ_param(10,100,key),h[2].length - 1)}
    function find(h,key)
     {var _yn_=indexfun(h,key),match=caml_check_bound(h[2],_yn_)[_yn_ + 1];
      if(match)
       {var k1=match[1],d1=match[2],next1=match[3];
        if(0 === caml_compare(key,k1))return d1;
        if(next1)
         {var k2=next1[1],d2=next1[2],next2=next1[3];
          if(0 === caml_compare(key,k2))return d2;
          if(next2)
           {var k3=next2[1],d3=next2[2],next3=next2[3];
            if(0 === caml_compare(key,k3))return d3;
            var param=next3;
            for(;;)
             {if(param)
               {var k=param[1],data=param[2],next=param[3];
                if(0 === caml_compare(key,k))return data;
                var param=next;
                continue}
              throw Not_found}}
          throw Not_found}
        throw Not_found}
      throw Not_found}
    function fold(f,h,init)
     {function do_bucket(b,accu)
       {var b$0=b,accu$0=accu;
        for(;;)
         {if(b$0)
           {var
             key=b$0[1],
             data=b$0[2],
             next=b$0[3],
             accu$1=caml_call3(f,key,data,accu$0),
             b$0=next,
             accu$0=accu$1;
            continue}
          return accu$0}}
      var old_trav=ongoing_traversal(h);
      if(1 - old_trav)flip_ongoing_traversal(h);
      try
       {var d=h[2],accu=[0,init],_yj_=d.length - 1 - 1 | 0,_yi_=0;
        if(!(_yj_ < 0))
         {var i=_yi_;
          for(;;)
           {var _yl_=accu[1];
            accu[1] = do_bucket(caml_check_bound(d,i)[i + 1],_yl_);
            var _ym_=i + 1 | 0;
            if(_yj_ !== i){var i=_ym_;continue}
            break}}
        if(1 - old_trav)flip_ongoing_traversal(h);
        var _yk_=accu[1];
        return _yk_}
      catch(exn)
       {exn = caml_wrap_exception(exn);
        if(old_trav)throw exn;
        flip_ongoing_traversal(h);
        throw exn}}
    function add_queue(x,q)
     {var c=[0,x,0],_yh_=q[1];
      return _yh_?(q[1] = c,_yh_[2] = c,0):(q[1] = c,q[2] = c,0)}
    var Empty_queue=[248,_bK_,caml_fresh_oo_id(0)];
    function take_queue(q)
     {var _yg_=q[2];
      if(_yg_)
       {var x=_yg_[1],tl=_yg_[2];q[2] = tl;if(0 === tl)q[1] = 0;return x}
      throw Empty_queue}
    function pp_enqueue(state,token)
     {var len=token[3];
      state[13] = state[13] + len | 0;
      return add_queue(token,state[28])}
    var pp_infinity=1000000010;
    function pp_output_string(state,s)
     {return caml_call3(state[17],s,0,caml_ml_string_length(s))}
    function pp_output_newline(state){return caml_call1(state[19],0)}
    function break_new_line(state,offset,width)
     {pp_output_newline(state);
      state[11] = 1;
      var
       indent=(state[6] - width | 0) + offset | 0,
       real_indent=min(state[8],indent);
      state[10] = real_indent;
      state[9] = state[6] - state[10] | 0;
      return caml_call1(state[21],state[10])}
    function break_line(state,width){return break_new_line(state,0,width)}
    function break_same_line(state,width)
     {state[9] = state[9] - width | 0;return caml_call1(state[20],width)}
    function pp_force_break_line(state)
     {var _yd_=state[2];
      if(_yd_)
       {var
         match=_yd_[1],
         width=match[2],
         bl_ty=match[1],
         _ye_=state[9] < width?1:0;
        if(_ye_)
         {if(0 !== bl_ty)return 5 <= bl_ty?0:break_line(state,width);
          var _yf_=0}
        else
         var _yf_=_ye_;
        return _yf_}
      return pp_output_newline(state)}
    function pp_skip_token(state)
     {var match=take_queue(state[28]),size=match[1],len=match[3];
      state[12] = state[12] - len | 0;
      state[9] = state[9] + size | 0;
      return 0}
    function format_pp_token(state,size,param)
     {if(typeof param === "number")
       switch(param)
        {case 0:
          var _x4_=state[3];
          if(_x4_)
           {var
             match=_x4_[1],
             tabs=match[1],
             add_tab=
              function(n,ls)
               {if(ls)
                 {var l=ls[2],x=ls[1];
                  return caml_lessthan(n,x)?[0,n,ls]:[0,x,add_tab(n,l)]}
                return [0,n,0]};
            tabs[1] = add_tab(state[6] - state[9] | 0,tabs[1]);
            return 0}
          return 0;
         case 1:
          var _x5_=state[2];
          if(_x5_){var ls=_x5_[2];state[2] = ls;return 0}
          return 0;
         case 2:
          var _x6_=state[3];
          if(_x6_){var ls$0=_x6_[2];state[3] = ls$0;return 0}
          return 0;
         case 3:
          var _x7_=state[2];
          if(_x7_)
           {var match$0=_x7_[1],width=match$0[2];
            return break_line(state,width)}
          return pp_output_newline(state);
         case 4:
          var _x8_=state[10] !== (state[6] - state[9] | 0)?1:0;
          return _x8_?pp_skip_token(state):_x8_;
         default:
          var _x9_=state[5];
          if(_x9_)
           {var
             tags=_x9_[2],
             tag_name=_x9_[1],
             marker=caml_call1(state[25],tag_name);
            pp_output_string(state,marker);
            state[5] = tags;
            return 0}
          return 0}
      else
       switch(param[0])
        {case 0:
          var s=param[1];
          state[9] = state[9] - size | 0;
          pp_output_string(state,s);
          state[11] = 0;
          return 0;
         case 1:
          var off=param[2],n=param[1],_x__=state[2];
          if(_x__)
           {var match$1=_x__[1],width$0=match$1[2],ty=match$1[1];
            switch(ty)
             {case 0:return break_same_line(state,n);
              case 1:return break_new_line(state,off,width$0);
              case 2:return break_new_line(state,off,width$0);
              case 3:
               return state[9] < size
                       ?break_new_line(state,off,width$0)
                       :break_same_line(state,n);
              case 4:
               return state[11]
                       ?break_same_line(state,n)
                       :state[9] < size
                         ?break_new_line(state,off,width$0)
                         :((state[6] - width$0 | 0) + off | 0) < state[10]
                           ?break_new_line(state,off,width$0)
                           :break_same_line(state,n);
              default:return break_same_line(state,n)}}
          return 0;
         case 2:
          var
           off$0=param[2],
           n$0=param[1],
           insertion_point=state[6] - state[9] | 0,
           _x$_=state[3];
          if(_x$_)
           {var
             match$2=_x$_[1],
             tabs$0=match$2[1],
             find=
              function(n,param)
               {var param$0=param;
                for(;;)
                 {if(param$0)
                   {var l=param$0[2],x=param$0[1];
                    if(caml_greaterequal(x,n))return x;
                    var param$0=l;
                    continue}
                  throw Not_found}},
             _ya_=tabs$0[1];
            if(_ya_)
             {var x=_ya_[1];
              try
               {var _yb_=find(insertion_point,tabs$0[1]),x$0=_yb_}
              catch(_yc_)
               {_yc_ = caml_wrap_exception(_yc_);
                if(_yc_ !== Not_found)throw _yc_;
                var x$0=x}
              var tab=x$0}
            else
             var tab=insertion_point;
            var offset=tab - insertion_point | 0;
            return 0 <= offset
                    ?break_same_line(state,offset + n$0 | 0)
                    :break_new_line(state,tab + off$0 | 0,state[6])}
          return 0;
         case 3:
          var
           ty$0=param[2],
           off$1=param[1],
           insertion_point$0=state[6] - state[9] | 0;
          if(state[8] < insertion_point$0)pp_force_break_line(state);
          var
           offset$0=state[9] - off$1 | 0,
           bl_type=1 === ty$0?1:state[9] < size?ty$0:5;
          state[2] = [0,[0,bl_type,offset$0],state[2]];
          return 0;
         case 4:var tbox=param[1];state[3] = [0,tbox,state[3]];return 0;
         default:
          var tag_name$0=param[1],marker$0=caml_call1(state[24],tag_name$0);
          pp_output_string(state,marker$0);
          state[5] = [0,tag_name$0,state[5]];
          return 0}}
    function advance_loop(state)
     {for(;;)
       {var _x0_=state[28][2];
        if(_x0_)
         {var
           x=_x0_[1],
           size=x[1],
           len=x[3],
           tok=x[2],
           _x1_=size < 0?1:0,
           _x2_=_x1_?(state[13] - state[12] | 0) < state[9]?1:0:_x1_,
           _x3_=1 - _x2_;
          if(_x3_)
           {take_queue(state[28]);
            var size$0=0 <= size?size:pp_infinity;
            format_pp_token(state,size$0,tok);
            state[12] = len + state[12] | 0;
            continue}
          return _x3_}
        throw Empty_queue}}
    function advance_left(state)
     {try
       {var _xY_=advance_loop(state);return _xY_}
      catch(_xZ_)
       {_xZ_ = caml_wrap_exception(_xZ_);
        if(_xZ_ === Empty_queue)return 0;
        throw _xZ_}}
    function enqueue_advance(state,tok)
     {pp_enqueue(state,tok);return advance_left(state)}
    function enqueue_string_as(state,size,s)
     {return enqueue_advance(state,[0,size,[0,s],size])}
    var q_elem=[0,-1,_bL_,0],scan_stack_bottom=[0,[0,-1,q_elem],0];
    function clear_scan_stack(state){state[1] = scan_stack_bottom;return 0}
    function set_size(state,ty)
     {var _xU_=state[1];
      if(_xU_)
       {var
         match=_xU_[1],
         queue_elem=match[2],
         left_tot=match[1],
         size=queue_elem[1],
         t=_xU_[2],
         tok=queue_elem[2];
        if(left_tot < state[12])return clear_scan_stack(state);
        if(typeof tok !== "number")
         switch(tok[0])
          {case 3:
            var
             _xW_=1 - ty,
             _xX_=
              _xW_?(queue_elem[1] = state[13] + size | 0,state[1] = t,0):_xW_;
            return _xX_;
           case 1:
           case 2:
            var
             _xV_=
              ty?(queue_elem[1] = state[13] + size | 0,state[1] = t,0):ty;
            return _xV_
           }
        return 0}
      return 0}
    function scan_push(state,b,tok)
     {pp_enqueue(state,tok);
      if(b)set_size(state,1);
      state[1] = [0,[0,state[13],tok],state[1]];
      return 0}
    function pp_open_box_gen(state,indent,br_ty)
     {state[14] = state[14] + 1 | 0;
      if(state[14] < state[15])
       {var elem=[0,-state[13] | 0,[3,indent,br_ty],0];
        return scan_push(state,0,elem)}
      var _xS_=state[14] === state[15]?1:0;
      if(_xS_)
       {var _xT_=state[16],len=caml_ml_string_length(_xT_);
        return enqueue_string_as(state,len,_xT_)}
      return _xS_}
    function pp_close_box(state,param)
     {var _xQ_=1 < state[14]?1:0;
      if(_xQ_)
       {if(state[14] < state[15])
         {pp_enqueue(state,[0,0,1,0]);set_size(state,1);set_size(state,0)}
        state[14] = state[14] - 1 | 0;
        var _xR_=0}
      else
       var _xR_=_xQ_;
      return _xR_}
    function pp_close_tag(state,param)
     {if(state[23])pp_enqueue(state,[0,0,5,0]);
      var _xN_=state[22];
      if(_xN_)
       {var _xO_=state[4];
        if(_xO_)
         {var tags=_xO_[2],tag_name=_xO_[1];
          caml_call1(state[27],tag_name);
          state[4] = tags;
          return 0}
        var _xP_=0}
      else
       var _xP_=_xN_;
      return _xP_}
    function pp_flush_queue(state,b)
     {var param=state[4];
      for(;;)
       {if(param){var l=param[2];pp_close_tag(state,0);var param=l;continue}
        for(;;)
         {if(1 < state[14]){pp_close_box(state,0);continue}
          state[13] = pp_infinity;
          advance_left(state);
          if(b)pp_output_newline(state);
          state[12] = 1;
          state[13] = 1;
          var _xM_=state[28];
          _xM_[1] = 0;
          _xM_[2] = 0;
          clear_scan_stack(state);
          state[2] = 0;
          state[3] = 0;
          state[4] = 0;
          state[5] = 0;
          state[10] = 0;
          state[14] = 0;
          state[9] = state[6];
          return pp_open_box_gen(state,0,3)}}}
    function pp_print_as_size(state,size,s)
     {var _xL_=state[14] < state[15]?1:0;
      return _xL_?enqueue_string_as(state,size,s):_xL_}
    function pp_print_as(state,isize,s)
     {return pp_print_as_size(state,isize,s)}
    function pp_print_char(state,c){return pp_print_as(state,1,make$0(1,c))}
    function pp_print_flush(state,param)
     {pp_flush_queue(state,0);return caml_call1(state[18],0)}
    var blank_line=make$0(80,32);
    function display_indent(state,n)
     {var n$0=n;
      for(;;)
       {var _xK_=0 < n$0?1:0;
        if(_xK_)
         {if(80 < n$0)
           {caml_call3(state[17],blank_line,0,80);
            var n$1=n$0 - 80 | 0,n$0=n$1;
            continue}
          return caml_call3(state[17],blank_line,0,n$0)}
        return _xK_}}
    function default_pp_mark_open_tag(s){return _d_(_bO_,_d_(s,_bN_))}
    function default_pp_mark_close_tag(s){return _d_(_bQ_,_d_(s,_bP_))}
    function default_pp_print_open_tag(_xJ_){return 0}
    function default_pp_print_close_tag(_xI_){return 0}
    function make_formatter(output,flush)
     {function j(_xH_){return 0}
      function i(_xG_){return 0}
      function h(_xF_){return 0}
      var pp_queue=[0,0,0],sys_tok=[0,-1,_bR_,0];
      add_queue(sys_tok,pp_queue);
      var
       sys_scan_stack=[0,[0,1,sys_tok],scan_stack_bottom],
       ppf=
        [0,
         sys_scan_stack,
         0,
         0,
         0,
         0,
         78,
         10,
         68,
         78,
         0,
         1,
         1,
         1,
         1,
         max_int,
         _bS_,
         output,
         flush,
         h,
         i,
         j,
         0,
         0,
         default_pp_mark_open_tag,
         default_pp_mark_close_tag,
         default_pp_print_open_tag,
         default_pp_print_close_tag,
         pp_queue];
      ppf[19] = function(_xE_){return caml_call3(ppf[17],_bM_,0,1)};
      ppf[20] = function(_xD_){return display_indent(ppf,_xD_)};
      ppf[21] = function(_xC_){return display_indent(ppf,_xC_)};
      return ppf}
    function formatter_of_out_channel(oc)
     {function _xB_(param){return caml_ml_flush(oc)}
      return make_formatter
              (function(s,ofs,len)
                {if(0 <= ofs)
                  if(0 <= len)
                   if(!((caml_ml_string_length(s) - len | 0) < ofs))
                    return caml_ml_output(oc,s,ofs,len);
                 return invalid_arg(_g_)},
               _xB_)}
    function formatter_of_buffer(b)
     {function _xw_(_xA_){return 0}
      return make_formatter
              (function(s,offset,len)
                {var _xx_=offset < 0?1:0;
                 if(_xx_)
                  var _xy_=_xx_;
                 else
                  var
                   _xz_=len < 0?1:0,
                   _xy_=
                    _xz_
                    ||
                    ((caml_ml_string_length(s) - len | 0) < offset?1:0);
                 if(_xy_)invalid_arg(_E_);
                 var new_position=b[2] + len | 0;
                 if(b[3] < new_position)resize(b,len);
                 blit$0(s,offset,b[1],b[2],len);
                 b[2] = new_position;
                 return 0},
               _xw_)}
    var pp_buffer_size=512;
    function pp_make_buffer(param){return create(pp_buffer_size)}
    var stdbuf=pp_make_buffer(0),formatter=formatter_of_out_channel(stdout);
    formatter_of_out_channel(oc);
    formatter_of_buffer(stdbuf);
    function print_flush(_xv_){return pp_print_flush(formatter,_xv_)}
    function compute_tag(output,tag_acc)
     {var b=create(16),ppf=formatter_of_buffer(b);
      caml_call2(output,ppf,tag_acc);
      pp_print_flush(ppf,0);
      var len=b[2];
      if(2 <= len)
       {var len$0=len - 2 | 0,ofs=1;
        if(0 <= len$0)
         if(!((b[2] - len$0 | 0) < 1))return sub_string(b[1],ofs,len$0);
        return invalid_arg(_C_)}
      return contents(b)}
    function output_acc$0(ppf,acc)
     {if(typeof acc === "number")
       return 0;
      else
       switch(acc[0])
        {case 0:
          var f=acc[2],p=acc[1];
          output_acc$0(ppf,p);
          if(typeof f === "number")
           switch(f)
            {case 0:return pp_close_box(ppf,0);
             case 1:return pp_close_tag(ppf,0);
             case 2:return pp_print_flush(ppf,0);
             case 3:
              var _xj_=ppf[14] < ppf[15]?1:0;
              return _xj_?enqueue_advance(ppf,[0,0,3,0]):_xj_;
             case 4:pp_flush_queue(ppf,1);return caml_call1(ppf[18],0);
             case 5:return pp_print_char(ppf,64);
             default:return pp_print_char(ppf,37)}
          else
           switch(f[0])
            {case 0:
              var offset=f[3],width=f[2],_xk_=ppf[14] < ppf[15]?1:0;
              if(_xk_)
               {var elem=[0,-ppf[13] | 0,[1,width,offset],width];
                return scan_push(ppf,1,elem)}
              return _xk_;
             case 1:return 0;
             default:
              var c=f[1];pp_print_char(ppf,64);return pp_print_char(ppf,c)}
         case 1:
          var _xl_=acc[2],_xm_=acc[1];
          if(0 === _xl_[0])
           {var acc$0=_xl_[1];
            output_acc$0(ppf,_xm_);
            var tag_name=compute_tag(output_acc$0,acc$0);
            if(ppf[22])
             {ppf[4] = [0,tag_name,ppf[4]];caml_call1(ppf[26],tag_name)}
            var _xi_=ppf[23];
            return _xi_?pp_enqueue(ppf,[0,0,[5,tag_name],0]):_xi_}
          var acc$1=_xl_[1];
          output_acc$0(ppf,_xm_);
          var
           match=open_box_of_string(compute_tag(output_acc$0,acc$1)),
           bty=match[2],
           indent=match[1];
          return pp_open_box_gen(ppf,indent,bty);
         case 2:
          var _xn_=acc[1];
          if(typeof _xn_ === "number")
           var switch$1=1;
          else
           if(0 === _xn_[0])
            {var _xo_=_xn_[2];
             if(typeof _xo_ === "number")
              var switch$2=1;
             else
              if(1 === _xo_[0])
               var
                s$0=acc[2],
                size=_xo_[2],
                p$1=_xn_[1],
                switch$0=0,
                switch$1=0,
                switch$2=0;
              else
               var switch$2=1;
             if(switch$2)var switch$1=1}
           else
            var switch$1=1;
          if(switch$1)var s=acc[2],p$0=_xn_,switch$0=2;
          break;
         case 3:
          var _xp_=acc[1];
          if(typeof _xp_ === "number")
           var switch$3=1;
          else
           if(0 === _xp_[0])
            {var _xq_=_xp_[2];
             if(typeof _xq_ === "number")
              var switch$4=1;
             else
              if(1 === _xq_[0])
               var
                c$1=acc[2],
                size$0=_xq_[2],
                p$3=_xp_[1],
                switch$0=1,
                switch$3=0,
                switch$4=0;
              else
               var switch$4=1;
             if(switch$4)var switch$3=1}
           else
            var switch$3=1;
          if(switch$3)var c$0=acc[2],p$2=_xp_,switch$0=3;
          break;
         case 4:
          var _xr_=acc[1];
          if(typeof _xr_ === "number")
           var switch$5=1;
          else
           if(0 === _xr_[0])
            {var _xs_=_xr_[2];
             if(typeof _xs_ === "number")
              var switch$6=1;
             else
              if(1 === _xs_[0])
               var
                s$0=acc[2],
                size=_xs_[2],
                p$1=_xr_[1],
                switch$0=0,
                switch$5=0,
                switch$6=0;
              else
               var switch$6=1;
             if(switch$6)var switch$5=1}
           else
            var switch$5=1;
          if(switch$5)var s=acc[2],p$0=_xr_,switch$0=2;
          break;
         case 5:
          var _xt_=acc[1];
          if(typeof _xt_ === "number")
           var switch$7=1;
          else
           if(0 === _xt_[0])
            {var _xu_=_xt_[2];
             if(typeof _xu_ === "number")
              var switch$8=1;
             else
              if(1 === _xu_[0])
               var
                c$1=acc[2],
                size$0=_xu_[2],
                p$3=_xt_[1],
                switch$0=1,
                switch$7=0,
                switch$8=0;
              else
               var switch$8=1;
             if(switch$8)var switch$7=1}
           else
            var switch$7=1;
          if(switch$7)var c$0=acc[2],p$2=_xt_,switch$0=3;
          break;
         case 6:
          var f$0=acc[2],p$4=acc[1];
          output_acc$0(ppf,p$4);
          return caml_call1(f$0,ppf);
         case 7:
          var p$5=acc[1];output_acc$0(ppf,p$5);return pp_print_flush(ppf,0);
         default:
          var msg=acc[2],p$6=acc[1];
          output_acc$0(ppf,p$6);
          return invalid_arg(msg)}
      switch(switch$0)
       {case 0:output_acc$0(ppf,p$1);return pp_print_as_size(ppf,size,s$0);
        case 1:
         output_acc$0(ppf,p$3);
         return pp_print_as_size(ppf,size$0,make$0(1,c$1));
        case 2:
         output_acc$0(ppf,p$0);
         return pp_print_as(ppf,caml_ml_string_length(s),s);
        default:output_acc$0(ppf,p$2);return pp_print_char(ppf,c$0)}}
    function fprintf$0(ppf)
     {return function(param)
       {var fmt=param[1],_xh_=0;
        return make_printf
                (function(ppf,acc){output_acc$0(ppf,acc);return 0},
                 ppf,
                 _xh_,
                 fmt)}}
    at_exit(print_flush);
    var null_char=0,default_token_buffer_size=1024;
    function scan_raise_at_end(ic){throw End_of_file}
    function from_ic(scan_close_ic,iname,ic)
     {var s=caml_create_bytes(1024),i=[0,0],lim=[0,0],eof=[0,0];
      function next(param)
       {if(i[1] < lim[1]){var c=caml_bytes_get(s,i[1]);i[1]++;return c}
        if(eof[1])throw End_of_file;
        var
         _xg_=
          (caml_ml_bytes_length(s) - 1024 | 0) < 0
           ?invalid_arg(_h_)
           :caml_ml_input(ic,s,0,1024);
        lim[1] = _xg_;
        return 0 === lim[1]
                ?(eof[1] = 1,caml_call1(scan_close_ic,ic))
                :(i[1] = 1,caml_bytes_get(s,0))}
      return [0,
              0,
              null_char,
              0,
              0,
              0,
              0,
              next,
              create(default_token_buffer_size),
              iname]}
    from_ic(scan_raise_at_end,[1,_bT_,stdin],stdin);
    caml_fresh_oo_id(0);
    function register_exception(name,exn)
     {var slot=caml_obj_tag(exn) === 248?exn:exn[1];
      return caml_register_named_value(name,slot)}
    try
     {caml_sys_getenv(_jg_)}
    catch(_xf_)
     {_xf_ = caml_wrap_exception(_xf_);if(_xf_ !== Not_found)throw _xf_}
    try
     {caml_sys_getenv(_jf_)}
    catch(_xe_)
     {_xe_ = caml_wrap_exception(_xe_);if(_xe_ !== Not_found)throw _xe_}
    var
     switch$0=
      caml_string_notequal(os_type,_bU_)
       ?caml_string_notequal(os_type,_bV_)?1:0
       :0;
    function add(x,y){return [254,x[1] + y[1],x[2] + y[2]]}
    function sub$2(x,y){return [254,x[1] - y[1],x[2] - y[2]]}
    function mul(x,y)
     {return [254,x[1] * y[1] - x[2] * y[2],x[1] * y[2] + x[2] * y[1]]}
    function div(x,y)
     {if(Math.abs(y[2]) <= Math.abs(y[1]))
       {var r=y[2] / y[1],d=y[1] + r * y[2];
        return [254,(x[1] + r * x[2]) / d,(x[2] - r * x[1]) / d]}
      var r$0=y[1] / y[2],d$0=y[2] + r$0 * y[1];
      return [254,(r$0 * x[1] + x[2]) / d$0,(r$0 * x[2] - x[1]) / d$0]}
    var Unix_error=[248,_bW_,caml_fresh_oo_id(0)];
    register_exception(_bZ_,[0,Unix_error,0,_bY_,_bX_]);
    register_printer
     (function(param)
       {if(param[1] === Unix_error)
         {var s=param[4],s$0=param[3],e=param[2];
          if(typeof e === "number")
           {var _xd_=e;
            if(34 <= _xd_)
             switch(_xd_)
              {case 34:var msg=_cx_;break;
               case 35:var msg=_cy_;break;
               case 36:var msg=_cz_;break;
               case 37:var msg=_cA_;break;
               case 38:var msg=_cB_;break;
               case 39:var msg=_cC_;break;
               case 40:var msg=_cD_;break;
               case 41:var msg=_cE_;break;
               case 42:var msg=_cF_;break;
               case 43:var msg=_cG_;break;
               case 44:var msg=_cH_;break;
               case 45:var msg=_cI_;break;
               case 46:var msg=_cJ_;break;
               case 47:var msg=_cK_;break;
               case 48:var msg=_cL_;break;
               case 49:var msg=_cM_;break;
               case 50:var msg=_cN_;break;
               case 51:var msg=_cO_;break;
               case 52:var msg=_cP_;break;
               case 53:var msg=_cQ_;break;
               case 54:var msg=_cR_;break;
               case 55:var msg=_cS_;break;
               case 56:var msg=_cT_;break;
               case 57:var msg=_cU_;break;
               case 58:var msg=_cV_;break;
               case 59:var msg=_cW_;break;
               case 60:var msg=_cX_;break;
               case 61:var msg=_cY_;break;
               case 62:var msg=_cZ_;break;
               case 63:var msg=_c0_;break;
               case 64:var msg=_c1_;break;
               case 65:var msg=_c2_;break;
               case 66:var msg=_c3_;break;
               default:var msg=_c4_}
            else
             switch(_xd_)
              {case 0:var msg=_b0_;break;
               case 1:var msg=_b2_;break;
               case 2:var msg=_b3_;break;
               case 3:var msg=_b4_;break;
               case 4:var msg=_b5_;break;
               case 5:var msg=_b6_;break;
               case 6:var msg=_b7_;break;
               case 7:var msg=_b8_;break;
               case 8:var msg=_b9_;break;
               case 9:var msg=_b__;break;
               case 10:var msg=_b$_;break;
               case 11:var msg=_ca_;break;
               case 12:var msg=_cb_;break;
               case 13:var msg=_cc_;break;
               case 14:var msg=_cd_;break;
               case 15:var msg=_ce_;break;
               case 16:var msg=_cf_;break;
               case 17:var msg=_cg_;break;
               case 18:var msg=_ch_;break;
               case 19:var msg=_ci_;break;
               case 20:var msg=_cj_;break;
               case 21:var msg=_ck_;break;
               case 22:var msg=_cl_;break;
               case 23:var msg=_cm_;break;
               case 24:var msg=_cn_;break;
               case 25:var msg=_co_;break;
               case 26:var msg=_cp_;break;
               case 27:var msg=_cq_;break;
               case 28:var msg=_cr_;break;
               case 29:var msg=_cs_;break;
               case 30:var msg=_ct_;break;
               case 31:var msg=_cu_;break;
               case 32:var msg=_cv_;break;
               default:var msg=_cw_}}
          else
           var x=e[1],msg=caml_call1(sprintf(_c5_),x);
          return [0,caml_call3(sprintf(_b1_),msg,s$0,s)]}
        return 0});
    unix_inet_addr_of_string(_c6_);
    unix_inet_addr_of_string(_c7_);
    try
     {unix_inet_addr_of_string(_je_)}
    catch(_xc_)
     {_xc_ = caml_wrap_exception(_xc_);if(_xc_[1] !== Failure)throw _xc_}
    try
     {unix_inet_addr_of_string(_jd_)}
    catch(_xb_)
     {_xb_ = caml_wrap_exception(_xb_);if(_xb_[1] !== Failure)throw _xb_}
    create$0(0,7);
    function dims(a)
     {var n=caml_ba_num_dims(a),d=caml_make_vect(n,0),_w__=n - 1 | 0,_w9_=0;
      if(!(_w__ < 0))
       {var i=_w9_;
        for(;;)
         {var _w$_=caml_ba_dim(a,i);
          caml_check_bound(d,i)[i + 1] = _w$_;
          var _xa_=i + 1 | 0;
          if(_w__ !== i){var i=_xa_;continue}
          break}}
      return d}
    function array1_of_genarray(a)
     {return 1 === caml_ba_num_dims(a)?a:invalid_arg(_c8_)}
    var log2e=1.44269504088896339,log10e=0.434294481903251817;
    function zero$0(param)
     {switch(param)
       {case 0:return 0;
        case 1:return 0;
        case 2:return 0;
        case 3:return 0;
        case 4:return 0;
        case 5:return 0;
        case 6:return 0;
        case 7:return _c9_;
        case 8:return 0;
        case 9:return 0;
        case 10:return zero;
        case 11:return zero;
        default:return 0}}
    function one$0(param)
     {switch(param)
       {case 0:return 1;
        case 1:return 1;
        case 2:return 1;
        case 3:return 1;
        case 4:return 1;
        case 5:return 1;
        case 6:return 1;
        case 7:return _c__;
        case 8:return 1;
        case 9:return 1;
        case 10:return one;
        case 11:return one;
        default:return 1}}
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    caml_fresh_oo_id(0);
    function calc_conv2d_output_shape
     (padding,
      input_cols,
      input_rows,
      kernel_cols,
      kernel_rows,
      row_stride,
      col_stride)
     {var
       output_cols=
        0 === padding
         ?Math.ceil(input_cols / col_stride) | 0
         :Math.ceil((input_cols - kernel_cols + 1) / col_stride) | 0,
       output_rows=
        0 === padding
         ?Math.ceil(input_rows / row_stride) | 0
         :Math.ceil((input_rows - kernel_rows + 1) / row_stride) | 0;
      return [0,output_cols,output_rows]}
    function calc_conv2d_padding
     (input_cols,
      input_rows,
      kernel_cols,
      kernel_rows,
      output_cols,
      output_rows,
      row_stride,
      col_stride)
     {var
       pad_along_height=
        max
         ((caml_mul(output_rows - 1 | 0,row_stride) + kernel_rows | 0)
          -
          input_rows
          |
          0,
          0),
       pad_along_width=
        max
         ((caml_mul(output_cols - 1 | 0,col_stride) + kernel_cols | 0)
          -
          input_cols
          |
          0,
          0),
       pad_top=pad_along_height / 2 | 0,
       pad_bottom=pad_along_height - pad_top | 0,
       pad_left=pad_along_width / 2 | 0,
       pad_right=pad_along_width - pad_left | 0;
      return [0,pad_top,pad_left,pad_bottom,pad_right]}
    function calc_conv3d_output_shape
     (padding,
      input_cols,
      input_rows,
      input_dpts,
      kernel_cols,
      kernel_rows,
      kernel_dpts,
      row_stride,
      col_stride,
      dpt_stride)
     {var
       output_cols=
        0 === padding
         ?Math.ceil(input_cols / col_stride) | 0
         :Math.ceil((input_cols - kernel_cols + 1) / col_stride) | 0,
       output_rows=
        0 === padding
         ?Math.ceil(input_rows / row_stride) | 0
         :Math.ceil((input_rows - kernel_rows + 1) / row_stride) | 0,
       output_dpts=
        0 === padding
         ?Math.ceil(input_dpts / dpt_stride) | 0
         :Math.ceil((input_dpts - kernel_dpts + 1) / dpt_stride) | 0;
      return [0,output_cols,output_rows,output_dpts]}
    function calc_conv3d_padding
     (input_cols,
      input_rows,
      input_depth,
      kernel_cols,
      kernel_rows,
      kernel_depth,
      output_cols,
      output_rows,
      output_depth,
      row_stride,
      col_stride,
      depth_stride)
     {var
       pad_along_height=
        max
         ((caml_mul(output_rows - 1 | 0,row_stride) + kernel_rows | 0)
          -
          input_rows
          |
          0,
          0),
       pad_along_width=
        max
         ((caml_mul(output_cols - 1 | 0,col_stride) + kernel_cols | 0)
          -
          input_cols
          |
          0,
          0),
       pad_along_depth=
        max
         ((caml_mul(output_depth - 1 | 0,depth_stride) + kernel_depth | 0)
          -
          input_depth
          |
          0,
          0),
       pad_top=pad_along_height / 2 | 0,
       pad_bottom=pad_along_height - pad_top | 0,
       pad_left=pad_along_width / 2 | 0,
       pad_right=pad_along_width - pad_left | 0,
       pad_shallow=pad_along_depth / 2 | 0,
       pad_deep=pad_along_depth - pad_shallow | 0;
      return [0,pad_top,pad_left,pad_shallow,pad_bottom,pad_right,pad_deep]}
    function calc_stride(s)
     {var d=s.length - 1,r=caml_make_vect(d,1),_w2_=d - 1 | 0,_w1_=1;
      if(!(_w2_ < 1))
       {var i=_w1_;
        for(;;)
         {var
           _w3_=d - i | 0,
           _w5_=d - i | 0,
           _w4_=caml_check_bound(r,_w3_)[_w3_ + 1],
           _w7_=(d - i | 0) - 1 | 0,
           _w6_=caml_mul(caml_check_bound(s,_w5_)[_w5_ + 1],_w4_);
          caml_check_bound(r,_w7_)[_w7_ + 1] = _w6_;
          var _w8_=i + 1 | 0;
          if(_w2_ !== i){var i=_w8_;continue}
          break}}
      return r}
    function string_of_array(opt,_w0_,_wZ_,string_of_x,x$0)
     {if(opt)var sth=opt[1],prefix=sth;else var prefix=_dp_;
      if(_w0_)var sth$0=_w0_[1],suffix=sth$0;else var suffix=_do_;
      if(_wZ_)var sth$1=_wZ_[1],sep=sth$1;else var sep=_dn_;
      var l=map(string_of_x,to_list(x$0));
      if(l)
       {var seplen=caml_ml_string_length(sep),acc=0,param=l,pos$1=0;
        for(;;)
         {if(param)
           {var _wU_=param[2],_wV_=param[1];
            if(_wU_)
             {var
               x=(caml_ml_string_length(_wV_) + seplen | 0) + acc | 0,
               acc$0=acc <= x?x:invalid_arg(_v_),
               acc=acc$0,
               param=_wU_;
              continue}
            var _wY_=caml_ml_string_length(_wV_) + acc | 0}
          else
           var _wY_=acc;
          var dst=caml_create_bytes(_wY_),pos=pos$1,param$0=l;
          for(;;)
           {if(param$0)
             {var _wW_=param$0[2],_wX_=param$0[1];
              if(_wW_)
               {caml_blit_string(_wX_,0,dst,pos,caml_ml_string_length(_wX_));
                caml_blit_string
                 (sep,0,dst,pos + caml_ml_string_length(_wX_) | 0,seplen);
                var
                 pos$0=(pos + caml_ml_string_length(_wX_) | 0) + seplen | 0,
                 pos=pos$0,
                 param$0=_wW_;
                continue}
              caml_blit_string(_wX_,0,dst,pos,caml_ml_string_length(_wX_));
              var s=dst}
            else
             var s=dst;
            break}
          break}}
      else
       var s=_w_;
      return caml_call3(sprintf(_dm_),prefix,s,suffix)}
    function eps(param)
     {switch(param)
       {case 0:return 1.1920928955078125e-07;
        case 1:return 2.22044604925031308e-16;
        case 10:return 1.1920928955078125e-07;
        case 11:return 2.22044604925031308e-16;
        default:return failwith(_dq_)}}
    function Make(A)
     {var global_tag=[0,0];
      function tag(param)
       {global_tag[1] = global_tag[1] + 1 | 0;return global_tag[1]}
      function cmp_tag(ai,bi)
       {return caml_greaterthan(ai,bi)?1:caml_lessthan(ai,bi)?-1:0}
      function reset_zero(param)
       {switch(param[0])
         {case 0:return _dr_;
          case 1:var ap=param[1];caml_call1(A[17],ap);return [1,ap];
          default:return failwith(_ds_)}}
      function primal(ap)
       {switch(ap[0])
         {case 2:var ap$0=ap[1];return ap$0;
          case 3:var ap$1=ap[1];return ap$1;
          default:return ap}}
      function primal$0(ap)
       {var ap$0=ap;
        for(;;)
         switch(ap$0[0])
          {case 2:var ap$1=ap$0[1],ap$0=ap$1;continue;
           case 3:var ap$2=ap$0[1],ap$0=ap$2;continue;
           default:return ap$0}}
      function zero(param)
       {var param$0=param;
        for(;;)
         switch(param$0[0])
          {case 0:return _dt_;
           case 1:
            var ap=param$0[1],_wT_=caml_call1(A[10],ap);
            return [1,caml_call1(A[2],_wT_)];
           case 2:
            var ap$0=param$0[1],param$1=primal$0(ap$0),param$0=param$1;
            continue;
           default:
            var ap$1=param$0[1],param$2=primal$0(ap$1),param$0=param$2;
            continue}}
      function tangent(ap)
       {switch(ap[0])
         {case 2:var at=ap[2];return at;
          case 3:return failwith(_du_);
          default:return zero(ap)}}
      function adjref(ap)
       {switch(ap[0])
         {case 2:return failwith(_dv_);
          case 3:var at=ap[2];return at;
          default:return [0,zero(ap)]}}
      function adjval(ap)
       {switch(ap[0])
         {case 2:return failwith(_dw_);
          case 3:var at=ap[2];return at[1];
          default:return zero(ap)}}
      function shape(x)
       {var match=primal$0(x);
        if(1 === match[0]){var ap=match[1];return caml_call1(A[10],ap)}
        return failwith(_dx_)}
      function row_num(x){return caml_check_bound(shape(x),0)[1]}
      function col_num(x){return caml_check_bound(shape(x),1)[2]}
      function numel(x)
       {var match=primal$0(x);
        if(1 === match[0]){var x$0=match[1];return caml_call1(A[11],x$0)}
        return failwith(_dy_)}
      function clip_by_value(amin,amax,x)
       {var match=primal$0(x);
        if(1 === match[0])
         {var x$0=match[1];return [1,caml_call3(A[63],[0,amin],[0,amax],x$0)]}
        return failwith(_dz_)}
      function clip_by_l2norm(a,x)
       {var match=primal$0(x);
        if(1 === match[0])
         {var x$0=match[1];return [1,caml_call2(A[64],a,x$0)]}
        return failwith(_dA_)}
      function copy_primal(x)
       {var match=primal$0(x);
        if(1 === match[0]){var ap=match[1];return [1,caml_call1(A[16],ap)]}
        return failwith(_dB_)}
      function tile(x,reps)
       {var match=primal$0(x);
        if(1 === match[0])
         {var x$0=match[1];return [1,caml_call2(A[20],x$0,reps)]}
        return failwith(_dC_)}
      function repeat(axis,x,reps)
       {var match=primal$0(x);
        if(1 === match[0])
         {var x$0=match[1];return [1,caml_call3(A[21],axis,x$0,reps)]}
        return failwith(_dD_)}
      function pack_arr(x){return [1,x]}
      function unpack_arr(x)
       {var match=primal(x);
        if(1 === match[0]){var x$0=match[1];return x$0}
        return failwith(_dE_)}
      function pack_flt(x){return [0,x]}
      function unpack_flt(x)
       {var match=primal(x);
        if(0 === match[0]){var x$0=match[1];return x$0}
        return failwith(_dF_)}
      function deep_info(x)
       {var match=primal$0(x);
        switch(match[0])
         {case 0:var a=match[1];return caml_call1(sprintf(_dG_),a);
          case 1:
           var
            a$0=match[1],
            _wS_=string_of_array(0,0,0,string_of_int,caml_call1(A[10],a$0));
           return caml_call1(sprintf(_dH_),_wS_);
          default:return _dI_}}
      function type_info(x)
       {switch(x[0])
         {case 0:var _wO_=deep_info(x);return caml_call1(sprintf(_dJ_),_wO_);
          case 1:var _wP_=deep_info(x);return caml_call1(sprintf(_dK_),_wP_);
          case 2:
           var ai=x[3],ap=x[1],_wQ_=deep_info(ap);
           return caml_call2(sprintf(_dL_),ai,_wQ_);
          default:
           var ai$0=x[5],ap$0=x[1],_wR_=deep_info(ap$0);
           return caml_call2(sprintf(_dM_),ai$0,_wR_)}}
      function error_binop(op,a,b)
       {var s0=_d_(_dN_,type_info(a)),s1=_d_(_dO_,type_info(b));
        return failwith(_d_(op,_d_(_dQ_,_d_(s0,_d_(_dP_,s1)))))}
      function error_uniop(op,a)
       {var s=type_info(a);return failwith(_d_(op,_d_(_dR_,s)))}
      function noop(param){return 0}
      function op_d_d(a,ff,fd,df,r)
       {switch(a[0])
         {case 2:
           var ai=a[3],at=a[2],ap=a[1],cp=caml_call1(fd,ap);
           return [2,cp,caml_call3(df,cp,ap,at),ai];
          case 3:
           var
            ai$0=a[5],
            ap$0=a[1],
            cp$0=caml_call1(fd,ap$0),
            _wN_=caml_call1(r,a);
           return [3,cp$0,[0,zero(cp$0)],_wN_,[0,0],ai$0];
          default:return caml_call1(ff,a)}}
      function op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)
       {switch(a[0])
         {case 0:
           switch(b[0])
            {case 2:
              var bi=b[3],bt=b[2],bp=b[1],cp=caml_call2(fd,a,bp);
              return [2,cp,caml_call3(df_db,cp,bp,bt),bi];
             case 3:
              var
               bi$0=b[5],
               bp$0=b[1],
               cp$0=caml_call2(fd,a,bp$0),
               _wz_=caml_call2(r_c_d,a,b);
              return [3,cp$0,[0,zero(cp$0)],_wz_,[0,0],bi$0]
             }
           break;
          case 1:
           switch(b[0])
            {case 2:
              var bi$1=b[3],bt$0=b[2],bp$1=b[1],cp$1=caml_call2(fd,a,bp$1);
              return [2,cp$1,caml_call3(df_db,cp$1,bp$1,bt$0),bi$1];
             case 3:
              var
               bi$2=b[5],
               bp$2=b[1],
               cp$2=caml_call2(fd,a,bp$2),
               _wA_=caml_call2(r_c_d,a,b);
              return [3,cp$2,[0,zero(cp$2)],_wA_,[0,0],bi$2]
             }
           break;
          case 2:
           var _wB_=a[3],_wC_=a[2],_wD_=a[1];
           switch(b[0])
            {case 0:
              var cp$3=caml_call2(fd,_wD_,b);
              return [2,cp$3,caml_call3(df_da,cp$3,_wD_,_wC_),_wB_];
             case 1:
              var cp$4=caml_call2(fd,_wD_,b);
              return [2,cp$4,caml_call3(df_da,cp$4,_wD_,_wC_),_wB_];
             case 2:
              var bi$3=b[3],bt$1=b[2],bp$3=b[1],match=cmp_tag(_wB_,bi$3);
              if(0 === match)
               {var cp$5=caml_call2(fd,_wD_,bp$3);
                return [2,
                        cp$5,
                        caml_call5(df_dab,cp$5,_wD_,_wC_,bp$3,bt$1),
                        _wB_]}
              if(1 === match)
               {var cp$6=caml_call2(fd,_wD_,b);
                return [2,cp$6,caml_call3(df_da,cp$6,_wD_,_wC_),_wB_]}
              var cp$7=caml_call2(fd,a,bp$3);
              return [2,cp$7,caml_call3(df_db,cp$7,bp$3,bt$1),bi$3];
             default:
              var
               bi$4=b[5],
               bp$4=b[1],
               match$0=cmp_tag(_wB_,bi$4),
               switcher=match$0 + 1 | 0;
              if(!(2 < switcher >>> 0))
               switch(switcher)
                {case 0:
                  var cp$8=caml_call2(fd,a,bp$4),_wE_=caml_call2(r_c_d,a,b);
                  return [3,cp$8,[0,zero(cp$8)],_wE_,[0,0],bi$4];
                 case 1:break;
                 default:
                  var cp$9=caml_call2(fd,_wD_,b);
                  return [2,cp$9,caml_call3(df_da,cp$9,_wD_,_wC_),_wB_]}
              return failwith(_dS_)}
          default:
           var _wF_=a[5],_wG_=a[1];
           switch(b[0])
            {case 0:
              var cp$10=caml_call2(fd,_wG_,b),_wH_=caml_call2(r_d_c,a,b);
              return [3,cp$10,[0,zero(cp$10)],_wH_,[0,0],_wF_];
             case 1:
              var cp$11=caml_call2(fd,_wG_,b),_wI_=caml_call2(r_d_c,a,b);
              return [3,cp$11,[0,zero(cp$11)],_wI_,[0,0],_wF_];
             case 2:
              var
               bi$5=b[3],
               bt$2=b[2],
               bp$5=b[1],
               match$1=cmp_tag(_wF_,bi$5),
               switcher$0=match$1 + 1 | 0;
              if(!(2 < switcher$0 >>> 0))
               switch(switcher$0)
                {case 0:
                  var cp$12=caml_call2(fd,a,bp$5);
                  return [2,cp$12,caml_call3(df_db,cp$12,bp$5,bt$2),bi$5];
                 case 1:break;
                 default:
                  var cp$13=caml_call2(fd,_wG_,b),_wJ_=caml_call2(r_d_c,a,b);
                  return [3,cp$13,[0,zero(cp$13)],_wJ_,[0,0],_wF_]}
              return failwith(_dT_);
             default:
              var bi$6=b[5],bp$6=b[1],match$2=cmp_tag(_wF_,bi$6);
              if(0 === match$2)
               {var cp$14=caml_call2(fd,_wG_,bp$6),_wK_=caml_call2(r_d_d,a,b);
                return [3,cp$14,[0,zero(cp$14)],_wK_,[0,0],_wF_]}
              if(1 === match$2)
               {var cp$15=caml_call2(fd,_wG_,b),_wL_=caml_call2(r_d_c,a,b);
                return [3,cp$15,[0,zero(cp$15)],_wL_,[0,0],_wF_]}
              var cp$16=caml_call2(fd,a,bp$6),_wM_=caml_call2(r_c_d,a,b);
              return [3,cp$16,[0,zero(cp$16)],_wM_,[0,0],bi$6]}}
        return caml_call2(ff,a,b)}
      function add(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wx_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][1],_wx_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[79],_wx_,b$1)]
               }
             break;
            case 1:
             var _wy_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[75],_wy_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[71],_wy_,b$3)]
               }
             break
            }
          return error_binop(_dU_,a,b)}
        function fd(a,b){return _st_(a,b)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return bt}
        function df_dab(cp,ap,at,bp,bt){return _st_(at,bt)}
        function r_d_d(a,b){return [0,a,b]}
        function r_d_c(a,b){return [1,a,b]}
        function r_c_d(a,b){return [2,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _st_(a,b){return add(a,b)}
      function sub(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wv_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][2],_wv_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[80],_wv_,b$1)]
               }
             break;
            case 1:
             var _ww_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[76],_ww_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[72],_ww_,b$3)]
               }
             break
            }
          return error_binop(_dV_,a,b)}
        function fd(a,b){return _su_(a,b)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return neg(bt)}
        function df_dab(cp,ap,at,bp,bt){return _su_(at,bt)}
        function r_d_d(a,b){return [3,a,b]}
        function r_d_c(a,b){return [4,a,b]}
        function r_c_d(a,b){return [5,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _su_(a,b){return sub(a,b)}
      function mul(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wt_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][3],_wt_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[81],_wt_,b$1)]
               }
             break;
            case 1:
             var _wu_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[77],_wu_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[73],_wu_,b$3)]
               }
             break
            }
          return error_binop(_dW_,a,b)}
        function fd(a,b){return _sv_(a,b)}
        function df_da(cp,ap,at){return _sv_(at,b)}
        function df_db(cp,bp,bt){return _sv_(a,bt)}
        function df_dab(cp,ap,at,bp,bt)
         {var _ws_=_sv_(at,bp);return _st_(_sv_(ap,bt),_ws_)}
        function r_d_d(a,b){return [6,a,b]}
        function r_d_c(a,b){return [7,a,b]}
        function r_c_d(a,b){return [8,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _sv_(a,b){return mul(a,b)}
      function div(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wq_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][4],_wq_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[82],_wq_,b$1)]
               }
             break;
            case 1:
             var _wr_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[78],_wr_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[74],_wr_,b$3)]
               }
             break
            }
          return error_binop(_dX_,a,b)}
        function fd(a,b){return _sw_(a,b)}
        function df_da(cp,ap,at){return _sw_(at,b)}
        function df_db(cp,bp,bt){return _sw_(_sv_(neg(bt),cp),bp)}
        function df_dab(cp,ap,at,bp,bt){return _sw_(_su_(at,_sv_(bt,cp)),bp)}
        function r_d_d(a,b){return [9,a,b]}
        function r_d_c(a,b){return [10,a,b]}
        function r_c_d(a,b){return [11,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _sw_(a,b){return div(a,b)}
      function pow(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wo_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][5],_wo_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[66],_wo_,b$1)]
               }
             break;
            case 1:
             var _wp_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[67],_wp_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[65],_wp_,b$3)]
               }
             break
            }
          return error_binop(_dY_,a,b)}
        function fd(a,b){return _sx_(a,b)}
        function df_da(cp,ap,at)
         {return _sv_(_sv_(at,_sx_(ap,_su_(b,_dZ_))),b)}
        function df_db(cp,bp,bt)
         {var _wn_=log(a);return _sv_(_sv_(bt,cp),_wn_)}
        function df_dab(cp,ap,at,bp,bt)
         {var
           _wk_=log(ap),
           _wl_=_sv_(_sv_(ap,bt),_wk_),
           _wm_=_st_(_sv_(at,bp),_wl_);
          return _sv_(_sx_(ap,_su_(bp,_d0_)),_wm_)}
        function r_d_d(a,b){return [12,a,b]}
        function r_d_c(a,b){return [13,a,b]}
        function r_c_d(a,b){return [14,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _sx_(a,b){return pow(a,b)}
      function atan2(a,b)
       {function ff(a,b)
         {switch(a[0])
           {case 0:
             var _wi_=a[1];
             switch(b[0])
              {case 0:var b$0=b[1];return [0,caml_call2(A[145][6],_wi_,b$0)];
               case 1:var b$1=b[1];return [1,caml_call2(A[69],_wi_,b$1)]
               }
             break;
            case 1:
             var _wj_=a[1];
             switch(b[0])
              {case 0:var b$2=b[1];return [1,caml_call2(A[70],_wj_,b$2)];
               case 1:var b$3=b[1];return [1,caml_call2(A[68],_wj_,b$3)]
               }
             break
            }
          return error_binop(_d1_,a,b)}
        function fd(a,b){return atan2(a,b)}
        function df_da(cp,ap,at)
         {var _wg_=sqr(b),_wh_=_st_(sqr(ap),_wg_);
          return _sw_(_sv_(at,b),_wh_)}
        function df_db(cp,bp,bt)
         {var _we_=sqr(bp),_wf_=_st_(sqr(a),_we_);
          return _sw_(_sv_(neg(bt),a),_wf_)}
        function df_dab(cp,ap,at,bp,bt)
         {var _wb_=sqr(bp),_wc_=_st_(sqr(ap),_wb_),_wd_=_sv_(bt,ap);
          return _sw_(_su_(_sv_(at,bp),_wd_),_wc_)}
        function r_d_d(a,b){return [15,a,b]}
        function r_d_c(a,b){return [16,a,b]}
        function r_c_d(a,b){return [17,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function min2(a,b)
       {var _wa_=abs(_su_(a,b));return _sw_(_su_(_st_(a,b),_wa_),_d2_)}
      function max2(a,b)
       {var _v$_=abs(_su_(b,a));return _sw_(_st_(_st_(a,b),_v$_),_d3_)}
      function neg(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][8],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[30],a$1)];
            default:return error_uniop(_d4_,a)}}
        function fd(a){return neg(a)}
        function df(cp,ap,at){return _su_(_d5_,at)}
        function r(a){return [18,a]}
        return op_d_d(a,ff,fd,df,r)}
      function abs(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][7],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[29],a$1)];
            default:return error_uniop(_d6_,a)}}
        function fd(a){return abs(a)}
        function df(cp,ap,at){return _sv_(at,signum(ap))}
        function r(a){return [19,a]}
        return op_d_d(a,ff,fd,df,r)}
      function signum(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][15],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[54],a$1)];
            default:return error_uniop(_d7_,a)}}
        function fd(a){return signum(a)}
        function df(cp,ap,at){return zero(ap)}
        function r(a){return [20,a]}
        return op_d_d(a,ff,fd,df,r)}
      function floor(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][16],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[31],a$1)];
            default:return error_uniop(_d8_,a)}}
        function fd(a){return floor(a)}
        function df(cp,ap,at){return zero(ap)}
        function r(a){return [21,a]}
        return op_d_d(a,ff,fd,df,r)}
      function ceil(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][17],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[32],a$1)];
            default:return error_uniop(_d9_,a)}}
        function fd(a){return ceil(a)}
        function df(cp,ap,at){return zero(ap)}
        function r(a){return [22,a]}
        return op_d_d(a,ff,fd,df,r)}
      function round(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][18],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[33],a$1)];
            default:return error_uniop(_d__,a)}}
        function fd(a){return round(a)}
        function df(cp,ap,at){return zero(ap)}
        function r(a){return [23,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sqr(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][9],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[34],a$1)];
            default:return error_uniop(_d$_,a)}}
        function fd(a){return sqr(a)}
        function df(cp,ap,at){return _sv_(_sv_(_ea_,at),ap)}
        function r(a){return [24,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sqrt(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][10],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[35],a$1)];
            default:return error_uniop(_eb_,a)}}
        function fd(a){return sqrt(a)}
        function df(cp,ap,at){return _sw_(at,_sv_(_ec_,cp))}
        function r(a){return [25,a]}
        return op_d_d(a,ff,fd,df,r)}
      function log(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][12],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[36],a$1)];
            default:return error_uniop(_ed_,a)}}
        function fd(a){return log(a)}
        function df(cp,ap,at){return _sw_(at,ap)}
        function r(a){return [26,a]}
        return op_d_d(a,ff,fd,df,r)}
      function log2(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][13],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[37],a$1)];
            default:return error_uniop(_ee_,a)}}
        function fd(a){return log2(a)}
        function df(cp,ap,at){return _sw_(at,_sv_(ap,[0,log2e]))}
        function r(a){return [27,a]}
        return op_d_d(a,ff,fd,df,r)}
      function log10(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][14],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[38],a$1)];
            default:return error_uniop(_ef_,a)}}
        function fd(a){return log10(a)}
        function df(cp,ap,at){return _sw_(at,_sv_(ap,[0,log10e]))}
        function r(a){return [28,a]}
        return op_d_d(a,ff,fd,df,r)}
      function exp(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][11],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[39],a$1)];
            default:return error_uniop(_eg_,a)}}
        function fd(a){return exp(a)}
        function df(cp,ap,at){return _sv_(at,cp)}
        function r(a){return [29,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sin(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][19],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[40],a$1)];
            default:return error_uniop(_eh_,a)}}
        function fd(a){return sin(a)}
        function df(cp,ap,at){return _sv_(at,cos(ap))}
        function r(a){return [30,a]}
        return op_d_d(a,ff,fd,df,r)}
      function cos(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][20],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[41],a$1)];
            default:return error_uniop(_ei_,a)}}
        function fd(a){return cos(a)}
        function df(cp,ap,at){return neg(_sv_(at,sin(ap)))}
        function r(a){return [31,a]}
        return op_d_d(a,ff,fd,df,r)}
      function tan(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][21],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[42],a$1)];
            default:return error_uniop(_ej_,a)}}
        function fd(a){return tan(a)}
        function df(cp,ap,at){return _sw_(at,sqr(cos(ap)))}
        function r(a){return [32,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sinh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][22],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[43],a$1)];
            default:return error_uniop(_ek_,a)}}
        function fd(a){return sinh(a)}
        function df(cp,ap,at){return _sv_(at,cosh(ap))}
        function r(a){return [33,a]}
        return op_d_d(a,ff,fd,df,r)}
      function cosh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][23],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[44],a$1)];
            default:return error_uniop(_el_,a)}}
        function fd(a){return cosh(a)}
        function df(cp,ap,at){return _sv_(at,sinh(ap))}
        function r(a){return [34,a]}
        return op_d_d(a,ff,fd,df,r)}
      function tanh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][24],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[45],a$1)];
            default:return error_uniop(_em_,a)}}
        function fd(a){return tanh(a)}
        function df(cp,ap,at){return _sw_(at,sqr(cosh(ap)))}
        function r(a){return [35,a]}
        return op_d_d(a,ff,fd,df,r)}
      function asin(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][25],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[46],a$1)];
            default:return error_uniop(_en_,a)}}
        function fd(a){return asin(a)}
        function df(cp,ap,at){return _sw_(at,sqrt(_su_(_eo_,sqr(ap))))}
        function r(a){return [36,a]}
        return op_d_d(a,ff,fd,df,r)}
      function acos(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][26],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[47],a$1)];
            default:return error_uniop(_ep_,a)}}
        function fd(a){return acos(a)}
        function df(cp,ap,at)
         {var _v__=sqrt(_su_(_eq_,sqr(ap)));return _sw_(neg(at),_v__)}
        function r(a){return [37,a]}
        return op_d_d(a,ff,fd,df,r)}
      function atan(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][27],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[48],a$1)];
            default:return error_uniop(_er_,a)}}
        function fd(a){return atan(a)}
        function df(cp,ap,at){return _sw_(at,_st_(_es_,sqr(ap)))}
        function r(a){return [38,a]}
        return op_d_d(a,ff,fd,df,r)}
      function asinh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][28],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[49],a$1)];
            default:return error_uniop(_et_,a)}}
        function fd(a){return asinh(a)}
        function df(cp,ap,at){return _sw_(at,sqrt(_st_(sqr(ap),_eu_)))}
        function r(a){return [39,a]}
        return op_d_d(a,ff,fd,df,r)}
      function acosh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][29],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[50],a$1)];
            default:return error_uniop(_ev_,a)}}
        function fd(a){return acosh(a)}
        function df(cp,ap,at){return _sw_(at,sqrt(_su_(sqr(ap),_ew_)))}
        function r(a){return [40,a]}
        return op_d_d(a,ff,fd,df,r)}
      function atanh(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][30],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[51],a$1)];
            default:return error_uniop(_ex_,a)}}
        function fd(a){return atanh(a)}
        function df(cp,ap,at){return _sw_(at,_su_(_ey_,sqr(ap)))}
        function r(a){return [41,a]}
        return op_d_d(a,ff,fd,df,r)}
      function get_item(a,i,j)
       {switch(a[0])
         {case 0:return error_uniop(_ez_,a);
          case 1:var ap=a[1];return [0,caml_call2(A[12],ap,[0,i,j])];
          case 2:
           var ai=a[3],at=a[2],ap$0=a[1],_v9_=get_item(at,i,j);
           return [2,get_item(ap$0,i,j),_v9_,ai];
          default:
           var ai$0=a[5],ap$1=a[1];
           return [3,get_item(ap$1,i,j),[0,_eA_],[42,a,i,j],[0,0],ai$0]}}
      function set_item(a,i,j,b)
       {function ff(a,match)
         {if(1 === a[0])
           if(0 === match[0])
            {var b=match[1],a$0=a[1],aa=caml_call1(A[16],a$0);
             caml_call3(A[13],aa,[0,i,j],b);
             return [1,aa]}
          return error_uniop(_eB_,a)}
        function fd(a,b){return set_item(a,i,j,b)}
        function df_da(cp,ap,at){return set_item(at,i,j,_eC_)}
        function df_db(cp,bp,bt){return add_item(zero(a),i,j,bt)}
        function df_dab(cp,ap,at,bp,bt){return set_item(at,i,j,bt)}
        function r_d_d(a,b){return [43,a,i,j,b]}
        function r_d_c(a,b){return [44,a,i,j,b]}
        function r_c_d(a,b){return [45,a,i,j,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function add_item(a,i,j,b)
       {function ff(a,match)
         {if(1 === a[0])
           if(0 === match[0])
            {var
              b=match[1],
              a$0=a[1],
              aa=caml_call1(A[16],a$0),
              _v7_=caml_call2(A[12],aa,[0,i,j]),
              _v8_=caml_call2(A[145][1],_v7_,b);
             caml_call3(A[13],aa,[0,i,j],_v8_);
             return [1,aa]}
          return error_binop(_eD_,a,match)}
        function fd(a,b){return add_item(a,i,j,b)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return add_item(zero(a),i,j,bt)}
        function df_dab(cp,ap,at,bp,bt){return add_item(at,i,j,bt)}
        function r_d_d(a,b){return [46,a,i,j,b]}
        function r_d_c(a,b){return [47,a,i,j,b]}
        function r_c_d(a,b){return [48,a,i,j,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function get_slice(i,a)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call2(A[14],i,a$0)]}
          return error_uniop(_eE_,a)}
        function fd(a){return get_slice(i,a)}
        function df(cp,ap,at){return get_slice(i,at)}
        function r(a){return [49,a,i]}
        return op_d_d(a,ff,fd,df,r)}
      function set_slice(i,a,b)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1],a$1=caml_call1(A[16],a$0);
             caml_call3(A[15],i,a$1,b);
             return [1,a$1]}
          return error_binop(_eF_,a,match)}
        function fd(a,b){return set_slice(i,a,b)}
        function df_da(cp,ap,at){return set_slice(i,at,zero(b))}
        function df_db(cp,bp,bt){return set_slice(i,zero(a),bt)}
        function df_dab(cp,ap,at,bp,bt){return set_slice(i,at,bt)}
        function r_d_d(a,b){return [50,a,b,i]}
        function r_d_c(a,b){return [51,a,b,i]}
        function r_c_d(a,b){return [52,a,b,i]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function sum(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,a$0];
            case 1:var a$1=param[1];return [0,caml_call1(A[59],a$1)];
            default:return error_uniop(_eG_,a)}}
        function fd(a){return sum(a)}
        function df(cp,ap,at){return sum(at)}
        function r(a){return [53,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sum$0(opt,a)
       {if(opt)var sth=opt[1],axis=sth;else var axis=0;
        function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,a$0];
            case 1:var a$1=param[1];return [1,caml_call2(A[52],[0,axis],a$1)];
            default:return error_uniop(_eH_,a)}}
        function fd(a){return sum$0([0,axis],a)}
        function df(cp,ap,at){return sum$0([0,axis],at)}
        function r(a){return [54,a,axis]}
        return op_d_d(a,ff,fd,df,r)}
      function mean(a){var _v6_=[0,numel(a)];return _sw_(sum(a),_v6_)}
      function dot(a,b)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1];return [1,caml_call2(A[110],a$0,b)]}
          return error_binop(_eI_,a,match)}
        function fd(a,b){return _sy_(a,b)}
        function df_da(cp,ap,at){return _sy_(at,b)}
        function df_db(cp,bp,bt){return _sy_(a,bt)}
        function df_dab(cp,ap,at,bp,bt)
         {var _v5_=_sy_(at,bp);return _st_(_sy_(ap,bt),_v5_)}
        function r_d_d(a,b){return [55,a,b]}
        function r_d_c(a,b){return [56,a,b]}
        function r_c_d(a,b){return [57,a,b]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function _sy_(a,b){return dot(a,b)}
      function transpose(a)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call2(A[113],0,a$0)]}
          return error_uniop(_eJ_,a)}
        function fd(a){return transpose(a)}
        function df(cp,ap,at){return transpose(at)}
        function r(a){return [58,a]}
        return op_d_d(a,ff,fd,df,r)}
      function l1norm(a)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [0,caml_call1(A[60],a$0)]}
          return error_uniop(_eK_,a)}
        function fd(a){return l1norm(a)}
        function df(cp,ap,at){return _sv_(at,signum(ap))}
        function r(a){return [59,a]}
        return op_d_d(a,ff,fd,df,r)}
      function l2norm(a)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [0,caml_call1(A[61],a$0)]}
          return error_uniop(_eL_,a)}
        function fd(a){return l2norm(a)}
        function df(cp,ap,at){return _sw_(_sv_(ap,at),cp)}
        function r(a){return [60,a]}
        return op_d_d(a,ff,fd,df,r)}
      function l2norm_sqr(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][9],a$0)];
            case 1:var a$1=param[1];return [0,caml_call1(A[62],a$1)];
            default:return error_uniop(_eM_,a)}}
        function fd(a){return l2norm_sqr(a)}
        function df(cp,ap,at){return _sv_(_eN_,_sv_(ap,at))}
        function r(a){return [61,a]}
        return op_d_d(a,ff,fd,df,r)}
      function sigmoid(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][32],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[55],a$1)];
            default:return error_uniop(_eO_,a)}}
        function fd(a){return sigmoid(a)}
        function df(cp,ap,at)
         {var _v4_=_su_(_eP_,cp);return _sv_(_sv_(at,cp),_v4_)}
        function r(a){return [62,a]}
        return op_d_d(a,ff,fd,df,r)}
      function relu(a)
       {function ff(param)
         {switch(param[0])
           {case 0:var a$0=param[1];return [0,caml_call1(A[145][31],a$0)];
            case 1:var a$1=param[1];return [1,caml_call1(A[56],a$1)];
            default:return error_uniop(_eQ_,a)}}
        function fd(a){return relu(a)}
        function df(cp,ap,at)
         {return _sw_(_sv_(at,_st_(_eS_,signum(ap))),_eR_)}
        function r(a){return [63,a]}
        return op_d_d(a,ff,fd,df,r)}
      function inv(a)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call1(A[111],a$0)]}
          return error_uniop(_eT_,a)}
        function fd(a){return inv(a)}
        function df(cp,ap,at){return _sv_(_sv_(neg(cp),at),cp)}
        function r(a){return [64,a]}
        return op_d_d(a,ff,fd,df,r)}
      function softplus(x){return log(_st_(_eU_,exp(x)))}
      function softsign(x){return _sw_(x,_st_(_eV_,abs(x)))}
      function softmax(x)
       {var
         _v3_=unpack_arr(x),
         c=[0,caml_call1(A[58],_v3_)],
         y=exp(_su_(x,c)),
         a=sum(y);
        return _sw_(y,a)}
      function cross_entropy(x,y){return neg(sum(_sv_(x,log(y))))}
      function add_row(a,b,i)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var
              b=match[1],
              a$0=a[1],
              _v1_=caml_call2(A[106],a$0,i),
              _v2_=caml_call2(A[71],_v1_,b);
             caml_call3(A[108],_v2_,a$0,i);
             return [1,a$0]}
          return error_binop(_eW_,a,match)}
        function fd(a,b){return add_row(a,b,i)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return add_row(zero(a),bt,i)}
        function df_dab(cp,ap,at,bp,bt){return add_row(at,bt,i)}
        function r_d_d(a,b){return [65,a,b,i]}
        function r_d_c(a,b){return [66,a,b,i]}
        function r_c_d(a,b){return [67,a,b,i]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function get_row(a,i)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1],_v0_=caml_call2(A[106],a$0,i);
            return [1,caml_call1(A[16],_v0_)]}
          return error_uniop(_eX_,a)}
        function fd(a){return get_row(a,i)}
        function df(cp,ap,at){return get_row(at,i)}
        function r(a){return [68,a,i]}
        return op_d_d(a,ff,fd,df,r)}
      function to_rows(a)
       {function _vZ_(i){return get_row(a,i)}return init(row_num(a),_vZ_)}
      function of_rows(a)
       {var match=caml_check_bound(a,0)[1];
        switch(match[0])
         {case 0:return error_uniop(_eY_,caml_check_bound(a,0)[1]);
          case 1:
           var _vV_=map$0(unpack_arr,a);return [1,caml_call1(A[115],_vV_)];
          case 2:
           var
            ai=match[3],
            _vW_=map$0(function(x){return unpack_arr(primal(x))},a),
            ap=[1,caml_call1(A[115],_vW_)],
            _vX_=map$0(function(x){return unpack_arr(adjval(x))},a),
            at=[1,caml_call1(A[115],_vX_)];
           return [2,ap,at,ai];
          default:
           var
            ai$0=match[5],
            ap$0=map$0(function(x){return primal(x)},a),
            _vY_=map$0(function(x){return unpack_arr(x)},ap$0),
            cp=[1,caml_call1(A[115],_vY_)];
           return [3,cp,[0,zero(cp)],[69,a],[0,0],ai$0]}}
      function conv1d(padding,a,b,s)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1];
             return [1,caml_call4(A[83],padding,a$0,b,s)]}
          return error_binop(_eZ_,a,match)}
        function fd(a,b){return conv1d(padding,a,b,s)}
        function df_da(cp,ap,at){return failwith(_e0_)}
        function df_db(cp,bp,bt){return failwith(_e1_)}
        function df_dab(cp,ap,at,bp,bt){return failwith(_e2_)}
        function r_d_d(a,b){return [73,a,b,s]}
        function r_d_c(a,b){return [74,a,b,s]}
        function r_c_d(a,b){return [75,a,b,s]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function conv1d_backward_input(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[92],a$0,b$0,s,o$0)]}
      function conv1d_backward_kernel(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[93],a$0,b$0,s,o$0)]}
      function conv2d(padding,a,b,s)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1];
             return [1,caml_call4(A[84],padding,a$0,b,s)]}
          return error_binop(_e3_,a,match)}
        function fd(a,b){return conv2d(padding,a,b,s)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return bt}
        function df_dab(cp,ap,at,bp,bt){return _st_(at,bt)}
        function r_d_d(a,b){return [76,a,b,s]}
        function r_d_c(a,b){return [77,a,b,s]}
        function r_c_d(a,b){return [78,a,b,s]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function conv2d_backward_input(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[94],a$0,b$0,s,o$0)]}
      function conv2d_backward_kernel(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[95],a$0,b$0,s,o$0)]}
      function conv3d(padding,a,b,s)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1];
             return [1,caml_call4(A[85],padding,a$0,b,s)]}
          return error_binop(_e4_,a,match)}
        function fd(a,b){return conv3d(padding,a,b,s)}
        function df_da(cp,ap,at){return at}
        function df_db(cp,bp,bt){return bt}
        function df_dab(cp,ap,at,bp,bt){return _st_(at,bt)}
        function r_d_d(a,b){return [79,a,b,s]}
        function r_d_c(a,b){return [80,a,b,s]}
        function r_c_d(a,b){return [81,a,b,s]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function conv3d_backward_input(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[96],a$0,b$0,s,o$0)]}
      function conv3d_backward_kernel(a,b,s,o)
       {var a$0=unpack_arr(a),b$0=unpack_arr(b),o$0=unpack_arr(o);
        return [1,caml_call4(A[97],a$0,b$0,s,o$0)]}
      function reshape(a,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call2(A[18],a$0,s)]}
          return error_uniop(_e5_,a)}
        function fd(a){return reshape(a,s)}
        function df(cp,ap,at){return reshape(at,s)}
        function r(a){return [82,a]}
        return op_d_d(a,ff,fd,df,r)}
      function flatten(a){return reshape(a,[0,1,numel(a)])}
      function max_pool1d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[86],[0,padding],a$0,b,s)]}
          return error_uniop(_e6_,a)}
        function fd(a){return max_pool1d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_e7_)}
        function r(a){return [83,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function max_pool1d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[98],p,a$0,b,s,o$0)]}
      function max_pool2d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[87],[0,padding],a$0,b,s)]}
          return error_uniop(_e8_,a)}
        function fd(a){return max_pool2d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_e9_)}
        function r(a){return [84,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function max_pool2d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[99],p,a$0,b,s,o$0)]}
      function max_pool3d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[88],[0,padding],a$0,b,s)]}
          return error_uniop(_e__,a)}
        function fd(a){return max_pool3d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_e$_)}
        function r(a){return [85,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function max_pool3d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[100],p,a$0,b,s,o$0)]}
      function avg_pool1d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[89],[0,padding],a$0,b,s)]}
          return error_uniop(_fa_,a)}
        function fd(a){return avg_pool1d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_fb_)}
        function r(a){return [86,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function avg_pool1d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[101],p,a$0,b,s,o$0)]}
      function avg_pool2d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[90],[0,padding],a$0,b,s)]}
          return error_uniop(_fc_,a)}
        function fd(a){return avg_pool2d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_fd_)}
        function r(a){return [87,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function avg_pool2d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[102],p,a$0,b,s,o$0)]}
      function avg_pool3d(padding,a,b,s)
       {function ff(param)
         {if(1 === param[0])
           {var a$0=param[1];return [1,caml_call4(A[91],[0,padding],a$0,b,s)]}
          return error_uniop(_fe_,a)}
        function fd(a){return avg_pool3d(padding,a,b,s)}
        function df(cp,ap,at){return failwith(_ff_)}
        function r(a){return [88,a,padding,b,s]}
        return op_d_d(a,ff,fd,df,r)}
      function avg_pool3d_backward(p,a,b,s,o)
       {var a$0=unpack_arr(a),o$0=unpack_arr(o);
        return [1,caml_call5(A[103],p,a$0,b,s,o$0)]}
      function dropout(opt,a)
       {if(opt)var sth=opt[1],rate=sth;else var rate=0.5;
        var match=primal$0(a);
        if(1 === match[0])
         var
          a$0=match[1],
          _vU_=caml_call1(A[10],a$0),
          b=[1,caml_call2(A[8],[0,1 - rate],_vU_)];
        else
         var b=error_uniop(_fg_,a);
        return _sv_(a,b)}
      function concat(axis,a,b)
       {function ff(a,match)
         {if(1 === a[0])
           if(1 === match[0])
            {var b=match[1],a$0=a[1];
             return [1,caml_call2(A[22],[0,axis],[0,a$0,b])]}
          return error_binop(_fh_,a,match)}
        function fd(a,b){return concat(axis,a,b)}
        function df_da(cp,ap,at){return concat(axis,at,zero(b))}
        function df_db(cp,bp,bt){return concat(axis,zero(a),bt)}
        function df_dab(cp,ap,at,bp,bt){return concat(axis,at,bt)}
        function r_d_d(a,b){return [70,a,b,axis]}
        function r_d_c(a,b){return [71,a,b,axis]}
        function r_c_d(a,b){return [72,a,b,axis]}
        return op_d_d_d(a,b,ff,fd,df_da,df_db,df_dab,r_d_d,r_d_c,r_c_d)}
      function split(axis,parts,a)
       {if(1 === a[0])
         {var a$0=a[1],_vT_=caml_call3(A[23],[0,axis],parts,a$0);
          return map$0(function(x){return [1,x]},_vT_)}
        return error_uniop(_fi_,a)}
      var
       Maths=
        [0,
         noop,
         op_d_d,
         op_d_d_d,
         _st_,
         add,
         _su_,
         sub,
         _sv_,
         mul,
         _sw_,
         div,
         _sx_,
         pow,
         atan2,
         min2,
         max2,
         neg,
         abs,
         signum,
         floor,
         ceil,
         round,
         sqr,
         sqrt,
         log,
         log2,
         log10,
         exp,
         sin,
         cos,
         tan,
         sinh,
         cosh,
         tanh,
         asin,
         acos,
         atan,
         asinh,
         acosh,
         atanh,
         get_item,
         set_item,
         add_item,
         get_slice,
         set_slice,
         sum,
         sum$0,
         mean,
         _sy_,
         dot,
         transpose,
         l1norm,
         l2norm,
         l2norm_sqr,
         sigmoid,
         relu,
         inv,
         softplus,
         softsign,
         softmax,
         cross_entropy,
         add_row,
         get_row,
         to_rows,
         of_rows,
         conv1d,
         conv1d_backward_input,
         conv1d_backward_kernel,
         conv2d,
         conv2d_backward_input,
         conv2d_backward_kernel,
         conv3d,
         conv3d_backward_input,
         conv3d_backward_kernel,
         reshape,
         flatten,
         max_pool1d,
         max_pool1d_backward,
         max_pool2d,
         max_pool2d_backward,
         max_pool3d,
         max_pool3d_backward,
         avg_pool1d,
         avg_pool1d_backward,
         avg_pool2d,
         avg_pool2d_backward,
         avg_pool3d,
         avg_pool3d_backward,
         dropout,
         concat,
         split];
      function reverse_reset(x)
       {var xs$89=[0,x,0],xs=xs$89;
        for(;;)
         {if(xs)
           {var t=xs[2],x$0=xs[1];
            if(3 === x$0[0])
             {var af=x$0[4],ao=x$0[3],aa=x$0[2];
              aa[1] = reset_zero(aa[1]);
              af[1] = af[1] + 1 | 0;
              if(1 === af[1])
               if(typeof ao === "number")
                {var xs=t;continue}
               else
                {var _vS_=ao[0];
                 if(45 <= _vS_)
                  switch(_vS_)
                   {case 45:var b$12=ao[4],xs$45=[0,b$12,t],xs=xs$45;continue;
                    case 46:
                     var
                      b$13=ao[4],
                      a$38=ao[1],
                      xs$46=[0,a$38,[0,b$13,t]],
                      xs=xs$46;
                     continue;
                    case 47:var a$39=ao[1],xs$47=[0,a$39,t],xs=xs$47;continue;
                    case 48:var b$14=ao[4],xs$48=[0,b$14,t],xs=xs$48;continue;
                    case 49:var a$40=ao[1],xs$49=[0,a$40,t],xs=xs$49;continue;
                    case 50:
                     var
                      b$15=ao[2],
                      a$41=ao[1],
                      xs$50=[0,a$41,[0,b$15,t]],
                      xs=xs$50;
                     continue;
                    case 51:var a$42=ao[1],xs$51=[0,a$42,t],xs=xs$51;continue;
                    case 52:var b$16=ao[2],xs$52=[0,b$16,t],xs=xs$52;continue;
                    case 53:var a$43=ao[1],xs$53=[0,a$43,t],xs=xs$53;continue;
                    case 54:var a$44=ao[1],xs$54=[0,a$44,t],xs=xs$54;continue;
                    case 55:
                     var
                      b$17=ao[2],
                      a$45=ao[1],
                      xs$55=[0,a$45,[0,b$17,t]],
                      xs=xs$55;
                     continue;
                    case 56:var a$46=ao[1],xs$56=[0,a$46,t],xs=xs$56;continue;
                    case 57:var b$18=ao[2],xs$57=[0,b$18,t],xs=xs$57;continue;
                    case 58:var a$47=ao[1],xs$58=[0,a$47,t],xs=xs$58;continue;
                    case 59:var a$48=ao[1],xs$59=[0,a$48,t],xs=xs$59;continue;
                    case 60:var a$49=ao[1],xs$60=[0,a$49,t],xs=xs$60;continue;
                    case 61:var a$50=ao[1],xs$61=[0,a$50,t],xs=xs$61;continue;
                    case 62:var a$51=ao[1],xs$62=[0,a$51,t],xs=xs$62;continue;
                    case 63:var a$52=ao[1],xs$63=[0,a$52,t],xs=xs$63;continue;
                    case 64:var a$53=ao[1],xs$64=[0,a$53,t],xs=xs$64;continue;
                    case 65:
                     var
                      b$19=ao[2],
                      a$54=ao[1],
                      xs$65=[0,a$54,[0,b$19,t]],
                      xs=xs$65;
                     continue;
                    case 66:var a$55=ao[1],xs$66=[0,a$55,t],xs=xs$66;continue;
                    case 67:var b$20=ao[2],xs$67=[0,b$20,t],xs=xs$67;continue;
                    case 68:var a$56=ao[1],xs$68=[0,a$56,t],xs=xs$68;continue;
                    case 69:
                     var a$57=ao[1],xs$69=append(to_list(a$57),t),xs=xs$69;
                     continue;
                    case 70:
                     var
                      b$21=ao[2],
                      a$58=ao[1],
                      xs$70=[0,a$58,[0,b$21,t]],
                      xs=xs$70;
                     continue;
                    case 71:var a$59=ao[1],xs$71=[0,a$59,t],xs=xs$71;continue;
                    case 72:var b$22=ao[2],xs$72=[0,b$22,t],xs=xs$72;continue;
                    case 73:
                     var
                      b$23=ao[2],
                      a$60=ao[1],
                      xs$73=[0,a$60,[0,b$23,t]],
                      xs=xs$73;
                     continue;
                    case 74:var a$61=ao[1],xs$74=[0,a$61,t],xs=xs$74;continue;
                    case 75:var b$24=ao[2],xs$75=[0,b$24,t],xs=xs$75;continue;
                    case 76:
                     var
                      b$25=ao[2],
                      a$62=ao[1],
                      xs$76=[0,a$62,[0,b$25,t]],
                      xs=xs$76;
                     continue;
                    case 77:var a$63=ao[1],xs$77=[0,a$63,t],xs=xs$77;continue;
                    case 78:var b$26=ao[2],xs$78=[0,b$26,t],xs=xs$78;continue;
                    case 79:
                     var
                      b$27=ao[2],
                      a$64=ao[1],
                      xs$79=[0,a$64,[0,b$27,t]],
                      xs=xs$79;
                     continue;
                    case 80:var a$65=ao[1],xs$80=[0,a$65,t],xs=xs$80;continue;
                    case 81:var b$28=ao[2],xs$81=[0,b$28,t],xs=xs$81;continue;
                    case 82:var a$66=ao[1],xs$82=[0,a$66,t],xs=xs$82;continue;
                    case 83:var a$67=ao[1],xs$83=[0,a$67,t],xs=xs$83;continue;
                    case 84:var a$68=ao[1],xs$84=[0,a$68,t],xs=xs$84;continue;
                    case 85:var a$69=ao[1],xs$85=[0,a$69,t],xs=xs$85;continue;
                    case 86:var a$70=ao[1],xs$86=[0,a$70,t],xs=xs$86;continue;
                    case 87:var a$71=ao[1],xs$87=[0,a$71,t],xs=xs$87;continue;
                    default:var a$72=ao[1],xs$88=[0,a$72,t],xs=xs$88;continue}
                 switch(_vS_)
                  {case 0:
                    var b=ao[2],a=ao[1],xs$0=[0,a,[0,b,t]],xs=xs$0;continue;
                   case 1:var a$0=ao[1],xs$1=[0,a$0,t],xs=xs$1;continue;
                   case 2:var b$0=ao[2],xs$2=[0,b$0,t],xs=xs$2;continue;
                   case 3:
                    var b$1=ao[2],a$1=ao[1],xs$3=[0,a$1,[0,b$1,t]],xs=xs$3;
                    continue;
                   case 4:var a$2=ao[1],xs$4=[0,a$2,t],xs=xs$4;continue;
                   case 5:var b$2=ao[2],xs$5=[0,b$2,t],xs=xs$5;continue;
                   case 6:
                    var b$3=ao[2],a$3=ao[1],xs$6=[0,a$3,[0,b$3,t]],xs=xs$6;
                    continue;
                   case 7:var a$4=ao[1],xs$7=[0,a$4,t],xs=xs$7;continue;
                   case 8:var b$4=ao[2],xs$8=[0,b$4,t],xs=xs$8;continue;
                   case 9:
                    var b$5=ao[2],a$5=ao[1],xs$9=[0,a$5,[0,b$5,t]],xs=xs$9;
                    continue;
                   case 10:var a$6=ao[1],xs$10=[0,a$6,t],xs=xs$10;continue;
                   case 11:var b$6=ao[2],xs$11=[0,b$6,t],xs=xs$11;continue;
                   case 12:
                    var b$7=ao[2],a$7=ao[1],xs$12=[0,a$7,[0,b$7,t]],xs=xs$12;
                    continue;
                   case 13:var a$8=ao[1],xs$13=[0,a$8,t],xs=xs$13;continue;
                   case 14:var b$8=ao[2],xs$14=[0,b$8,t],xs=xs$14;continue;
                   case 15:
                    var b$9=ao[2],a$9=ao[1],xs$15=[0,a$9,[0,b$9,t]],xs=xs$15;
                    continue;
                   case 16:var a$10=ao[1],xs$16=[0,a$10,t],xs=xs$16;continue;
                   case 17:var b$10=ao[2],xs$17=[0,b$10,t],xs=xs$17;continue;
                   case 18:var a$11=ao[1],xs$18=[0,a$11,t],xs=xs$18;continue;
                   case 19:var a$12=ao[1],xs$19=[0,a$12,t],xs=xs$19;continue;
                   case 20:var a$13=ao[1],xs$20=[0,a$13,t],xs=xs$20;continue;
                   case 21:var a$14=ao[1],xs$21=[0,a$14,t],xs=xs$21;continue;
                   case 22:var a$15=ao[1],xs$22=[0,a$15,t],xs=xs$22;continue;
                   case 23:var a$16=ao[1],xs$23=[0,a$16,t],xs=xs$23;continue;
                   case 24:var a$17=ao[1],xs$24=[0,a$17,t],xs=xs$24;continue;
                   case 25:var a$18=ao[1],xs$25=[0,a$18,t],xs=xs$25;continue;
                   case 26:var a$19=ao[1],xs$26=[0,a$19,t],xs=xs$26;continue;
                   case 27:var a$20=ao[1],xs$27=[0,a$20,t],xs=xs$27;continue;
                   case 28:var a$21=ao[1],xs$28=[0,a$21,t],xs=xs$28;continue;
                   case 29:var a$22=ao[1],xs$29=[0,a$22,t],xs=xs$29;continue;
                   case 30:var a$23=ao[1],xs$30=[0,a$23,t],xs=xs$30;continue;
                   case 31:var a$24=ao[1],xs$31=[0,a$24,t],xs=xs$31;continue;
                   case 32:var a$25=ao[1],xs$32=[0,a$25,t],xs=xs$32;continue;
                   case 33:var a$26=ao[1],xs$33=[0,a$26,t],xs=xs$33;continue;
                   case 34:var a$27=ao[1],xs$34=[0,a$27,t],xs=xs$34;continue;
                   case 35:var a$28=ao[1],xs$35=[0,a$28,t],xs=xs$35;continue;
                   case 36:var a$29=ao[1],xs$36=[0,a$29,t],xs=xs$36;continue;
                   case 37:var a$30=ao[1],xs$37=[0,a$30,t],xs=xs$37;continue;
                   case 38:var a$31=ao[1],xs$38=[0,a$31,t],xs=xs$38;continue;
                   case 39:var a$32=ao[1],xs$39=[0,a$32,t],xs=xs$39;continue;
                   case 40:var a$33=ao[1],xs$40=[0,a$33,t],xs=xs$40;continue;
                   case 41:var a$34=ao[1],xs$41=[0,a$34,t],xs=xs$41;continue;
                   case 42:var a$35=ao[1],xs$42=[0,a$35,t],xs=xs$42;continue;
                   case 43:
                    var
                     b$11=ao[4],
                     a$36=ao[1],
                     xs$43=[0,a$36,[0,b$11,t]],
                     xs=xs$43;
                    continue;
                   default:var a$37=ao[1],xs$44=[0,a$37,t],xs=xs$44;continue}}
              var xs=t;
              continue}
            var xs=t;
            continue}
          return 0}}
      function reverse_push(v,x)
       {var xs$89=[0,[0,v,x],0],xs=xs$89;
        for(;;)
         {if(xs)
           {var t=xs[2],match$0=xs[1],x$0=match$0[2],v$2=match$0[1];
            if(3 === x$0[0])
             {var af=x$0[4],ao=x$0[3],aa=x$0[2],ap=x$0[1],_s__=aa[1];
              switch(_s__[0])
               {case 0:
                 if(1 === v$2[0])
                  var v$0=v$2[1],v$3=[0,caml_call1(A[59],v$0)],switch$0=1;
                 else
                  var switch$0=0;
                 break;
                case 1:
                 if(1 === v$2[0])
                  {var
                    v$1=v$2[1],
                    a=_s__[1],
                    _s9_=caml_call1(A[10],v$1),
                    match=caml_equal(caml_call1(A[10],a),_s9_);
                   if(0 === match)
                    var v$3=[1,caml_call2(A[53],0,v$1)],switch$0=1;
                   else
                    var v$3=[1,v$1],switch$0=1}
                 else
                  var switch$0=0;
                 break;
                default:var switch$0=0}
              if(!switch$0)var v$3=v$2;
              aa[1] = caml_call2(Maths[4],aa[1],v$3);
              af[1] = af[1] - 1 | 0;
              if(0 === af[1])
               if(typeof ao === "number")
                {var xs=t;continue}
               else
                {var _vR_=ao[0];
                 if(45 <= _vR_)
                  switch(_vR_)
                   {case 45:
                     var
                      b$16=ao[4],
                      j$2=ao[3],
                      i$2=ao[2],
                      xs$45=[0,[0,caml_call3(Maths[41],aa[1],i$2,j$2),b$16],t],
                      xs=xs$45;
                     continue;
                    case 46:
                     var
                      b$17=ao[4],
                      j$3=ao[3],
                      i$3=ao[2],
                      a$43=ao[1],
                      _uT_=[0,[0,caml_call3(Maths[41],aa[1],i$3,j$3),b$17],t],
                      xs$46=[0,[0,aa[1],a$43],_uT_],
                      xs=xs$46;
                     continue;
                    case 47:
                     var a$44=ao[1],xs$47=[0,[0,aa[1],a$44],t],xs=xs$47;continue;
                    case 48:
                     var
                      b$18=ao[4],
                      j$4=ao[3],
                      i$4=ao[2],
                      xs$48=[0,[0,caml_call3(Maths[41],aa[1],i$4,j$4),b$18],t],
                      xs=xs$48;
                     continue;
                    case 49:
                     var
                      i$5=ao[2],
                      a$45=ao[1],
                      _uU_=aa[1],
                      _uV_=zero(a$45),
                      xs$49=[0,[0,caml_call3(Maths[45],i$5,_uV_,_uU_),a$45],t],
                      xs=xs$49;
                     continue;
                    case 50:
                     var
                      i$6=ao[3],
                      b$19=ao[2],
                      a$46=ao[1],
                      _uW_=[0,[0,caml_call2(Maths[44],i$6,aa[1]),b$19],t],
                      _uX_=zero(b$19),
                      xs$50=[0,[0,caml_call3(Maths[45],i$6,aa[1],_uX_),a$46],_uW_],
                      xs=xs$50;
                     continue;
                    case 51:
                     var
                      i$7=ao[3],
                      b$20=ao[2],
                      a$47=ao[1],
                      _uY_=zero(b$20),
                      xs$51=[0,[0,caml_call3(Maths[45],i$7,aa[1],_uY_),a$47],t],
                      xs=xs$51;
                     continue;
                    case 52:
                     var
                      i$8=ao[3],
                      b$21=ao[2],
                      xs$52=[0,[0,caml_call2(Maths[44],i$8,aa[1]),b$21],t],
                      xs=xs$52;
                     continue;
                    case 53:
                     var a$48=ao[1],xs$53=[0,[0,aa[1],a$48],t],xs=xs$53;continue;
                    case 54:
                     var
                      i$9=ao[2],
                      a$49=ao[1],
                      _uZ_=caml_check_bound(shape(a$49),i$9)[i$9 + 1],
                      xs$54=[0,[0,repeat([0,i$9],aa[1],_uZ_),a$49],t],
                      xs=xs$54;
                     continue;
                    case 55:
                     var
                      b$22=ao[2],
                      a$50=ao[1],
                      _u0_=aa[1],
                      _u1_=primal(a$50),
                      _u2_=caml_call1(Maths[51],_u1_),
                      _u3_=[0,[0,caml_call2(Maths[50],_u2_,_u0_),b$22],t],
                      _u4_=primal(b$22),
                      _u5_=caml_call1(Maths[51],_u4_),
                      xs$55=[0,[0,caml_call2(Maths[50],aa[1],_u5_),a$50],_u3_],
                      xs=xs$55;
                     continue;
                    case 56:
                     var
                      b$23=ao[2],
                      a$51=ao[1],
                      _u6_=caml_call1(Maths[51],b$23),
                      xs$56=[0,[0,caml_call2(Maths[50],aa[1],_u6_),a$51],t],
                      xs=xs$56;
                     continue;
                    case 57:
                     var
                      b$24=ao[2],
                      a$52=ao[1],
                      _u7_=aa[1],
                      _u8_=caml_call1(Maths[51],a$52),
                      xs$57=[0,[0,caml_call2(Maths[50],_u8_,_u7_),b$24],t],
                      xs=xs$57;
                     continue;
                    case 58:
                     var
                      a$53=ao[1],
                      xs$58=[0,[0,caml_call1(Maths[51],aa[1]),a$53],t],
                      xs=xs$58;
                     continue;
                    case 59:
                     var
                      a$54=ao[1],
                      _u9_=primal(a$54),
                      _u__=caml_call1(Maths[19],_u9_),
                      xs$59=[0,[0,caml_call2(Maths[8],aa[1],_u__),a$54],t],
                      xs=xs$59;
                     continue;
                    case 60:
                     var
                      a$55=ao[1],
                      _u$_=primal(a$55),
                      _va_=caml_call2(Maths[10],aa[1],ap),
                      xs$60=[0,[0,caml_call2(Maths[8],_va_,_u$_),a$55],t],
                      xs=xs$60;
                     continue;
                    case 61:
                     var
                      a$56=ao[1],
                      _vb_=primal(a$56),
                      _vc_=caml_call2(Maths[8],aa[1],_fv_),
                      xs$61=[0,[0,caml_call2(Maths[8],_vc_,_vb_),a$56],t],
                      xs=xs$61;
                     continue;
                    case 62:
                     var
                      a$57=ao[1],
                      _vd_=caml_call2(Maths[6],_fw_,ap),
                      _ve_=caml_call2(Maths[8],aa[1],ap),
                      xs$62=[0,[0,caml_call2(Maths[8],_ve_,_vd_),a$57],t],
                      xs=xs$62;
                     continue;
                    case 63:
                     var
                      a$58=ao[1],
                      _vf_=primal(a$58),
                      _vg_=caml_call1(Maths[19],_vf_),
                      _vh_=caml_call2(Maths[4],_vg_,_fy_),
                      _vi_=caml_call2(Maths[10],_vh_,_fx_),
                      xs$63=[0,[0,caml_call2(Maths[8],aa[1],_vi_),a$58],t],
                      xs=xs$63;
                     continue;
                    case 64:
                     var
                      a$59=ao[1],
                      dpt=caml_call1(Maths[51],ap),
                      _vj_=aa[1],
                      _vk_=caml_call1(Maths[17],dpt),
                      _vl_=caml_call2(Maths[8],_vk_,_vj_),
                      xs$64=[0,[0,caml_call2(Maths[8],_vl_,dpt),a$59],t],
                      xs=xs$64;
                     continue;
                    case 65:
                     var
                      i$10=ao[3],
                      b$25=ao[2],
                      a$60=ao[1],
                      _vm_=[0,[0,caml_call2(Maths[63],aa[1],i$10),b$25],t],
                      xs$65=[0,[0,aa[1],a$60],_vm_],
                      xs=xs$65;
                     continue;
                    case 66:
                     var a$61=ao[1],xs$66=[0,[0,aa[1],a$61],t],xs=xs$66;continue;
                    case 67:
                     var
                      i$11=ao[3],
                      b$26=ao[2],
                      xs$67=[0,[0,caml_call2(Maths[63],aa[1],i$11),b$26],t],
                      xs=xs$67;
                     continue;
                    case 68:
                     var
                      i$12=ao[2],
                      a$62=ao[1],
                      _vn_=aa[1],
                      _vo_=adjval(a$62),
                      _vp_=caml_call3(Maths[62],_vo_,_vn_,i$12);
                     adjref(a$62)[1] = _vp_;
                     var xs$68=[0,[0,zero(a$62),a$62],t],xs=xs$68;
                     continue;
                    case 69:
                     var
                      a$63=ao[1],
                      _vq_=to_list(a$63),
                      xs$69=
                       append
                        (mapi
                          (function(aa)
                             {return function(i,v)
                               {return [0,caml_call2(Maths[63],aa[1],i),v]}}
                            (aa),
                           _vq_),
                         t),
                      xs=xs$69;
                     continue;
                    case 70:
                     var
                      i$13=ao[3],
                      b$27=ao[2],
                      a$64=ao[1],
                      _vr_=aa[1],
                      _vs_=caml_check_bound(shape(b$27),i$13)[i$13 + 1],
                      _vt_=[0,caml_check_bound(shape(a$64),i$13)[i$13 + 1],_vs_],
                      s=caml_call3(Maths[91],i$13,_vt_,_vr_),
                      _vu_=[0,[0,caml_check_bound(s,1)[2],b$27],t],
                      xs$70=[0,[0,caml_check_bound(s,0)[1],a$64],_vu_],
                      xs=xs$70;
                     continue;
                    case 71:
                     var
                      i$14=ao[3],
                      b$28=ao[2],
                      a$65=ao[1],
                      _vv_=aa[1],
                      _vw_=caml_check_bound(shape(b$28),i$14)[i$14 + 1],
                      _vx_=[0,caml_check_bound(shape(a$65),i$14)[i$14 + 1],_vw_],
                      s$0=caml_call3(Maths[91],i$14,_vx_,_vv_),
                      xs$71=[0,[0,caml_check_bound(s$0,0)[1],a$65],t],
                      xs=xs$71;
                     continue;
                    case 72:
                     var
                      i$15=ao[3],
                      b$29=ao[2],
                      a$66=ao[1],
                      _vy_=aa[1],
                      _vz_=caml_check_bound(shape(b$29),i$15)[i$15 + 1],
                      _vA_=[0,caml_check_bound(shape(a$66),i$15)[i$15 + 1],_vz_],
                      s$1=caml_call3(Maths[91],i$15,_vA_,_vy_),
                      xs$72=[0,[0,caml_check_bound(s$1,1)[2],b$29],t],
                      xs=xs$72;
                     continue;
                    case 73:
                     var
                      s$2=ao[3],
                      b$30=ao[2],
                      a$67=ao[1],
                      _vB_=
                       [0,[0,caml_call4(Maths[68],a$67,b$30,s$2,aa[1]),b$30],t],
                      xs$73=
                       [0,[0,caml_call4(Maths[67],a$67,b$30,s$2,aa[1]),a$67],_vB_],
                      xs=xs$73;
                     continue;
                    case 74:
                     var
                      s$3=ao[3],
                      b$31=ao[2],
                      a$68=ao[1],
                      xs$74=
                       [0,[0,caml_call4(Maths[67],a$68,b$31,s$3,aa[1]),a$68],t],
                      xs=xs$74;
                     continue;
                    case 75:
                     var
                      s$4=ao[3],
                      b$32=ao[2],
                      a$69=ao[1],
                      xs$75=
                       [0,[0,caml_call4(Maths[68],a$69,b$32,s$4,aa[1]),b$32],t],
                      xs=xs$75;
                     continue;
                    case 76:
                     var
                      s$5=ao[3],
                      b$33=ao[2],
                      a$70=ao[1],
                      _vC_=
                       [0,[0,caml_call4(Maths[71],a$70,b$33,s$5,aa[1]),b$33],t],
                      xs$76=
                       [0,[0,caml_call4(Maths[70],a$70,b$33,s$5,aa[1]),a$70],_vC_],
                      xs=xs$76;
                     continue;
                    case 77:
                     var
                      s$6=ao[3],
                      b$34=ao[2],
                      a$71=ao[1],
                      xs$77=
                       [0,[0,caml_call4(Maths[70],a$71,b$34,s$6,aa[1]),a$71],t],
                      xs=xs$77;
                     continue;
                    case 78:
                     var
                      s$7=ao[3],
                      b$35=ao[2],
                      a$72=ao[1],
                      xs$78=
                       [0,[0,caml_call4(Maths[71],a$72,b$35,s$7,aa[1]),b$35],t],
                      xs=xs$78;
                     continue;
                    case 79:
                     var
                      s$8=ao[3],
                      b$36=ao[2],
                      a$73=ao[1],
                      _vD_=
                       [0,[0,caml_call4(Maths[74],a$73,b$36,s$8,aa[1]),b$36],t],
                      xs$79=
                       [0,[0,caml_call4(Maths[73],a$73,b$36,s$8,aa[1]),a$73],_vD_],
                      xs=xs$79;
                     continue;
                    case 80:
                     var
                      s$9=ao[3],
                      b$37=ao[2],
                      a$74=ao[1],
                      xs$80=
                       [0,[0,caml_call4(Maths[73],a$74,b$37,s$9,aa[1]),a$74],t],
                      xs=xs$80;
                     continue;
                    case 81:
                     var
                      s$10=ao[3],
                      b$38=ao[2],
                      a$75=ao[1],
                      xs$81=
                       [0,[0,caml_call4(Maths[74],a$75,b$38,s$10,aa[1]),b$38],t],
                      xs=xs$81;
                     continue;
                    case 82:
                     var
                      a$76=ao[1],
                      _vE_=shape(primal(a$76)),
                      xs$82=[0,[0,caml_call2(Maths[75],aa[1],_vE_),a$76],t],
                      xs=xs$82;
                     continue;
                    case 83:
                     var
                      s$11=ao[4],
                      d$0=ao[3],
                      p=ao[2],
                      a$77=ao[1],
                      _vF_=aa[1],
                      _vG_=primal(a$77),
                      xs$83=
                       [0,[0,caml_call5(Maths[78],p,_vG_,d$0,s$11,_vF_),a$77],t],
                      xs=xs$83;
                     continue;
                    case 84:
                     var
                      s$12=ao[4],
                      d$1=ao[3],
                      p$0=ao[2],
                      a$78=ao[1],
                      _vH_=aa[1],
                      _vI_=primal(a$78),
                      xs$84=
                       [0,[0,caml_call5(Maths[80],p$0,_vI_,d$1,s$12,_vH_),a$78],t],
                      xs=xs$84;
                     continue;
                    case 85:
                     var
                      s$13=ao[4],
                      d$2=ao[3],
                      p$1=ao[2],
                      a$79=ao[1],
                      _vJ_=aa[1],
                      _vK_=primal(a$79),
                      xs$85=
                       [0,[0,caml_call5(Maths[82],p$1,_vK_,d$2,s$13,_vJ_),a$79],t],
                      xs=xs$85;
                     continue;
                    case 86:
                     var
                      s$14=ao[4],
                      d$3=ao[3],
                      p$2=ao[2],
                      a$80=ao[1],
                      _vL_=aa[1],
                      _vM_=primal(a$80),
                      xs$86=
                       [0,[0,caml_call5(Maths[84],p$2,_vM_,d$3,s$14,_vL_),a$80],t],
                      xs=xs$86;
                     continue;
                    case 87:
                     var
                      s$15=ao[4],
                      d$4=ao[3],
                      p$3=ao[2],
                      a$81=ao[1],
                      _vN_=aa[1],
                      _vO_=primal(a$81),
                      xs$87=
                       [0,[0,caml_call5(Maths[86],p$3,_vO_,d$4,s$15,_vN_),a$81],t],
                      xs=xs$87;
                     continue;
                    default:
                     var
                      s$16=ao[4],
                      d$5=ao[3],
                      p$4=ao[2],
                      a$82=ao[1],
                      _vP_=aa[1],
                      _vQ_=primal(a$82),
                      xs$88=
                       [0,[0,caml_call5(Maths[88],p$4,_vQ_,d$5,s$16,_vP_),a$82],t],
                      xs=xs$88;
                     continue}
                 switch(_vR_)
                  {case 0:
                    var
                     b=ao[2],
                     a$0=ao[1],
                     xs$0=[0,[0,aa[1],a$0],[0,[0,aa[1],b],t]],
                     xs=xs$0;
                    continue;
                   case 1:
                    var a$1=ao[1],xs$1=[0,[0,aa[1],a$1],t],xs=xs$1;continue;
                   case 2:
                    var b$0=ao[2],xs$2=[0,[0,aa[1],b$0],t],xs=xs$2;continue;
                   case 3:
                    var
                     b$1=ao[2],
                     a$2=ao[1],
                     _s$_=[0,[0,caml_call1(Maths[17],aa[1]),b$1],t],
                     xs$3=[0,[0,aa[1],a$2],_s$_],
                     xs=xs$3;
                    continue;
                   case 4:
                    var a$3=ao[1],xs$4=[0,[0,aa[1],a$3],t],xs=xs$4;continue;
                   case 5:
                    var
                     b$2=ao[2],
                     xs$5=[0,[0,caml_call1(Maths[17],aa[1]),b$2],t],
                     xs=xs$5;
                    continue;
                   case 6:
                    var
                     b$3=ao[2],
                     a$4=ao[1],
                     _ta_=primal(a$4),
                     _tb_=[0,[0,caml_call2(Maths[8],aa[1],_ta_),b$3],t],
                     _tc_=primal(b$3),
                     xs$6=[0,[0,caml_call2(Maths[8],aa[1],_tc_),a$4],_tb_],
                     xs=xs$6;
                    continue;
                   case 7:
                    var
                     b$4=ao[2],
                     a$5=ao[1],
                     xs$7=[0,[0,caml_call2(Maths[8],aa[1],b$4),a$5],t],
                     xs=xs$7;
                    continue;
                   case 8:
                    var
                     b$5=ao[2],
                     a$6=ao[1],
                     xs$8=[0,[0,caml_call2(Maths[8],aa[1],a$6),b$5],t],
                     xs=xs$8;
                    continue;
                   case 9:
                    var
                     b$6=ao[2],
                     a$7=ao[1],
                     _td_=primal(b$6),
                     _te_=primal(b$6),
                     _tf_=caml_call2(Maths[8],_te_,_td_),
                     _tg_=primal(a$7),
                     _th_=caml_call1(Maths[17],_tg_),
                     _ti_=caml_call2(Maths[10],_th_,_tf_),
                     _tj_=[0,[0,caml_call2(Maths[8],aa[1],_ti_),b$6],t],
                     _tk_=primal(b$6),
                     xs$9=[0,[0,caml_call2(Maths[10],aa[1],_tk_),a$7],_tj_],
                     xs=xs$9;
                    continue;
                   case 10:
                    var
                     b$7=ao[2],
                     a$8=ao[1],
                     xs$10=[0,[0,caml_call2(Maths[10],aa[1],b$7),a$8],t],
                     xs=xs$10;
                    continue;
                   case 11:
                    var
                     b$8=ao[2],
                     a$9=ao[1],
                     _tl_=primal(b$8),
                     _tm_=primal(b$8),
                     _tn_=caml_call2(Maths[8],_tm_,_tl_),
                     _to_=caml_call1(Maths[17],a$9),
                     _tp_=caml_call2(Maths[10],_to_,_tn_),
                     xs$11=[0,[0,caml_call2(Maths[8],aa[1],_tp_),b$8],t],
                     xs=xs$11;
                    continue;
                   case 12:
                    var
                     b$9=ao[2],
                     a$10=ao[1],
                     _tq_=primal(a$10),
                     _tr_=caml_call1(Maths[25],_tq_),
                     _ts_=primal(b$9),
                     _tt_=primal(a$10),
                     _tu_=caml_call2(Maths[12],_tt_,_ts_),
                     _tv_=caml_call2(Maths[8],aa[1],_tu_),
                     _tw_=[0,[0,caml_call2(Maths[8],_tv_,_tr_),b$9],t],
                     _tx_=primal(b$9),
                     _ty_=primal(b$9),
                     _tz_=caml_call2(Maths[6],_ty_,_fj_),
                     _tA_=primal(a$10),
                     _tB_=caml_call2(Maths[12],_tA_,_tz_),
                     _tC_=caml_call2(Maths[8],aa[1],_tB_),
                     xs$12=[0,[0,caml_call2(Maths[8],_tC_,_tx_),a$10],_tw_],
                     xs=xs$12;
                    continue;
                   case 13:
                    var
                     b$10=ao[2],
                     a$11=ao[1],
                     _tD_=caml_call2(Maths[6],b$10,_fk_),
                     _tE_=primal(a$11),
                     _tF_=caml_call2(Maths[12],_tE_,_tD_),
                     _tG_=caml_call2(Maths[8],aa[1],_tF_),
                     xs$13=[0,[0,caml_call2(Maths[8],_tG_,b$10),a$11],t],
                     xs=xs$13;
                    continue;
                   case 14:
                    var
                     b$11=ao[2],
                     a$12=ao[1],
                     _tH_=caml_call1(Maths[25],a$12),
                     _tI_=primal(b$11),
                     _tJ_=caml_call2(Maths[12],a$12,_tI_),
                     _tK_=caml_call2(Maths[8],aa[1],_tJ_),
                     xs$14=[0,[0,caml_call2(Maths[8],_tK_,_tH_),b$11],t],
                     xs=xs$14;
                    continue;
                   case 15:
                    var
                     b$12=ao[2],
                     a$13=ao[1],
                     _tL_=primal(b$12),
                     _tM_=caml_call1(Maths[23],_tL_),
                     _tN_=primal(a$13),
                     _tO_=caml_call1(Maths[23],_tN_),
                     d=caml_call2(Maths[4],_tO_,_tM_),
                     _tP_=primal(a$13),
                     _tQ_=caml_call1(Maths[17],_tP_),
                     _tR_=caml_call2(Maths[8],aa[1],_tQ_),
                     _tS_=[0,[0,caml_call2(Maths[10],_tR_,d),b$12],t],
                     _tT_=primal(b$12),
                     _tU_=caml_call2(Maths[8],aa[1],_tT_),
                     xs$15=[0,[0,caml_call2(Maths[10],_tU_,d),a$13],_tS_],
                     xs=xs$15;
                    continue;
                   case 16:
                    var
                     b$13=ao[2],
                     a$14=ao[1],
                     _tV_=caml_call1(Maths[23],b$13),
                     _tW_=primal(a$14),
                     _tX_=caml_call1(Maths[23],_tW_),
                     _tY_=caml_call2(Maths[4],_tX_,_tV_),
                     _tZ_=caml_call2(Maths[8],aa[1],b$13),
                     xs$16=[0,[0,caml_call2(Maths[10],_tZ_,_tY_),a$14],t],
                     xs=xs$16;
                    continue;
                   case 17:
                    var
                     b$14=ao[2],
                     a$15=ao[1],
                     _t0_=primal(b$14),
                     _t1_=caml_call1(Maths[23],_t0_),
                     _t2_=caml_call1(Maths[23],a$15),
                     _t3_=caml_call2(Maths[4],_t2_,_t1_),
                     _t4_=caml_call1(Maths[17],a$15),
                     _t5_=caml_call2(Maths[8],aa[1],_t4_),
                     xs$17=[0,[0,caml_call2(Maths[10],_t5_,_t3_),b$14],t],
                     xs=xs$17;
                    continue;
                   case 18:
                    var
                     a$16=ao[1],
                     xs$18=[0,[0,caml_call1(Maths[17],aa[1]),a$16],t],
                     xs=xs$18;
                    continue;
                   case 19:
                    var
                     a$17=ao[1],
                     _t6_=primal(a$17),
                     _t7_=caml_call1(Maths[19],_t6_),
                     xs$19=[0,[0,caml_call2(Maths[8],aa[1],_t7_),a$17],t],
                     xs=xs$19;
                    continue;
                   case 20:
                    var a$18=ao[1],xs$20=[0,[0,zero(a$18),a$18],t],xs=xs$20;
                    continue;
                   case 21:
                    var a$19=ao[1],xs$21=[0,[0,zero(a$19),a$19],t],xs=xs$21;
                    continue;
                   case 22:
                    var a$20=ao[1],xs$22=[0,[0,zero(a$20),a$20],t],xs=xs$22;
                    continue;
                   case 23:
                    var a$21=ao[1],xs$23=[0,[0,zero(a$21),a$21],t],xs=xs$23;
                    continue;
                   case 24:
                    var
                     a$22=ao[1],
                     _t8_=primal(a$22),
                     _t9_=caml_call2(Maths[8],aa[1],_t8_),
                     xs$24=[0,[0,caml_call2(Maths[8],_t9_,_fl_),a$22],t],
                     xs=xs$24;
                    continue;
                   case 25:
                    var
                     a$23=ao[1],
                     _t__=caml_call2(Maths[8],_fm_,ap),
                     xs$25=[0,[0,caml_call2(Maths[10],aa[1],_t__),a$23],t],
                     xs=xs$25;
                    continue;
                   case 26:
                    var
                     a$24=ao[1],
                     _t$_=primal(a$24),
                     xs$26=[0,[0,caml_call2(Maths[10],aa[1],_t$_),a$24],t],
                     xs=xs$26;
                    continue;
                   case 27:
                    var
                     a$25=ao[1],
                     _ua_=primal(a$25),
                     _ub_=caml_call2(Maths[8],_ua_,[0,log2e]),
                     xs$27=[0,[0,caml_call2(Maths[10],aa[1],_ub_),a$25],t],
                     xs=xs$27;
                    continue;
                   case 28:
                    var
                     a$26=ao[1],
                     _uc_=primal(a$26),
                     _ud_=caml_call2(Maths[8],_uc_,[0,log10e]),
                     xs$28=[0,[0,caml_call2(Maths[10],aa[1],_ud_),a$26],t],
                     xs=xs$28;
                    continue;
                   case 29:
                    var
                     a$27=ao[1],
                     xs$29=[0,[0,caml_call2(Maths[8],aa[1],ap),a$27],t],
                     xs=xs$29;
                    continue;
                   case 30:
                    var
                     a$28=ao[1],
                     _ue_=primal(a$28),
                     _uf_=caml_call1(Maths[30],_ue_),
                     xs$30=[0,[0,caml_call2(Maths[8],aa[1],_uf_),a$28],t],
                     xs=xs$30;
                    continue;
                   case 31:
                    var
                     a$29=ao[1],
                     _ug_=primal(a$29),
                     _uh_=caml_call1(Maths[29],_ug_),
                     _ui_=caml_call1(Maths[17],_uh_),
                     xs$31=[0,[0,caml_call2(Maths[8],aa[1],_ui_),a$29],t],
                     xs=xs$31;
                    continue;
                   case 32:
                    var
                     a$30=ao[1],
                     _uj_=primal(a$30),
                     _uk_=caml_call1(Maths[30],_uj_),
                     _ul_=caml_call1(Maths[23],_uk_),
                     xs$32=[0,[0,caml_call2(Maths[10],aa[1],_ul_),a$30],t],
                     xs=xs$32;
                    continue;
                   case 33:
                    var
                     a$31=ao[1],
                     _um_=primal(a$31),
                     _un_=caml_call1(Maths[33],_um_),
                     xs$33=[0,[0,caml_call2(Maths[8],aa[1],_un_),a$31],t],
                     xs=xs$33;
                    continue;
                   case 34:
                    var
                     a$32=ao[1],
                     _uo_=primal(a$32),
                     _up_=caml_call1(Maths[32],_uo_),
                     xs$34=[0,[0,caml_call2(Maths[8],aa[1],_up_),a$32],t],
                     xs=xs$34;
                    continue;
                   case 35:
                    var
                     a$33=ao[1],
                     _uq_=primal(a$33),
                     _ur_=caml_call1(Maths[33],_uq_),
                     _us_=caml_call1(Maths[23],_ur_),
                     xs$35=[0,[0,caml_call2(Maths[10],aa[1],_us_),a$33],t],
                     xs=xs$35;
                    continue;
                   case 36:
                    var
                     a$34=ao[1],
                     _ut_=primal(a$34),
                     _uu_=caml_call1(Maths[23],_ut_),
                     _uv_=caml_call2(Maths[6],_fn_,_uu_),
                     _uw_=caml_call1(Maths[24],_uv_),
                     xs$36=[0,[0,caml_call2(Maths[10],aa[1],_uw_),a$34],t],
                     xs=xs$36;
                    continue;
                   case 37:
                    var
                     a$35=ao[1],
                     _ux_=primal(a$35),
                     _uy_=caml_call1(Maths[23],_ux_),
                     _uz_=caml_call2(Maths[6],_fo_,_uy_),
                     _uA_=caml_call1(Maths[24],_uz_),
                     _uB_=caml_call1(Maths[17],aa[1]),
                     xs$37=[0,[0,caml_call2(Maths[10],_uB_,_uA_),a$35],t],
                     xs=xs$37;
                    continue;
                   case 38:
                    var
                     a$36=ao[1],
                     _uC_=primal(a$36),
                     _uD_=caml_call1(Maths[23],_uC_),
                     _uE_=caml_call2(Maths[4],_fp_,_uD_),
                     xs$38=[0,[0,caml_call2(Maths[10],aa[1],_uE_),a$36],t],
                     xs=xs$38;
                    continue;
                   case 39:
                    var
                     a$37=ao[1],
                     _uF_=primal(a$37),
                     _uG_=caml_call1(Maths[23],_uF_),
                     _uH_=caml_call2(Maths[4],_uG_,_fq_),
                     _uI_=caml_call1(Maths[24],_uH_),
                     xs$39=[0,[0,caml_call2(Maths[10],aa[1],_uI_),a$37],t],
                     xs=xs$39;
                    continue;
                   case 40:
                    var
                     a$38=ao[1],
                     _uJ_=primal(a$38),
                     _uK_=caml_call1(Maths[23],_uJ_),
                     _uL_=caml_call2(Maths[6],_uK_,_fr_),
                     _uM_=caml_call1(Maths[24],_uL_),
                     xs$40=[0,[0,caml_call2(Maths[10],aa[1],_uM_),a$38],t],
                     xs=xs$40;
                    continue;
                   case 41:
                    var
                     a$39=ao[1],
                     _uN_=primal(a$39),
                     _uO_=caml_call1(Maths[23],_uN_),
                     _uP_=caml_call2(Maths[6],_fs_,_uO_),
                     xs$41=[0,[0,caml_call2(Maths[10],aa[1],_uP_),a$39],t],
                     xs=xs$41;
                    continue;
                   case 42:
                    var
                     j=ao[3],
                     i=ao[2],
                     a$40=ao[1],
                     _uQ_=caml_call1(Maths[46],aa[1]),
                     _uR_=zero(a$40),
                     xs$42=[0,[0,caml_call4(Maths[42],_uR_,i,j,_uQ_),a$40],t],
                     xs=xs$42;
                    continue;
                   case 43:
                    var
                     b$15=ao[4],
                     j$0=ao[3],
                     i$0=ao[2],
                     a$41=ao[1],
                     _uS_=[0,[0,caml_call3(Maths[41],aa[1],i$0,j$0),b$15],t],
                     xs$43=
                      [0,[0,caml_call4(Maths[42],aa[1],i$0,j$0,_ft_),a$41],_uS_],
                     xs=xs$43;
                    continue;
                   default:
                    var
                     j$1=ao[3],
                     i$1=ao[2],
                     a$42=ao[1],
                     xs$44=
                      [0,[0,caml_call4(Maths[42],aa[1],i$1,j$1,_fu_),a$42],t],
                     xs=xs$44;
                    continue}}
              var xs=t;
              continue}
            var xs=t;
            continue}
          return 0}}
      function reverse_prop(v,x){reverse_reset(x);return reverse_push(v,x)}
      function make_forward(p,t,i){return [2,p,t,i]}
      function make_reverse(p,i){return [3,p,[0,zero(p)],0,[0,0],i]}
      function diff(f,x)
       {var x$0=[2,x,_fz_,tag(0)],y=caml_call1(f,x$0),_s8_=tangent(y);
        return [0,primal(y),_s8_]}
      function diff$0(f,x){return diff(f,x)[2]}
      function grad(f,x)
       {var x$0=make_reverse(x,tag(0)),y=caml_call1(f,x$0);
        reverse_reset(y);
        reverse_push(_fA_,y);
        var _s7_=adjval(x$0);
        return [0,primal(y),_s7_]}
      function grad$0(f,x){return grad(f,x)[2]}
      function jacobianv(f,x,v)
       {var x$0=[2,x,v,tag(0)],y=caml_call1(f,x$0),_s6_=tangent(y);
        return [0,primal(y),_s6_]}
      function jacobianv$0(f,x,v){return jacobianv(f,x,v)[2]}
      function jacobianTv(f,x,v)
       {var x$0=make_reverse(x,tag(0)),y=caml_call1(f,x$0);
        reverse_reset(y);
        reverse_push(v,y);
        var _s5_=primal(adjval(x$0));
        return [0,primal(y),_s5_]}
      function jacobianTv$0(f,x,v){return jacobianTv(f,x,v)[2]}
      function jacobian(f,x)
       {var
         y=primal(caml_call1(f,x)),
         m=col_num(y),
         n=col_num(x),
         z=caml_call1(A[1],[0,m,n]),
         match=n < m?1:0;
        if(0 === match)
         {var
           _s2_=
            init
             (m,
              function(i)
               {var v=caml_call1(A[2],[0,1,m]);
                caml_call3(A[13],v,[0,0,i],1);
                return jacobianTv$0(f,x,[1,v])});
          iteri
           (function(i,v)
             {if(1 === v[0]){var v$0=v[1];return caml_call3(A[108],v$0,z,i)}
              return failwith(_fB_)},
            _s2_)}
        else
         {var
           _s3_=
            init
             (n,
              function(i)
               {var v=caml_call1(A[2],[0,1,n]);
                caml_call3(A[13],v,[0,0,i],1);
                return jacobianv$0(f,x,[1,v])});
          iteri
           (function(i,v)
             {if(1 === v[0])
               {var v$0=v[1],_s4_=caml_call2(A[113],0,v$0);
                return caml_call3(A[109],_s4_,z,i)}
              return failwith(_fC_)},
            _s3_)}
        return [0,y,[1,z]]}
      function jacobian$0(f,x){return jacobian(f,x)[2]}
      function gradhessian(f,x)
       {return jacobian(function(_s1_){return grad$0(f,_s1_)},x)}
      function gradhessian$0(f,x)
       {var match=gradhessian(f,x),h=match[2],g=match[1];
        return [0,caml_call1(f,x),g,h]}
      function hessian(f,x)
       {return jacobian$0(function(_s0_){return grad$0(f,_s0_)},x)}
      function hessian$0(f,x)
       {var _sZ_=hessian(f,x);return [0,caml_call1(f,x),_sZ_]}
      function gradhessianv(f,x,v)
       {var
         match=grad(function(y){return jacobianv$0(f,y,v)},x),
         hv=match[2],
         gv=match[1];
        return [0,caml_call1(f,x),gv,hv]}
      function gradhessianv$0(f,x,v)
       {var match=gradhessianv(f,x,v),hv=match[3],gv=match[2];
        return [0,gv,hv]}
      function hessianv(f,x,v)
       {var match=gradhessianv(f,x,v),hv=match[3],fv=match[1];
        return [0,fv,hv]}
      function hessianv$0(f,x,v)
       {var match=gradhessianv(f,x,v),hv=match[3];return hv}
      function laplacian(f,x)
       {var _sY_=unpack_arr(hessian(f,x));return [0,caml_call1(A[112],_sY_)]}
      function laplacian$0(f,x)
       {var _sX_=laplacian(f,x);return [0,caml_call1(f,x),_sX_]}
      function empty(m,n){return [1,caml_call1(A[1],[0,m,n])]}
      function zeros(m,n){return [1,caml_call1(A[2],[0,m,n])]}
      function ones(m,n){return [1,caml_call1(A[3],[0,m,n])]}
      function uniform(a,b,m,n){return [1,caml_call3(A[6],a,b,[0,m,n])]}
      function gaussian(mu,sigma,m,n)
       {return [1,caml_call3(A[7],mu,sigma,[0,m,n])]}
      function reset(x){var _sW_=unpack_arr(x);return caml_call1(A[17],_sW_)}
      function reshape$0(m,n,x){return caml_call2(Maths[75],x,[0,m,n])}
      function shape$0(x)
       {var
         _sU_=unpack_arr(x),
         s=caml_call1(A[10],_sU_),
         _sV_=caml_check_bound(s,1)[2];
        return [0,caml_check_bound(s,0)[1],_sV_]}
      function row_num$0(x)
       {var _sT_=unpack_arr(x);
        return caml_check_bound(caml_call1(A[10],_sT_),0)[1]}
      function col_num$0(x)
       {var _sS_=unpack_arr(x);
        return caml_check_bound(caml_call1(A[10],_sS_),1)[2]}
      function numel$0(x){return numel(x)}
      function row(x,i){return caml_call2(Maths[63],x,i)}
      function get(x,i,j){return caml_call3(Maths[41],x,i,j)}
      function set(x,i,j,a){return caml_call4(Maths[42],x,i,j,a)}
      function mean$0(x){return caml_call1(Maths[48],x)}
      function add$0(x,y){return caml_call2(Maths[5],x,y)}
      function sub$0(x,y){return caml_call2(Maths[7],x,y)}
      function mul$0(x,y){return caml_call2(Maths[9],x,y)}
      function div$0(x,y){return caml_call2(Maths[11],x,y)}
      function dot$0(x,y){return caml_call2(Maths[50],x,y)}
      function map_by_row(f,x)
       {var _sR_=map$0(f,caml_call1(Maths[64],x));
        return caml_call1(Maths[65],_sR_)}
      function print(x)
       {var _sQ_=unpack_arr(x);return caml_call5(A[28],0,0,0,0,_sQ_)}
      function of_arrays(x){return [1,caml_call1(A[117],x)]}
      var
       Mat=
        [0,
         empty,
         zeros,
         ones,
         uniform,
         gaussian,
         reset,
         reshape$0,
         shape$0,
         row_num$0,
         col_num$0,
         numel$0,
         row,
         get,
         set,
         mean$0,
         add$0,
         sub$0,
         mul$0,
         div$0,
         dot$0,
         map_by_row,
         print,
         of_arrays];
      function empty$0(d){return [1,caml_call1(A[1],d)]}
      function zeros$0(d){return [1,caml_call1(A[2],d)]}
      function ones$0(d){return [1,caml_call1(A[3],d)]}
      function uniform$0(a,b,d){return [1,caml_call3(A[6],a,b,d)]}
      function gaussian$0(mu,sigma,d){return [1,caml_call3(A[7],mu,sigma,d)]}
      function reset$0(x)
       {var _sP_=unpack_arr(x);return caml_call1(A[17],_sP_)}
      function reshape$1(x,s){return caml_call2(Maths[75],x,s)}
      function shape$1(x)
       {var _sO_=unpack_arr(x);return caml_call1(A[10],_sO_)}
      function numel$1(x){return numel(x)}
      function add$1(x,y){return caml_call2(Maths[5],x,y)}
      function sub$1(x,y){return caml_call2(Maths[7],x,y)}
      function mul$1(x,y){return caml_call2(Maths[9],x,y)}
      function div$1(x,y){return caml_call2(Maths[11],x,y)}
      function dot$1(x,y){return caml_call2(Maths[50],x,y)}
      var
       Arr=
        [0,
         empty$0,
         zeros$0,
         ones$0,
         uniform$0,
         gaussian$0,
         reset$0,
         reshape$1,
         shape$1,
         numel$1,
         add$1,
         sub$1,
         mul$1,
         div$1,
         dot$1];
      function traverse_trace(x)
       {var h=create$0(0,512),index=[0,0],tlist=x;
        a:
        for(;;)
         {if(tlist)
           {var
             tl=tlist[2],
             hd=tlist[1],
             _sK_=indexfun(h,hd),
             param$0=caml_check_bound(h[2],_sK_)[_sK_ + 1],
             param=param$0;
            for(;;)
             {if(param)
               {var
                 k=param[1],
                 next$0=param[3],
                 _sJ_=0 === caml_compare(k,hd)?1:0;
                if(!_sJ_){var param=next$0;continue}
                var _sL_=_sJ_}
              else
               var _sL_=0;
              if(0 === _sL_)
               {switch(hd[0])
                 {case 0:var match$1=[0,sprintf(_fD_),0];break;
                  case 1:var match$1=[0,sprintf(_fE_),0];break;
                  case 2:var match$1=[0,sprintf(_fF_),0];break;
                  default:
                   var ao=hd[3];
                   if(typeof ao === "number")
                    var _sM_=_fG_;
                   else
                    {var _sN_=ao[0];
                     if(45 <= _sN_)
                      switch(_sN_)
                       {case 45:
                         var b$19=ao[4],a$44=ao[1],_sM_=[0,_go_,[0,a$44,[0,b$19,0]]];
                         break;
                        case 46:
                         var b$20=ao[4],a$45=ao[1],_sM_=[0,_gp_,[0,a$45,[0,b$20,0]]];
                         break;
                        case 47:
                         var b$21=ao[4],a$46=ao[1],_sM_=[0,_gq_,[0,a$46,[0,b$21,0]]];
                         break;
                        case 48:
                         var b$22=ao[4],a$47=ao[1],_sM_=[0,_gr_,[0,a$47,[0,b$22,0]]];
                         break;
                        case 49:var a$48=ao[1],_sM_=[0,_gs_,[0,a$48,0]];break;
                        case 50:
                         var b$23=ao[2],a$49=ao[1],_sM_=[0,_gt_,[0,a$49,[0,b$23,0]]];
                         break;
                        case 51:
                         var b$24=ao[2],a$50=ao[1],_sM_=[0,_gu_,[0,a$50,[0,b$24,0]]];
                         break;
                        case 52:
                         var b$25=ao[2],a$51=ao[1],_sM_=[0,_gv_,[0,a$51,[0,b$25,0]]];
                         break;
                        case 53:var a$52=ao[1],_sM_=[0,_gw_,[0,a$52,0]];break;
                        case 54:var a$53=ao[1],_sM_=[0,_gx_,[0,a$53,0]];break;
                        case 55:
                         var b$26=ao[2],a$54=ao[1],_sM_=[0,_gy_,[0,a$54,[0,b$26,0]]];
                         break;
                        case 56:
                         var b$27=ao[2],a$55=ao[1],_sM_=[0,_gz_,[0,a$55,[0,b$27,0]]];
                         break;
                        case 57:
                         var b$28=ao[2],a$56=ao[1],_sM_=[0,_gA_,[0,a$56,[0,b$28,0]]];
                         break;
                        case 58:var a$57=ao[1],_sM_=[0,_gB_,[0,a$57,0]];break;
                        case 59:var a$58=ao[1],_sM_=[0,_gC_,[0,a$58,0]];break;
                        case 60:var a$59=ao[1],_sM_=[0,_gD_,[0,a$59,0]];break;
                        case 61:var a$60=ao[1],_sM_=[0,_gE_,[0,a$60,0]];break;
                        case 62:var a$61=ao[1],_sM_=[0,_gF_,[0,a$61,0]];break;
                        case 63:var a$62=ao[1],_sM_=[0,_gG_,[0,a$62,0]];break;
                        case 64:var a$63=ao[1],_sM_=[0,_gH_,[0,a$63,0]];break;
                        case 65:
                         var b$29=ao[2],a$64=ao[1],_sM_=[0,_gI_,[0,a$64,[0,b$29,0]]];
                         break;
                        case 66:
                         var b$30=ao[2],a$65=ao[1],_sM_=[0,_gJ_,[0,a$65,[0,b$30,0]]];
                         break;
                        case 67:
                         var b$31=ao[2],a$66=ao[1],_sM_=[0,_gK_,[0,a$66,[0,b$31,0]]];
                         break;
                        case 68:var a$67=ao[1],_sM_=[0,_gL_,[0,a$67,0]];break;
                        case 69:var a$68=ao[1],_sM_=[0,_gM_,to_list(a$68)];break;
                        case 70:
                         var b$32=ao[2],a$69=ao[1],_sM_=[0,_gN_,[0,a$69,[0,b$32,0]]];
                         break;
                        case 71:
                         var b$33=ao[2],a$70=ao[1],_sM_=[0,_gO_,[0,a$70,[0,b$33,0]]];
                         break;
                        case 72:
                         var b$34=ao[2],a$71=ao[1],_sM_=[0,_gP_,[0,a$71,[0,b$34,0]]];
                         break;
                        case 73:
                         var b$35=ao[2],a$72=ao[1],_sM_=[0,_gQ_,[0,a$72,[0,b$35,0]]];
                         break;
                        case 74:
                         var b$36=ao[2],a$73=ao[1],_sM_=[0,_gR_,[0,a$73,[0,b$36,0]]];
                         break;
                        case 75:
                         var b$37=ao[2],a$74=ao[1],_sM_=[0,_gS_,[0,a$74,[0,b$37,0]]];
                         break;
                        case 76:
                         var b$38=ao[2],a$75=ao[1],_sM_=[0,_gT_,[0,a$75,[0,b$38,0]]];
                         break;
                        case 77:
                         var b$39=ao[2],a$76=ao[1],_sM_=[0,_gU_,[0,a$76,[0,b$39,0]]];
                         break;
                        case 78:
                         var b$40=ao[2],a$77=ao[1],_sM_=[0,_gV_,[0,a$77,[0,b$40,0]]];
                         break;
                        case 79:
                         var b$41=ao[2],a$78=ao[1],_sM_=[0,_gW_,[0,a$78,[0,b$41,0]]];
                         break;
                        case 80:
                         var b$42=ao[2],a$79=ao[1],_sM_=[0,_gX_,[0,a$79,[0,b$42,0]]];
                         break;
                        case 81:
                         var b$43=ao[2],a$80=ao[1],_sM_=[0,_gY_,[0,a$80,[0,b$43,0]]];
                         break;
                        case 82:var a$81=ao[1],_sM_=[0,_gZ_,[0,a$81,0]];break;
                        case 83:var a$82=ao[1],_sM_=[0,_g0_,[0,a$82,0]];break;
                        case 84:var a$83=ao[1],_sM_=[0,_g1_,[0,a$83,0]];break;
                        case 85:var a$84=ao[1],_sM_=[0,_g2_,[0,a$84,0]];break;
                        case 86:var a$85=ao[1],_sM_=[0,_g3_,[0,a$85,0]];break;
                        case 87:var a$86=ao[1],_sM_=[0,_g4_,[0,a$86,0]];break;
                        default:var a$87=ao[1],_sM_=[0,_g5_,[0,a$87,0]]}
                     else
                      switch(_sN_)
                       {case 0:
                         var b=ao[2],a=ao[1],_sM_=[0,_fH_,[0,a,[0,b,0]]];break;
                        case 1:
                         var b$0=ao[2],a$0=ao[1],_sM_=[0,_fI_,[0,a$0,[0,b$0,0]]];
                         break;
                        case 2:
                         var b$1=ao[2],a$1=ao[1],_sM_=[0,_fJ_,[0,a$1,[0,b$1,0]]];
                         break;
                        case 3:
                         var b$2=ao[2],a$2=ao[1],_sM_=[0,_fK_,[0,a$2,[0,b$2,0]]];
                         break;
                        case 4:
                         var b$3=ao[2],a$3=ao[1],_sM_=[0,_fL_,[0,a$3,[0,b$3,0]]];
                         break;
                        case 5:
                         var b$4=ao[2],a$4=ao[1],_sM_=[0,_fM_,[0,a$4,[0,b$4,0]]];
                         break;
                        case 6:
                         var b$5=ao[2],a$5=ao[1],_sM_=[0,_fN_,[0,a$5,[0,b$5,0]]];
                         break;
                        case 7:
                         var b$6=ao[2],a$6=ao[1],_sM_=[0,_fO_,[0,a$6,[0,b$6,0]]];
                         break;
                        case 8:
                         var b$7=ao[2],a$7=ao[1],_sM_=[0,_fP_,[0,a$7,[0,b$7,0]]];
                         break;
                        case 9:
                         var b$8=ao[2],a$8=ao[1],_sM_=[0,_fQ_,[0,a$8,[0,b$8,0]]];
                         break;
                        case 10:
                         var b$9=ao[2],a$9=ao[1],_sM_=[0,_fR_,[0,a$9,[0,b$9,0]]];
                         break;
                        case 11:
                         var b$10=ao[2],a$10=ao[1],_sM_=[0,_fS_,[0,a$10,[0,b$10,0]]];
                         break;
                        case 12:
                         var b$11=ao[2],a$11=ao[1],_sM_=[0,_fT_,[0,a$11,[0,b$11,0]]];
                         break;
                        case 13:
                         var b$12=ao[2],a$12=ao[1],_sM_=[0,_fU_,[0,a$12,[0,b$12,0]]];
                         break;
                        case 14:
                         var b$13=ao[2],a$13=ao[1],_sM_=[0,_fV_,[0,a$13,[0,b$13,0]]];
                         break;
                        case 15:
                         var b$14=ao[2],a$14=ao[1],_sM_=[0,_fW_,[0,a$14,[0,b$14,0]]];
                         break;
                        case 16:
                         var b$15=ao[2],a$15=ao[1],_sM_=[0,_fX_,[0,a$15,[0,b$15,0]]];
                         break;
                        case 17:
                         var b$16=ao[2],a$16=ao[1],_sM_=[0,_fY_,[0,a$16,[0,b$16,0]]];
                         break;
                        case 18:var a$17=ao[1],_sM_=[0,_fZ_,[0,a$17,0]];break;
                        case 19:var a$18=ao[1],_sM_=[0,_f0_,[0,a$18,0]];break;
                        case 20:var a$19=ao[1],_sM_=[0,_f1_,[0,a$19,0]];break;
                        case 21:var a$20=ao[1],_sM_=[0,_f2_,[0,a$20,0]];break;
                        case 22:var a$21=ao[1],_sM_=[0,_f3_,[0,a$21,0]];break;
                        case 23:var a$22=ao[1],_sM_=[0,_f4_,[0,a$22,0]];break;
                        case 24:var a$23=ao[1],_sM_=[0,_f5_,[0,a$23,0]];break;
                        case 25:var a$24=ao[1],_sM_=[0,_f6_,[0,a$24,0]];break;
                        case 26:var a$25=ao[1],_sM_=[0,_f7_,[0,a$25,0]];break;
                        case 27:var a$26=ao[1],_sM_=[0,_f8_,[0,a$26,0]];break;
                        case 28:var a$27=ao[1],_sM_=[0,_f9_,[0,a$27,0]];break;
                        case 29:var a$28=ao[1],_sM_=[0,_f__,[0,a$28,0]];break;
                        case 30:var a$29=ao[1],_sM_=[0,_f$_,[0,a$29,0]];break;
                        case 31:var a$30=ao[1],_sM_=[0,_ga_,[0,a$30,0]];break;
                        case 32:var a$31=ao[1],_sM_=[0,_gb_,[0,a$31,0]];break;
                        case 33:var a$32=ao[1],_sM_=[0,_gc_,[0,a$32,0]];break;
                        case 34:var a$33=ao[1],_sM_=[0,_gd_,[0,a$33,0]];break;
                        case 35:var a$34=ao[1],_sM_=[0,_ge_,[0,a$34,0]];break;
                        case 36:var a$35=ao[1],_sM_=[0,_gf_,[0,a$35,0]];break;
                        case 37:var a$36=ao[1],_sM_=[0,_gg_,[0,a$36,0]];break;
                        case 38:var a$37=ao[1],_sM_=[0,_gh_,[0,a$37,0]];break;
                        case 39:var a$38=ao[1],_sM_=[0,_gi_,[0,a$38,0]];break;
                        case 40:var a$39=ao[1],_sM_=[0,_gj_,[0,a$39,0]];break;
                        case 41:var a$40=ao[1],_sM_=[0,_gk_,[0,a$40,0]];break;
                        case 42:var a$41=ao[1],_sM_=[0,_gl_,[0,a$41,0]];break;
                        case 43:
                         var b$17=ao[4],a$42=ao[1],_sM_=[0,_gm_,[0,a$42,[0,b$17,0]]];
                         break;
                        default:
                         var b$18=ao[4],a$43=ao[1],_sM_=[0,_gn_,[0,a$43,[0,b$18,0]]]}}
                   var match$1=_sM_}
                var
                 prev=match$1[2],
                 op=match$1[1],
                 data$0=[0,index[1],op,prev],
                 i$1=indexfun(h,hd),
                 bucket=[0,hd,data$0,caml_check_bound(h[2],i$1)[i$1 + 1]];
                caml_check_bound(h[2],i$1)[i$1 + 1] = bucket;
                h[1] = h[1] + 1 | 0;
                if(h[2].length - 1 << 1 < h[1])
                 {var odata=h[2],osize=odata.length - 1,nsize=osize * 2 | 0;
                  if(nsize < max_array_length)
                   {var
                     ndata=caml_make_vect(nsize,0),
                     ndata_tail=caml_make_vect(nsize,0),
                     inplace=1 - ongoing_traversal(h);
                    h[2] = ndata;
                    var _sE_=osize - 1 | 0,_sD_=0;
                    if(!(_sE_ < 0))
                     {var i$0=_sD_;
                      b:
                      for(;;)
                       {var
                         cell$1=caml_check_bound(odata,i$0)[i$0 + 1],
                         cell=cell$1;
                        for(;;)
                         {if(cell)
                           {var
                             key=cell[1],
                             data=cell[2],
                             next=cell[3],
                             cell$0=inplace?cell:[0,key,data,0],
                             nidx=indexfun(h,key),
                             match=caml_check_bound(ndata_tail,nidx)[nidx + 1];
                            if(match)
                             match[3] = cell$0;
                            else
                             caml_check_bound(ndata,nidx)[nidx + 1] = cell$0;
                            caml_check_bound(ndata_tail,nidx)[nidx + 1] = cell$0;
                            var cell=next;
                            continue}
                          var _sI_=i$0 + 1 | 0;
                          if(_sE_ !== i$0){var i$0=_sI_;continue b}
                          break}
                        break}}
                    if(inplace)
                     {var _sG_=nsize - 1 | 0,_sF_=0;
                      if(!(_sG_ < 0))
                       {var i=_sF_;
                        for(;;)
                         {var match$0=caml_check_bound(ndata_tail,i)[i + 1];
                          if(match$0)match$0[3] = 0;
                          var _sH_=i + 1 | 0;
                          if(_sG_ !== i){var i=_sH_;continue}
                          break}}}}}
                index[1] = index[1] + 1 | 0;
                var tlist$0=append(prev,tl),tlist=tlist$0;
                continue a}
              var tlist=tl;
              continue a}}
          return h}}
      function convert_terminal_output(nodes)
       {return fold
                (function(v,param,s0)
                  {var
                    v_prev=param[3],
                    v_op=param[2],
                    v_id=param[1],
                    v_ts=type_info(v);
                   return _d_
                           (s0,
                            fold_left
                             (function(s1,u)
                               {var
                                 match=find(nodes,u),
                                 u_op=match[2],
                                 u_id=match[1],
                                 u_ts=type_info(u);
                                return _d_
                                        (s1,caml_call6(sprintf(_g8_),u_id,u_op,u_ts,v_id,v_op,v_ts))},
                              _g7_,
                              v_prev))},
                 nodes,
                 _g6_)}
      function convert_dot_output(nodes)
       {var
         network=
          fold
           (function(v,param,s0)
             {var v_prev=param[3],v_id=param[1];
              return _d_
                      (s0,
                       fold_left
                        (function(s1,u)
                          {var match=find(nodes,u),u_id=match[1];
                           return _d_(s1,caml_call2(sprintf(_g$_),u_id,v_id))},
                         _g__,
                         v_prev))},
            nodes,
            _g9_),
         attrs=
          fold
           (function(v,param,s0)
             {var v_op=param[2],v_id=param[1];
              if(caml_string_equal(v_op,_hb_))
               {var _sB_=deep_info(v);
                return _d_(s0,caml_call4(sprintf(_hc_),v_id,v_id,v_op,_sB_))}
              var _sC_=deep_info(v);
              return _d_(s0,caml_call4(sprintf(_hd_),v_id,v_id,v_op,_sC_))},
            nodes,
            _ha_);
        return _d_(network,attrs)}
      function to_trace(nodes)
       {return convert_terminal_output(traverse_trace(nodes))}
      function to_dot(nodes)
       {var _sA_=convert_dot_output(traverse_trace(nodes));
        return caml_call1(sprintf(_he_),_sA_)}
      function pp_num(formatter,x)
       {var _sz_=type_info(x);
        return caml_call2(fprintf$0(formatter),_hf_,_sz_)}
      return [0,
              global_tag,
              tag,
              cmp_tag,
              reset_zero,
              primal,
              primal$0,
              zero,
              tangent,
              adjref,
              adjval,
              shape,
              row_num,
              col_num,
              numel,
              clip_by_value,
              clip_by_l2norm,
              copy_primal,
              tile,
              repeat,
              pack_arr,
              unpack_arr,
              pack_flt,
              unpack_flt,
              deep_info,
              type_info,
              error_binop,
              error_uniop,
              Maths,
              reverse_reset,
              reverse_push,
              reverse_prop,
              make_forward,
              make_reverse,
              diff,
              diff$0,
              grad,
              grad$0,
              jacobianv,
              jacobianv$0,
              jacobianTv,
              jacobianTv$0,
              jacobian,
              jacobian$0,
              gradhessian,
              gradhessian$0,
              hessian,
              hessian$0,
              gradhessianv,
              gradhessianv$0,
              hessianv,
              hessianv$0,
              laplacian,
              laplacian$0,
              Mat,
              Arr,
              traverse_trace,
              convert_terminal_output,
              convert_dot_output,
              to_trace,
              to_dot,
              pp_num]}
    function add$0(x,y){return x + y}
    function sub$3(x,y){return x - y}
    function mul$0(x,y){return x * y}
    function div$0(x,y){return x / y}
    function pow(x,y){return Math.pow(x,y)}
    function atan2(x,y){return Math.atan2(x,y)}
    function abs$0(x){return Math.abs(x)}
    function neg(x){return -x}
    function sqr(x){return x * x}
    function sqrt(x){return Math.sqrt(x)}
    function exp(x){return Math.exp(x)}
    function log(x){return Math.log(x)}
    function log2(x){return Math.log(x) / 0.693147180559945286}
    var log10=caml_log10_float;
    function signum(x)
     {return 0 === caml_float_compare(x,nan)?nan:0 < x?1:x < 0?-1:0}
    function floor(x){return Math.floor(x)}
    function ceil(x){return Math.ceil(x)}
    function round(x){return Math.floor(x + 0.5)}
    function sin(x){return Math.sin(x)}
    function cos(x){return Math.cos(x)}
    function tan(x){return Math.tan(x)}
    var sinh=caml_sinh_float,cosh=caml_cosh_float,tanh=caml_tanh_float;
    function asin(x){return Math.asin(x)}
    function acos(x){return Math.acos(x)}
    function atan(x){return Math.atan(x)}
    function asinh(x){return Math.log(x + Math.sqrt(x * x + 1))}
    function acosh(x){return Math.log(x + Math.sqrt(x * x - 1))}
    function atanh(x){return 0.5 * Math.log((1 + x) / (1 - x))}
    function relu(x){return max(0,x)}
    function sigmoid(x){return 1 / (1 + Math.log(-x))}
    var rand_gen=make_self_init(0);
    function uniform(a,b){return a + (b - a) * float$0(rand_gen,1)}
    var u1=[0,0],u2=[0,0],case$0=[0,0],z0=[0,0],z1=[0,1];
    function add_elt(param)
     {switch(param)
       {case 0:return function(_ss_,_sr_){return _ss_ + _sr_};
        case 1:return function(_sq_,_sp_){return _sq_ + _sp_};
        case 2:return function(_so_,_sn_){return _so_ + _sn_ | 0};
        case 3:return function(_sm_,_sl_){return _sm_ + _sl_ | 0};
        case 4:return function(_sk_,_sj_){return _sk_ + _sj_ | 0};
        case 5:return function(_si_,_sh_){return _si_ + _sh_ | 0};
        case 6:return function(_sg_,_sf_){return _sg_ + _sf_ | 0};
        case 7:return caml_int64_add;
        case 10:return add;
        case 11:return add;
        default:return failwith(_hh_)}}
    function sub_elt(param)
     {switch(param)
       {case 0:return function(_se_,_sd_){return _se_ - _sd_};
        case 1:return function(_sc_,_sb_){return _sc_ - _sb_};
        case 2:return function(_sa_,_r$_){return _sa_ - _r$_ | 0};
        case 3:return function(_r__,_r9_){return _r__ - _r9_ | 0};
        case 4:return function(_r8_,_r7_){return _r8_ - _r7_ | 0};
        case 5:return function(_r6_,_r5_){return _r6_ - _r5_ | 0};
        case 6:return function(_r4_,_r3_){return _r4_ - _r3_ | 0};
        case 7:return caml_int64_sub;
        case 10:return sub$2;
        case 11:return sub$2;
        default:return failwith(_hi_)}}
    function mul_elt(param)
     {switch(param)
       {case 0:return function(_r2_,_r1_){return _r2_ * _r1_};
        case 1:return function(_r0_,_rZ_){return _r0_ * _rZ_};
        case 2:return function(_rY_,_rX_){return caml_mul(_rY_,_rX_)};
        case 3:return function(_rW_,_rV_){return caml_mul(_rW_,_rV_)};
        case 4:return function(_rU_,_rT_){return caml_mul(_rU_,_rT_)};
        case 5:return function(_rS_,_rR_){return caml_mul(_rS_,_rR_)};
        case 6:return function(_rQ_,_rP_){return caml_mul(_rQ_,_rP_)};
        case 7:return caml_int64_mul;
        case 10:return mul;
        case 11:return mul;
        default:return failwith(_hj_)}}
    function div_elt(param)
     {switch(param)
       {case 0:return function(_rO_,_rN_){return _rO_ / _rN_};
        case 1:return function(_rM_,_rL_){return _rM_ / _rL_};
        case 2:return caml_div;
        case 3:return caml_div;
        case 4:return caml_div;
        case 5:return caml_div;
        case 6:return caml_div;
        case 7:return caml_int64_div;
        case 10:return div;
        case 11:return div;
        default:return failwith(_hk_)}}
    function prepend_dims(dims,desired_len)
     {var dims_len=dims.length - 1;
      return desired_len <= dims_len
              ?dims
              :append$0(caml_make_vect(desired_len - dims_len | 0,1),dims)}
    function next_index(ind,dims)
     {var num_dims=ind.length - 1,p=[0,num_dims - 1 | 0],ok=[0,0];
      for(;;)
       {if(0 <= p[1])
         if(!ok[1])
          {var _rE_=p[1],_rF_=caml_check_bound(dims,_rE_)[_rE_ + 1],_rG_=p[1];
           if((caml_check_bound(ind,_rG_)[_rG_ + 1] + 1 | 0) < _rF_)
            {var
              _rH_=p[1],
              _rI_=caml_check_bound(ind,_rH_)[_rH_ + 1] + 1 | 0,
              _rJ_=p[1];
             caml_check_bound(ind,_rJ_)[_rJ_ + 1] = _rI_;
             ok[1] = 1;
             continue}
           var _rK_=p[1];
           caml_check_bound(ind,_rK_)[_rK_ + 1] = 0;
           p[1] = p[1] - 1 | 0;
           continue}
        return ok[1]}}
    function get_broadcasted_index(ind,dims)
     {var num_dims=dims.length - 1;
      function calc_fun(i)
       {var
         max_ind=caml_check_bound(dims,i)[i + 1],
         ind_val=caml_check_bound(ind,i)[i + 1];
        if(ind_val < max_ind)return ind_val;
        if(1 === max_ind)return 0;
        throw [0,Invalid_argument,_hz_]}
      return init(num_dims,calc_fun)}
    function apply_perm(arr,perm)
     {return init
              (arr.length - 1,
               function(i)
                {var _rD_=caml_check_bound(perm,i)[i + 1];
                 return caml_check_bound(arr,_rD_)[_rD_ + 1]})}
    function enumerate_slice_def(dim,step,start,stop)
     {var
       start$0=0 <= start?start:dim + start | 0,
       stop$0=0 <= stop?stop:dim + stop | 0;
      if(step)var x=step[1],step$0=x;else var step$0=start$0 <= stop$0?1:-1;
      var switch$0=start$0 <= stop$0?0 < step$0?1:0:0;
      if(!switch$0)
       {var switch$1=stop$0 < start$0?0 <= step$0?1:0:1;
        if(switch$1)throw [0,Assert_failure,_hB_]}
      var
       step_abs=abs(step$0),
       len=caml_div(abs(stop$0 - start$0 | 0) + step_abs | 0,step_abs);
      return init(len,function(i){return start$0 + caml_mul(i,step$0) | 0})}
    function expand_slice_indices(index_list,dims)
     {var rank=dims.length - 1,len=0,param=index_list;
      for(;;)
       {if(param)
         {var param$0=param[2],len$0=len + 1 | 0,len=len$0,param=param$0;
          continue}
        var
         expand_slice_index=
          function(i,ind)
           {if(ind)
             {var _ry_=ind[2],_rz_=ind[1];
              if(_ry_)
               {var _rA_=_ry_[2],_rB_=_ry_[1];
                if(_rA_)
                 {if(_rA_[2])return failwith(_hC_);
                  var step=_rA_[1];
                  return enumerate_slice_def
                          (caml_check_bound(dims,i)[i + 1],[0,step],_rz_,_rB_)}
                return enumerate_slice_def
                        (caml_check_bound(dims,i)[i + 1],0,_rz_,_rB_)}
              return enumerate_slice_def
                      (caml_check_bound(dims,i)[i + 1],0,_rz_,_rz_)}
            function _rC_(i){return i}
            return init(caml_check_bound(dims,i)[i + 1],_rC_)},
         _rv_=
          init
           (rank - len | 0,
            function(p)
             {var _rx_=p + len | 0;
              function _rw_(i){return i}
              return init(caml_check_bound(dims,_rx_)[_rx_ + 1],_rw_)});
        return append$0(of_list(mapi(expand_slice_index,index_list)),_rv_)}}
    function create$1(kind,dims,value)
     {var varr=caml_ba_create(kind,0,dims);
      caml_ba_fill(varr,value);
      return varr}
    function zeros(kind,dims){return create$1(kind,dims,zero$0(kind))}
    function shape(varr){return dims(varr)}
    function num_dims(varr){return shape(varr).length - 1}
    function numel(varr)
     {var v_shape=shape(varr),_rs_=1;
      return fold_left$0
              (function(_ru_,_rt_){return caml_mul(_ru_,_rt_)},_rs_,v_shape)}
    var get=caml_ba_get_generic,set=caml_ba_set_generic;
    function get_slice(index_list,varr)
     {var
       dims=shape(varr),
       rank=dims.length - 1,
       index_array=expand_slice_indices(index_list,dims),
       slice_dims=map$0(function(a){return a.length - 1},index_array),
       slice_varr=caml_ba_create(caml_ba_kind(varr),0,slice_dims),
       slice_ind=caml_make_vect(rank,0),
       original_ind=caml_make_vect(rank,0),
       should_stop=[0,0];
      for(;;)
       {if(should_stop[1])return slice_varr;
        var _ro_=rank - 1 | 0,_rn_=0;
        if(!(_ro_ < 0))
         {var i=_rn_;
          for(;;)
           {var
             _rp_=caml_check_bound(slice_ind,i)[i + 1],
             _rq_=
              caml_check_bound(caml_check_bound(index_array,i)[i + 1],_rp_)
               [_rp_ + 1];
            caml_check_bound(original_ind,i)[i + 1] = _rq_;
            var _rr_=i + 1 | 0;
            if(_ro_ !== i){var i=_rr_;continue}
            break}}
        caml_ba_set_generic
         (slice_varr,slice_ind,caml_ba_get_generic(varr,original_ind));
        if(1 - next_index(slice_ind,slice_dims)){should_stop[1] = 1;continue}
        continue}}
    function set_slice(index_list,varr,slice_varr)
     {var
       dims=shape(varr),
       rank=dims.length - 1,
       index_array=expand_slice_indices(index_list,dims),
       slice_dims=map$0(function(a){return a.length - 1},index_array),
       slice_varr$0=caml_ba_reshape(slice_varr,slice_dims),
       slice_ind=caml_make_vect(rank,0),
       original_ind=caml_make_vect(rank,0),
       should_stop=[0,0];
      for(;;)
       {if(should_stop[1])return 0;
        var _rj_=rank - 1 | 0,_ri_=0;
        if(!(_rj_ < 0))
         {var i=_ri_;
          for(;;)
           {var
             _rk_=caml_check_bound(slice_ind,i)[i + 1],
             _rl_=
              caml_check_bound(caml_check_bound(index_array,i)[i + 1],_rk_)
               [_rk_ + 1];
            caml_check_bound(original_ind,i)[i + 1] = _rl_;
            var _rm_=i + 1 | 0;
            if(_rj_ !== i){var i=_rm_;continue}
            break}}
        caml_ba_set_generic
         (varr,original_ind,caml_ba_get_generic(slice_varr$0,slice_ind));
        if(1 - next_index(slice_ind,slice_dims)){should_stop[1] = 1;continue}
        continue}}
    function copy$0(varr)
     {var
       _rh_=shape(varr),
       varr_copy=caml_ba_create(caml_ba_kind(varr),0,_rh_);
      caml_ba_blit(varr,varr_copy);
      return varr_copy}
    function reset(varr){return caml_ba_fill(varr,0)}
    var reshape=caml_ba_reshape;
    function flatten(varr){return caml_ba_reshape(varr,[0,numel(varr)])}
    function reverse(varr)
     {var
       n=numel(varr),
       _rd_=shape(varr),
       ret=caml_ba_create(caml_ba_kind(varr),0,_rd_),
       ret_flat=caml_ba_reshape(ret,[0,n]),
       varr_flat=caml_ba_reshape(varr,[0,n]),
       _rf_=n - 1 | 0,
       _re_=0;
      if(!(_rf_ < 0))
       {var i=_re_;
        for(;;)
         {caml_ba_set_generic
           (ret_flat,
            [0,i],
            caml_ba_get_generic(varr_flat,[0,(n - 1 | 0) - i | 0]));
          var _rg_=i + 1 | 0;
          if(_rf_ !== i){var i=_rg_;continue}
          break}}
      return ret}
    function apply_fun(f,varr)
     {var
       varr_linear=array1_of_genarray(flatten(varr)),
       length=numel(varr),
       _rb_=length - 1 | 0,
       _ra_=0;
      if(!(_rb_ < 0))
       {var i=_ra_;
        for(;;)
         {caml_ba_set_1
           (varr_linear,i,caml_call1(f,caml_ba_get_1(varr_linear,i)));
          var _rc_=i + 1 | 0;
          if(_rb_ !== i){var i=_rc_;continue}
          break}}
      return 0}
    function map$1(f,varr)
     {var varr_copy=copy$0(varr);apply_fun(f,varr_copy);return varr_copy}
    function strides(x){return calc_stride(shape(x))}
    function slice_size(x)
     {var
       s=shape(x),
       d=s.length - 1,
       _q6_=d - 1 | 0,
       r=caml_make_vect(d,caml_check_bound(s,_q6_)[_q6_ + 1]),
       _q7_=d - 2 | 0;
      if(!(_q7_ < 0))
       {var i=_q7_;
        for(;;)
         {var
           _q8_=i + 1 | 0,
           _q9_=caml_check_bound(r,_q8_)[_q8_ + 1],
           _q__=caml_mul(caml_check_bound(s,i)[i + 1],_q9_);
          caml_check_bound(r,i)[i + 1] = _q__;
          var _q$_=i - 1 | 0;
          if(0 !== i){var i=_q$_;continue}
          break}}
      return r}
    function fold$0(axis$0,f,a,x$0)
     {function f$0(param,b,c){return caml_call2(f,b,c)}
      var x=array1_of_genarray(flatten(x$0));
      if(axis$0)
       {var axis=axis$0[1],d=num_dims(x$0);
        if(0 <= axis)
         if(axis < d)
          {var
            s=shape(x$0),
            stride=strides(x$0),
            slicez=slice_size(x$0),
            _qU_=caml_check_bound(slicez,axis)[axis + 1],
            m=caml_div(numel(x$0),_qU_),
            n=caml_check_bound(slicez,axis)[axis + 1],
            o=caml_check_bound(stride,axis)[axis + 1];
           caml_check_bound(s,axis)[axis + 1] = 1;
           var
            start_x=[0,0],
            start_y=[0,0],
            incy=[0,0],
            k=[0,0],
            y=create$1(caml_ba_kind(x$0),s,a),
            y$0=array1_of_genarray(flatten(y)),
            _qW_=m - 1 | 0,
            _qV_=0;
           if(!(_qW_ < 0))
            {var i=_qV_;
             for(;;)
              {var _qY_=n - 1 | 0,_qX_=0;
               if(!(_qY_ < 0))
                {var j=_qX_;
                 for(;;)
                  {var
                    b=caml_ba_get_1(y$0,start_y[1] + incy[1] | 0),
                    c=caml_ba_get_1(x,start_x[1] + j | 0),
                    _q0_=f$0(k[1],b,c);
                   caml_ba_set_1(y$0,start_y[1] + incy[1] | 0,_q0_);
                   incy[1] = (incy[1] + 1 | 0) === o?0:incy[1] + 1 | 0;
                   k[1] = k[1] + 1 | 0;
                   var _q1_=j + 1 | 0;
                   if(_qY_ !== j){var j=_q1_;continue}
                   break}}
               start_x[1] = start_x[1] + n | 0;
               start_y[1] = start_y[1] + o | 0;
               var _qZ_=i + 1 | 0;
               if(_qW_ !== i){var i=_qZ_;continue}
               break}}
           return y}
        throw [0,Assert_failure,_hD_]}
      var b$0=[0,a],_q3_=numel(x$0) - 1 | 0,_q2_=0;
      if(!(_q3_ < 0))
       {var i$0=_q2_;
        for(;;)
         {var c$0=caml_ba_get_1(x,i$0);
          b$0[1] = f$0(i$0,b$0[1],c$0);
          var _q5_=i$0 + 1 | 0;
          if(_q3_ !== i$0){var i$0=_q5_;continue}
          break}}
      var _q4_=b$0[1];
      return create$1(caml_ba_kind(x$0),[0,1],_q4_)}
    function scan(axis,f,x)
     {var d=num_dims(x);
      if(axis)var a=axis[1],a$0=a;else var a$0=d - 1 | 0;
      if(0 <= a$0)
       if(a$0 < d)
        {var
          stride=strides(x),
          slicez=slice_size(x),
          _qL_=caml_check_bound(slicez,a$0)[a$0 + 1],
          m=caml_div(numel(x),_qL_),
          _qM_=caml_check_bound(stride,a$0)[a$0 + 1],
          n=caml_check_bound(slicez,a$0)[a$0 + 1] - _qM_ | 0,
          incx=caml_check_bound(slicez,a$0)[a$0 + 1],
          incy=slicez[a$0 + 1],
          start_x=[0,0],
          start_y=[0,caml_check_bound(stride,a$0)[a$0 + 1]],
          k=[0,0],
          y=copy$0(x),
          y$0=array1_of_genarray(flatten(y)),
          _qO_=m - 1 | 0,
          _qN_=0;
         if(!(_qO_ < 0))
          {var i=_qN_;
           for(;;)
            {var _qQ_=n - 1 | 0,_qP_=0;
             if(!(_qQ_ < 0))
              {var j=_qP_;
               for(;;)
                {var
                  a$1=caml_ba_get_1(y$0,start_x[1] + j | 0),
                  b=caml_ba_get_1(y$0,start_y[1] + j | 0),
                  _qT_=caml_call2(f,a$1,b);
                 caml_ba_set_1(y$0,start_y[1] + j | 0,_qT_);
                 k[1] = k[1] + 1 | 0;
                 var _qS_=j + 1 | 0;
                 if(_qQ_ !== j){var j=_qS_;continue}
                 break}}
             start_x[1] = start_x[1] + incx | 0;
             start_y[1] = start_y[1] + incy | 0;
             var _qR_=i + 1 | 0;
             if(_qO_ !== i){var i=_qR_;continue}
             break}}
         return y}
      throw [0,Assert_failure,_hE_]}
    function print(max_row$0,max_col$0,header$0,fmt,varr)
     {var
       dims$0=shape(varr),
       rank=dims$0.length - 1,
       _qu_=rank - 1 | 0,
       n$0=caml_check_bound(dims$0,_qu_)[_qu_ + 1];
      if(max_row$0)
       var a$0=max_row$0[1],max_row$1=[0,a$0];
      else
       var max_row$1=[0,caml_div(numel(varr),n$0)];
      if(max_col$0)
       var a$1=max_col$0[1],max_col$1=[0,a$1];
      else
       var max_col$1=[0,n$0];
      if(header$0)var sth=header$0[1],header=sth;else var header=1;
      if(max_row$1)var sth$0=max_row$1[1],max_row=sth$0;else var max_row=10;
      if(max_col$1)var sth$1=max_col$1[1],max_col=sth$1;else var max_col=10;
      if(fmt)
       var f$0=fmt[1],elt_to_str_fun=f$0;
      else
       {var param=caml_ba_kind(varr);
        switch(param)
         {case 0:
           var _qt_=function(v){return caml_call1(sprintf(_c$_),v)};break;
          case 1:
           var _qt_=function(v){return caml_call1(sprintf(_da_),v)};break;
          case 2:
           var _qt_=function(v){return caml_call1(sprintf(_db_),v)};break;
          case 3:
           var _qt_=function(v){return caml_call1(sprintf(_dc_),v)};break;
          case 4:
           var _qt_=function(v){return caml_call1(sprintf(_dd_),v)};break;
          case 5:
           var _qt_=function(v){return caml_call1(sprintf(_de_),v)};break;
          case 6:
           var _qt_=function(v){return caml_call1(sprintf(_df_),v)};break;
          case 7:
           var _qt_=function(v){return caml_call1(sprintf(_dg_),v)};break;
          case 8:
           var _qt_=function(v){return caml_call1(sprintf(_dh_),v)};break;
          case 9:
           var _qt_=function(v){return caml_call1(sprintf(_di_),v)};break;
          case 10:
           var
            _qt_=
             function(v)
              {var _qJ_=v[2],_qK_=v[1];
               return caml_call2(sprintf(_dj_),_qK_,_qJ_)};
           break;
          case 11:
           var
            _qt_=
             function(v)
              {var _qH_=v[2],_qI_=v[1];
               return caml_call2(sprintf(_dk_),_qI_,_qH_)};
           break;
          default:var _qt_=function(v){return caml_call1(sprintf(_dl_),v)}}
        var elt_to_str_fun=_qt_}
      if(0 === caml_ba_num_dims(varr))
       var out_s$0=caml_call1(elt_to_str_fun,caml_ba_get_generic(varr,[0]));
      else
       {var
         shape$0=dims(varr),
         _qi_=caml_ba_num_dims(varr) - 1 | 0,
         col_num=caml_check_bound(shape$0,_qi_)[_qi_ + 1],
         _qj_=1,
         row_num=
          caml_div
           (fold_left$0
             (function(_qG_,_qF_){return caml_mul(_qG_,_qF_)},_qj_,shape$0),
            col_num),
         y=caml_ba_reshape(varr,[0,row_num,col_num]),
         discontinuous=
          function(max_w,w)
           {var
             half=max_w / 2 | 0,
             fst_half=init(half,function(i){return i}),
             snd_half=init(half,function(i){return (i + w | 0) - half | 0});
            return append$0(append$0(fst_half,[0,-1]),snd_half)},
         match=row_num <= max_row?1:0,
         row_indices=
          0 === match
           ?discontinuous(max_row,row_num)
           :init(row_num,function(i){return i}),
         match$0=col_num <= max_col?1:0,
         col_indices=
          0 === match$0
           ?discontinuous(max_col,col_num)
           :init(col_num,function(i){return i}),
         sx=row_indices.length - 1,
         sy=col_indices.length - 1,
         tbody=caml_make_vect(sx,[0]),
         _qd_=sx - 1 | 0,
         _qc_=0;
        if(!(_qd_ < 0))
         {var x=_qc_;
          for(;;)
           {tbody[x + 1] = caml_make_vect(sy,init$0);
            var _qe_=x + 1 | 0;
            if(_qd_ !== x){var x=_qe_;continue}
            break}}
        iteri
         (function(i$0,i)
           {return iteri
                    (function(j$0,j)
                      {if(0 <= i)
                        if(0 <= j)
                         {var
                           e=caml_ba_get_generic(y,[0,i,j]),
                           s=caml_call1(elt_to_str_fun,e);
                          return caml_check_bound
                                   (caml_check_bound(tbody,i$0)[i$0 + 1],j$0)
                                  [j$0 + 1]
                                 =
                                 s}
                       return caml_check_bound
                                (caml_check_bound(tbody,i$0)[i$0 + 1],j$0)
                               [j$0 + 1]
                              =
                              _hs_},
                     col_indices)},
          row_indices);
        var
         shape$1=dims(varr),
         s=calc_stride(shape$1),
         dim_num=shape$1.length - 1,
         _qk_=dim_num - 1 | 0,
         col_num$0=caml_check_bound(shape$1,_qk_)[_qk_ + 1],
         row_header=
          map$0
           (function(i)
             {if(0 <= i)
               {var
                 i$0=caml_mul(i,col_num$0),
                 j=copy(s),
                 _qy_=caml_div(i$0,caml_check_bound(s,0)[1]);
                caml_check_bound(j,0)[1] = _qy_;
                var _qA_=s.length - 1 - 1 | 0,_qz_=1;
                if(!(_qA_ < 1))
                 {var k=_qz_;
                  for(;;)
                   {var
                     _qC_=k - 1 | 0,
                     _qB_=caml_check_bound(s,k)[k + 1],
                     _qD_=
                      caml_div
                       (caml_mod(i$0,caml_check_bound(s,_qC_)[_qC_ + 1]),_qB_);
                    caml_check_bound(j,k)[k + 1] = _qD_;
                    var _qE_=k + 1 | 0;
                    if(_qA_ !== k){var k=_qE_;continue}
                    break}}
                var
                 idx_nd=sub$1(j,0,dim_num - 1 | 0),
                 idx_s=
                  1 === dim_num
                   ?_hl_
                   :2 === dim_num
                     ?caml_new_string("" + caml_check_bound(idx_nd,0)[1])
                     :string_of_array(_ho_,_hn_,0,string_of_int,idx_nd);
                return caml_call2(sprintf(_hm_),row_prefix,idx_s)}
              return _hp_},
            row_indices),
         col_header=
          map$0
           (function(i)
             {return 0 <= i?caml_call2(sprintf(_hq_),col_prefix,i):_hr_},
            col_indices);
        if(0 === header)
         var table=tbody;
        else
         {var
           a=append$0([0,col_header],tbody),
           row_header$0=append$0([0,_ht_],row_header),
           f=
            function(i,row)
             {return append$0([0,caml_check_bound(row_header$0,i)[i + 1]],row)},
           l=a.length - 1;
          if(0 === l)
           var _qs_=[0];
          else
           {var r=caml_make_vect(l,f(0,a[1])),_qg_=l - 1 | 0,_qf_=1;
            if(!(_qg_ < 1))
             {var i=_qf_;
              for(;;)
               {r[i + 1] = f(i,a[i + 1]);
                var _qh_=i + 1 | 0;
                if(_qg_ !== i){var i=_qh_;continue}
                break}}
            var _qs_=r}
          var table=_qs_}
        var
         row_num$0=table.length - 1,
         col_num$1=caml_check_bound(table,0)[1].length - 1,
         col_width=
          init
           (col_num$1,
            function(i)
             {var col_width=[0,0],_qw_=table.length - 1 - 1 | 0,_qv_=0;
              if(!(_qw_ < 0))
               {var row_idx=_qv_;
                for(;;)
                 {var
                   w=
                    caml_ml_string_length
                     (caml_check_bound
                        (caml_check_bound(table,row_idx)[row_idx + 1],i)
                       [i + 1]);
                  col_width[1] = max(col_width[1],w);
                  var _qx_=row_idx + 1 | 0;
                  if(_qw_ !== row_idx){var row_idx=_qx_;continue}
                  break}}
              return col_width[1]}),
         out_s=[0,_hu_],
         _qm_=row_num$0 - 1 | 0,
         _ql_=0;
        if(!(_qm_ < 0))
         {var i$0=_ql_;
          for(;;)
           {var _qo_=col_num$1 - 1 | 0,_qn_=0;
            if(!(_qo_ < 0))
             {var j=_qn_;
              for(;;)
               {var
                 n=caml_check_bound(col_width,j)[j + 1],
                 s$0=
                  caml_check_bound(caml_check_bound(table,i$0)[i$0 + 1],j)
                   [j + 1],
                 w=max(0,n - caml_ml_string_length(s$0) | 0),
                 new_s=_d_(make$0(w,32),s$0),
                 _qq_=_d_(new_s,_hw_);
                out_s[1] = _d_(out_s[1],_qq_);
                var _qr_=j + 1 | 0;
                if(_qo_ !== j){var j=_qr_;continue}
                break}}
            out_s[1] = _d_(out_s[1],_hv_);
            var _qp_=i$0 + 1 | 0;
            if(_qm_ !== i$0){var i$0=_qp_;continue}
            break}}
        var out_s$0=out_s[1]}
      pp_open_box_gen(formatter,0,4);
      caml_call2(fprintf$0(formatter),_hx_,out_s$0);
      return pp_close_box(formatter,0)}
    function tile(varr,reps)
     {var
       dims=shape(varr),
       result_rank=max(dims.length - 1,reps.length - 1),
       a=prepend_dims(dims,result_rank),
       b=prepend_dims(reps,result_rank),
       varr$0=caml_ba_reshape(varr,a),
       la=a.length - 1,
       lb=b.length - 1;
      if(la !== lb)
       var result_dims=invalid_arg(_A_);
      else
       if(0 === la)
        var result_dims=[0];
       else
        {var r=caml_make_vect(la,caml_mul(a[1],b[1])),_p7_=la - 1 | 0,_p6_=1;
         if(!(_p7_ < 1))
          {var i=_p6_;
           for(;;)
            {r[i + 1] = caml_mul(a[i + 1],b[i + 1]);
             var _p8_=i + 1 | 0;
             if(_p7_ !== i){var i=_p8_;continue}
             break}}
         var result_dims=r}
      var
       result_varr=caml_ba_create(caml_ba_kind(varr$0),0,result_dims),
       result_ind=caml_make_vect(result_rank,0),
       original_ind=caml_make_vect(result_rank,0),
       should_stop=[0,0];
      for(;;)
       {if(should_stop[1])return result_varr;
        var _p__=result_rank - 1 | 0,_p9_=0;
        if(!(_p__ < 0))
         {var i$0=_p9_;
          for(;;)
           {var
             _p$_=caml_check_bound(a,i$0)[i$0 + 1],
             _qa_=caml_mod(caml_check_bound(result_ind,i$0)[i$0 + 1],_p$_);
            caml_check_bound(original_ind,i$0)[i$0 + 1] = _qa_;
            var _qb_=i$0 + 1 | 0;
            if(_p__ !== i$0){var i$0=_qb_;continue}
            break}}
        caml_ba_set_generic
         (result_varr,result_ind,caml_ba_get_generic(varr$0,original_ind));
        if(1 - next_index(result_ind,result_dims))
         {should_stop[1] = 1;continue}
        continue}}
    function split(opt,parts,varr)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var
       dims=shape(varr),
       rank=dims.length - 1,
       pos=[0,0],
       axis_indices=
        map$0
         (function(d)
           {pos[1] = pos[1] + d | 0;
            return [0,pos[1] - d | 0,[0,pos[1] - 1 | 0,0]]},
          parts),
       slices_defs=
        map$0
         (function(ind)
           {return to_list(init(rank,function(i){return i === axis?ind:0}))},
          axis_indices);
      return map$0(function(def){return get_slice(def,varr)},slices_defs)}
    function draw(opt,varr,count)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var
       dims=shape(varr),
       len=dims.length - 1,
       range=caml_check_bound(dims,axis)[axis + 1];
      if(range < count)throw [0,Invalid_argument,_hA_];
      var pop_cnt=[0,range];
      function _p1_(i){return i}
      var pop=init(pop_cnt[1],_p1_),s=make_self_init(0);
      function draw_fun(param)
       {var _p3_=pop_cnt[1];
        if(1073741823 < _p3_)
         var switch$0=0;
        else
         if(0 < _p3_)
          for(;;)
           {var r=bits(s),v=caml_mod(r,_p3_);
            if(((1073741823 - _p3_ | 0) + 1 | 0) < (r - v | 0))continue;
            var index=v,switch$0=1;
            break}
         else
          var switch$0=0;
        if(!switch$0)var index=invalid_arg(_bH_);
        var sample=caml_check_bound(pop,index)[index + 1];
        pop_cnt[1] = pop_cnt[1] - 1 | 0;
        var _p4_=pop_cnt[1],_p5_=caml_check_bound(pop,_p4_)[_p4_ + 1];
        caml_check_bound(pop,index)[index + 1] = _p5_;
        return sample}
      var indices=init(count,draw_fun);
      function f(i){return i === axis?to_list(indices):0}
      if(0 <= len)
       if(1e4 < len)
        {var acc=0,i=0;
         for(;;)
          {if(!(len <= i))
            {var i$0=i + 1 | 0,acc$0=[0,f(i),acc],acc=acc$0,i=i$0;continue}
           var _p2_=rev(acc);
           break}}
       else
        var _p2_=init_aux(0,len,f);
      else
       var _p2_=invalid_arg(_k_);
      return [0,get_slice(_p2_,varr),indices]}
    function concatenate(opt,varrs)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var
       varrs_num=varrs.length - 1,
       all_dims=map$0(shape,varrs),
       prefix_dims=sub$1(caml_check_bound(all_dims,0)[1],0,axis),
       _pN_=0,
       sum_axis_dims=
        fold_left$0
         (function(x,a){return x + caml_check_bound(a,axis)[axis + 1] | 0},
          _pN_,
          all_dims),
       _pO_=(caml_check_bound(all_dims,0)[1].length - 1 - axis | 0) - 1 | 0,
       suffix_dims=sub$1(caml_check_bound(all_dims,0)[1],axis + 1 | 0,_pO_),
       result_dims=
        caml_array_concat
         ([0,prefix_dims,[0,[0,sum_axis_dims],[0,suffix_dims,0]]]),
       result_varr=
        caml_ba_create
         (caml_ba_kind(caml_check_bound(varrs,0)[1]),0,result_dims),
       _pP_=1,
       prefix_dims_product=
        fold_left$0
         (function(_p0_,_pZ_){return caml_mul(_p0_,_pZ_)},_pP_,prefix_dims),
       _pQ_=1,
       suffix_dims_product=
        fold_left$0
         (function(_pY_,_pX_){return caml_mul(_pY_,_pX_)},_pQ_,suffix_dims);
      function reshaper_fun(varr)
       {var
         old_shape=shape(varr),
         new_shape=
          [0,
           prefix_dims_product,
           caml_mul
            (caml_check_bound(old_shape,axis)[axis + 1],suffix_dims_product)];
        return caml_ba_reshape(varr,new_shape)}
      var
       reshaped_result=reshaper_fun(result_varr),
       reshaped_varrs=map$0(reshaper_fun,varrs),
       _pS_=prefix_dims_product - 1 | 0,
       _pR_=0;
      if(!(_pS_ < 0))
       {var i=_pR_;
        for(;;)
         {var
           start_index=[0,0],
           result_slice=caml_ba_slice(reshaped_result,[0,i]),
           _pU_=varrs_num - 1 | 0,
           _pT_=0;
          if(!(_pU_ < 0))
           {var j=_pT_;
            for(;;)
             {var
               src_slice=
                caml_ba_slice(caml_check_bound(reshaped_varrs,j)[j + 1],[0,i]),
               block_len=
                caml_mul
                 (caml_check_bound(caml_check_bound(all_dims,j)[j + 1],axis)
                   [axis + 1],
                  suffix_dims_product),
               result_sub=caml_ba_sub(result_slice,start_index[1],block_len);
              caml_ba_blit(src_slice,result_sub);
              start_index[1] = start_index[1] + block_len | 0;
              var _pW_=j + 1 | 0;
              if(_pU_ !== j){var j=_pW_;continue}
              break}}
          var _pV_=i + 1 | 0;
          if(_pS_ !== i){var i=_pV_;continue}
          break}}
      return result_varr}
    function repeat(opt,varr,reps)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var varrs=caml_make_vect(reps,varr);
      return concatenate([0,axis],varrs)}
    function abs$1(varr){return map$1(abs$0,varr)}
    function neg$0(varr){return map$1(neg,varr)}
    function floor$0(varr){return map$1(floor,varr)}
    function ceil$0(varr){return map$1(ceil,varr)}
    function round$0(varr){return map$1(round,varr)}
    function sqr$0(varr){return map$1(sqr,varr)}
    function sqrt$0(varr){return map$1(sqrt,varr)}
    function log$0(varr){return map$1(log,varr)}
    function log2$0(varr){return map$1(log2,varr)}
    function log10$0(varr){return map$1(log10,varr)}
    function exp$0(varr){return map$1(exp,varr)}
    function sin$0(varr){return map$1(sin,varr)}
    function cos$0(varr){return map$1(cos,varr)}
    function tan$0(varr){return map$1(tan,varr)}
    function sinh$0(varr){return map$1(sinh,varr)}
    function cosh$0(varr){return map$1(cosh,varr)}
    function tanh$0(varr){return map$1(tanh,varr)}
    function asin$0(varr){return map$1(asin,varr)}
    function acos$0(varr){return map$1(acos,varr)}
    function atan$0(varr){return map$1(atan,varr)}
    function asinh$0(varr){return map$1(asinh,varr)}
    function acosh$0(varr){return map$1(acosh,varr)}
    function atanh$0(varr){return map$1(atanh,varr)}
    function sum(opt,varr)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var old_dims=shape(varr),old_rank=old_dims.length - 1;
      if(0 === old_rank)return varr;
      var
       old_ind=caml_make_vect(old_rank,0),
       new_rank=old_rank - 1 | 0,
       new_dims=
        init
         (new_rank,
          function(i)
           {if(i < axis)return caml_check_bound(old_dims,i)[i + 1];
            var _pM_=i + 1 | 0;
            return caml_check_bound(old_dims,_pM_)[_pM_ + 1]}),
       new_varr=caml_ba_create(caml_ba_kind(varr),0,new_dims),
       new_ind=caml_make_vect(new_rank,0),
       should_stop=[0,0],
       sum=[0,0];
      for(;;)
       {if(should_stop[1])return new_varr;
        var _pF_=new_rank - 1 | 0,_pE_=0;
        if(!(_pF_ < 0))
         {var i$0=_pE_;
          for(;;)
           {var
             _pK_=caml_check_bound(new_ind,i$0)[i$0 + 1],
             i$1=i$0 < axis?i$0:i$0 + 1 | 0;
            caml_check_bound(old_ind,i$1)[i$1 + 1] = _pK_;
            var _pL_=i$0 + 1 | 0;
            if(_pF_ !== i$0){var i$0=_pL_;continue}
            break}}
        sum[1] = 0;
        var _pH_=caml_check_bound(old_dims,axis)[axis + 1] - 1 | 0,_pG_=0;
        if(!(_pH_ < 0))
         {var i=_pG_;
          for(;;)
           {caml_check_bound(old_ind,axis)[axis + 1] = i;
            var _pI_=caml_ba_get_generic(varr,old_ind);
            sum[1] = sum[1] + _pI_;
            var _pJ_=i + 1 | 0;
            if(_pH_ !== i){var i=_pJ_;continue}
            break}}
        caml_ba_set_generic(new_varr,new_ind,sum[1]);
        if(1 - next_index(new_ind,new_dims)){should_stop[1] = 1;continue}
        continue}}
    function sum_slices(opt,varr)
     {if(opt)var sth=opt[1],axis=sth;else var axis=0;
      var
       dims=shape(varr),
       rank=dims.length - 1,
       _pt_=sub$1(dims,0,axis + 1 | 0),
       _pu_=1,
       num_rows=
        fold_left$0(function(_pD_,_pC_){return caml_mul(_pD_,_pC_)},_pu_,_pt_),
       num_cols=caml_div(numel(varr),num_rows),
       varr_mat=caml_ba_reshape(varr,[0,num_rows,num_cols]),
       result_vec=caml_ba_create(caml_ba_kind(varr),0,[0,num_cols]),
       result_varr=
        caml_ba_reshape
         (result_vec,sub$1(dims,axis + 1 | 0,(rank - axis | 0) - 1 | 0)),
       row_sum=[0,0],
       _pw_=num_cols - 1 | 0,
       _pv_=0;
      if(!(_pw_ < 0))
       {var j=_pv_;
        for(;;)
         {row_sum[1] = 0;
          var _py_=num_rows - 1 | 0,_px_=0;
          if(!(_py_ < 0))
           {var i=_px_;
            for(;;)
             {var _pA_=caml_ba_get_generic(varr_mat,[0,i,j]);
              row_sum[1] = row_sum[1] + _pA_;
              var _pB_=i + 1 | 0;
              if(_py_ !== i){var i=_pB_;continue}
              break}}
          caml_ba_set_generic(result_vec,[0,j],row_sum[1]);
          var _pz_=j + 1 | 0;
          if(_pw_ !== j){var j=_pz_;continue}
          break}}
      return result_varr}
    function signum$0(varr){return map$1(signum,varr)}
    function sigmoid$0(varr){return map$1(sigmoid,varr)}
    function relu$0(varr){return map$1(relu,varr)}
    function fold_left$1(f,a,varr)
     {var
       aref=[0,a],
       varr_linear=array1_of_genarray(flatten(varr)),
       length=numel(varr),
       _pq_=length - 1 | 0,
       _pp_=0;
      if(!(_pq_ < 0))
       {var i=_pp_;
        for(;;)
         {var _pr_=caml_ba_get_1(varr_linear,i);
          aref[1] = caml_call2(f,aref[1],_pr_);
          var _ps_=i + 1 | 0;
          if(_pq_ !== i){var i=_ps_;continue}
          break}}
      return aref[1]}
    function min$0(varr){return fold_left$1(min,max_float,varr)}
    function max$0(varr){return fold_left$1(max,min_float,varr)}
    function sum$0(varr)
     {var _pm_=0;
      return fold_left$1(function(_po_,_pn_){return _po_ + _pn_},_pm_,varr)}
    function l1norm(varr)
     {function l1norm_fun(aggregate,elem){return aggregate + Math.abs(elem)}
      return fold_left$1(l1norm_fun,0,varr)}
    function l2norm_sqr(varr)
     {function l2norm_sqr_fun(aggregate,elem){return aggregate + elem * elem}
      return fold_left$1(l2norm_sqr_fun,0,varr)}
    function l2norm(varr)
     {var l2norm_sqr_val=l2norm_sqr(varr);return Math.sqrt(l2norm_sqr_val)}
    function scalar_pow(a,varr)
     {function scalar_pow_fun(x){return Math.pow(a,x)}
      return map$1(scalar_pow_fun,varr)}
    function pow_scalar(varr,a)
     {function pow_scalar_fun(x){return Math.pow(x,a)}
      return map$1(pow_scalar_fun,varr)}
    function scalar_atan2(a,varr)
     {function scalar_atan2_fun(x){return Math.atan2(a,x)}
      return map$1(scalar_atan2_fun,varr)}
    function atan2_scalar(varr,a)
     {function atan2_scalar_fun(x){return Math.atan2(x,a)}
      return map$1(atan2_scalar_fun,varr)}
    function broadcasted_op(varr_a,varr_b,op_fun)
     {var
       dims_b$0=shape(varr_b),
       dims_a$0=shape(varr_a),
       len_c=max(dims_a$0.length - 1,dims_b$0.length - 1),
       dims_a=prepend_dims(dims_a$0,len_c),
       dims_b=prepend_dims(dims_b$0,len_c),
       dims_c=caml_make_vect(len_c,0),
       _pi_=len_c - 1 | 0,
       _ph_=0;
      if(!(_pi_ < 0))
       {var i=_ph_;
        for(;;)
         {var
           val_a=caml_check_bound(dims_a,i)[i + 1],
           val_b=caml_check_bound(dims_b,i)[i + 1];
          if(val_a === val_b)
           caml_check_bound(dims_c,i)[i + 1] = val_a;
          else
           {if(1 !== val_a)if(1 !== val_b)throw [0,Invalid_argument,_hy_];
            var _pk_=max(val_a,val_b);
            caml_check_bound(dims_c,i)[i + 1] = _pk_}
          var _pj_=i + 1 | 0;
          if(_pi_ !== i){var i=_pj_;continue}
          break}}
      var
       kind=caml_ba_kind(varr_a),
       varr_a$0=caml_ba_reshape(varr_a,dims_a),
       varr_b$0=caml_ba_reshape(varr_b,dims_b),
       varr_c=caml_ba_create(kind,0,dims_c),
       ind=caml_make_vect(dims_c.length - 1,0),
       should_stop=[0,0];
      for(;;)
       {if(should_stop[1])return varr_c;
        var
         ind_a=get_broadcasted_index(ind,dims_a),
         ind_b=get_broadcasted_index(ind,dims_b),
         _pl_=caml_ba_get_generic(varr_b$0,ind_b);
        caml_ba_set_generic
         (varr_c,
          ind,
          caml_call2(op_fun,caml_ba_get_generic(varr_a$0,ind_a),_pl_));
        if(1 - next_index(ind,dims_c))should_stop[1] = 1;
        continue}}
    function add$1(varr_a,varr_b)
     {var op=add_elt(caml_ba_kind(varr_a));
      return broadcasted_op(varr_a,varr_b,op)}
    function sub$4(varr_a,varr_b)
     {var op=sub_elt(caml_ba_kind(varr_a));
      return broadcasted_op(varr_a,varr_b,op)}
    function mul$1(varr_a,varr_b)
     {var op=mul_elt(caml_ba_kind(varr_a));
      return broadcasted_op(varr_a,varr_b,op)}
    function div$1(varr_a,varr_b)
     {var op=div_elt(caml_ba_kind(varr_a));
      return broadcasted_op(varr_a,varr_b,op)}
    function atan2$0(varr_a,varr_b)
     {return broadcasted_op(varr_a,varr_b,atan2)}
    function pow$0(varr_a,varr_b)
     {return broadcasted_op
              (varr_a,varr_b,function(_pg_,_pf_){return Math.pow(_pg_,_pf_)})}
    function add_scalar(varr,a)
     {var op=add_elt(caml_ba_kind(varr));
      function add_scalar_fun(x){return caml_call2(op,x,a)}
      return map$1(add_scalar_fun,varr)}
    function sub_scalar(varr,a)
     {var op=sub_elt(caml_ba_kind(varr));
      function sub_scalar_fun(x){return caml_call2(op,x,a)}
      return map$1(sub_scalar_fun,varr)}
    function mul_scalar(varr,a)
     {var op=mul_elt(caml_ba_kind(varr));
      function mul_scalar_fun(x){return caml_call2(op,x,a)}
      return map$1(mul_scalar_fun,varr)}
    function div_scalar(varr,a)
     {var op=div_elt(caml_ba_kind(varr));
      function div_scalar_fun(x){return caml_call2(op,x,a)}
      return map$1(div_scalar_fun,varr)}
    function clip_by_value(opt,_pe_,varr)
     {if(opt)var sth=opt[1],amin=sth;else var amin=min_float;
      if(_pe_)var sth$0=_pe_[1],amax=sth$0;else var amax=max_float;
      function clip_by_val_fun(x){return min(amax,max(amin,x))}
      return map$1(clip_by_val_fun,varr)}
    function scalar_add(a,varr){return add_scalar(varr,a)}
    function scalar_sub(a,varr)
     {var op=sub_elt(caml_ba_kind(varr));
      function scalar_sub_fun(x){return caml_call2(op,a,x)}
      return map$1(scalar_sub_fun,varr)}
    function scalar_mul(a,varr){return mul_scalar(varr,a)}
    function scalar_div(a,varr)
     {var op=div_elt(caml_ba_kind(varr));
      function scalar_div_fun(x){return caml_call2(op,a,x)}
      return map$1(scalar_div_fun,varr)}
    function clip_by_l2norm(clip_norm,varr)
     {var l2norm_val=l2norm(varr);
      return clip_norm < l2norm_val
              ?mul_scalar(varr,clip_norm / l2norm_val)
              :varr}
    function compare_util_shortcircuit(varr_a,varr_b,comp_fun)
     {var n=numel(varr_a),m=numel(varr_b);
      if(n !== m)return 0;
      var
       varr_a$0=array1_of_genarray(flatten(varr_a)),
       varr_b$0=array1_of_genarray(flatten(varr_b)),
       all_ok=[0,1],
       i=[0,0];
      for(;;)
       {if(all_ok[1])
         if(i[1] < n)
          {var x=caml_ba_get_1(varr_a$0,i[1]),y=caml_ba_get_1(varr_b$0,i[1]);
           if(1 - caml_call2(comp_fun,x,y))all_ok[1] = 0;
           i[1] = i[1] + 1 | 0;
           continue}
        return all_ok[1]}}
    function approx_equal(eps$0,varr_a,varr_b)
     {if(eps$0)var eps$1=eps$0[1],eps$2=eps$1;else var eps$2=eps(0);
      function approx_equal_fun(x,y){return Math.abs(x - y) < eps$2?1:0}
      return compare_util_shortcircuit(varr_a,varr_b,approx_equal_fun)}
    function equal(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_equal)}
    function not_equal(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_notequal)}
    function less(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_lessthan)}
    function greater(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_greaterthan)}
    function less_equal(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_lessequal)}
    function greater_equal(varr_a,varr_b)
     {return compare_util_shortcircuit(varr_a,varr_b,caml_greaterequal)}
    function approx_equal_scalar(eps$0,varr_a$0,y)
     {if(eps$0)var eps$1=eps$0[1],eps$2=eps$1;else var eps$2=eps(0);
      var
       n=numel(varr_a$0),
       varr_a=array1_of_genarray(flatten(varr_a$0)),
       all_ok=[0,1],
       i=[0,0];
      for(;;)
       {if(all_ok[1])
         if(i[1] < n)
          {var x=caml_ba_get_1(varr_a,i[1]);
           if(1 - (Math.abs(x - y) < eps$2?1:0))all_ok[1] = 0;
           i[1] = i[1] + 1 | 0;
           continue}
        return all_ok[1]}}
    function elt_compare_util(varr_a,varr_b,one_fun)
     {var kind=caml_ba_kind(varr_a),c0=zero$0(kind),c1=one$0(kind);
      function comp_fun(x,y){return caml_call2(one_fun,x,y)?c1:c0}
      return broadcasted_op(varr_a,varr_b,comp_fun)}
    function elt_equal(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_equal)}
    function approx_elt_equal(eps$0,varr_a,varr_b)
     {if(eps$0)var eps$1=eps$0[1],eps$2=eps$1;else var eps$2=eps(0);
      function approx_equal_fun(x,y){return Math.abs(x - y) < eps$2?1:0}
      return elt_compare_util(varr_a,varr_b,approx_equal_fun)}
    function elt_not_equal(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_notequal)}
    function elt_less(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_lessthan)}
    function elt_greater(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_greaterthan)}
    function elt_less_equal(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_lessequal)}
    function elt_greater_equal(varr_a,varr_b)
     {return elt_compare_util(varr_a,varr_b,caml_greaterequal)}
    function elt_compare_scalar_util(varr_a,one_fun)
     {var kind=caml_ba_kind(varr_a),c0=zero$0(kind),c1=one$0(kind);
      function comp_fun(x){return caml_call1(one_fun,x)?c1:c0}
      return map$1(comp_fun,varr_a)}
    function elt_equal_scalar(varr_a,b)
     {function equal_scalar_fun(x){return caml_equal(x,b)}
      return elt_compare_scalar_util(varr_a,equal_scalar_fun)}
    function approx_elt_equal_scalar(eps$0,varr_a,b)
     {if(eps$0)var eps$1=eps$0[1],eps$2=eps$1;else var eps$2=eps(0);
      function approx_equal_scalar_fun(x){return Math.abs(x - b) < eps$2?1:0}
      return elt_compare_scalar_util(varr_a,approx_equal_scalar_fun)}
    function elt_not_equal_scalar(varr_a,b)
     {function not_equal_scalar_fun(x){return caml_notequal(x,b)}
      return elt_compare_scalar_util(varr_a,not_equal_scalar_fun)}
    function elt_less_scalar(varr_a,b)
     {function less_scalar_fun(x){return caml_lessthan(x,b)}
      return elt_compare_scalar_util(varr_a,less_scalar_fun)}
    function elt_greater_scalar(varr_a,b)
     {function greater_scalar_fun(x){return caml_greaterthan(x,b)}
      return elt_compare_scalar_util(varr_a,greater_scalar_fun)}
    function elt_less_equal_scalar(varr_a,b)
     {function less_equal_scalar_fun(x){return caml_lessequal(x,b)}
      return elt_compare_scalar_util(varr_a,less_equal_scalar_fun)}
    function elt_greater_equal_scalar(varr_a,b)
     {function greater_equal_scalar_fun(x){return caml_greaterthan(x,b)}
      return elt_compare_scalar_util(varr_a,greater_equal_scalar_fun)}
    function not_exists(f,varr$0)
     {var
       n=numel(varr$0),
       varr=array1_of_genarray(flatten(varr$0)),
       found=[0,0],
       i=[0,0];
      for(;;)
       {if(i[1] < n)
         if(!found[1])
          {var x=caml_ba_get_1(varr,i[1]);
           if(caml_call1(f,x))found[1] = 1;
           i[1] = i[1] + 1 | 0;
           continue}
        return 1 - found[1]}}
    function is_zero(varr)
     {var k=caml_ba_kind(varr),c0=zero$0(k);
      function non_zero_fun(x){return caml_notequal(x,c0)}
      return not_exists(non_zero_fun,varr)}
    function is_positive(varr)
     {var k=caml_ba_kind(varr),c0=zero$0(k);
      function non_positive_fun(x){return caml_lessequal(x,c0)}
      return not_exists(non_positive_fun,varr)}
    function is_negative(varr)
     {var k=caml_ba_kind(varr),c0=zero$0(k);
      function non_negative_fun(x){return caml_greaterequal(x,c0)}
      return not_exists(non_negative_fun,varr)}
    function is_nonpositive(varr)
     {var k=caml_ba_kind(varr),c0=zero$0(k);
      function positive_fun(x){return caml_greaterthan(x,c0)}
      return not_exists(positive_fun,varr)}
    function is_nonnegative(varr)
     {var k=caml_ba_kind(varr),c0=zero$0(k);
      function negative_fun(x){return caml_lessthan(x,c0)}
      return not_exists(negative_fun,varr)}
    function conv2d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(4 === num_dims(input))
       {if(4 === num_dims(kernel))
         {if(2 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             in_channel=caml_check_bound(input_shp,3)[4],
             kernel_shp=shape(kernel),
             kernel_cols=caml_check_bound(kernel_shp,0)[1],
             kernel_rows=caml_check_bound(kernel_shp,1)[2],
             out_channel=caml_check_bound(kernel_shp,3)[4];
            if(in_channel === caml_check_bound(kernel_shp,2)[3])
             {var
               col_stride=caml_check_bound(stride,0)[1],
               row_stride=caml_check_bound(stride,1)[2],
               match=
                calc_conv2d_output_shape
                 (padding,
                  input_cols,
                  input_rows,
                  kernel_cols,
                  kernel_rows,
                  row_stride,
                  col_stride),
               output_rows=match[2],
               output_cols=match[1],
               kind=caml_ba_kind(input),
               output=
                caml_ba_create
                 (kind,0,[0,batches,output_cols,output_rows,out_channel]),
               match$0=
                calc_conv2d_padding
                 (input_cols,
                  input_rows,
                  kernel_cols,
                  kernel_rows,
                  output_cols,
                  output_rows,
                  row_stride,
                  col_stride),
               pad_left=match$0[2],
               pad_top=match$0[1],
               sum=[0,0],
               _oV_=batches - 1 | 0,
               _oU_=0;
              if(!(_oV_ < 0))
               {var b=_oU_;
                for(;;)
                 {var _oX_=output_cols - 1 | 0,_oW_=0;
                  if(!(_oX_ < 0))
                   {var i=_oW_;
                    for(;;)
                     {var _o0_=output_rows - 1 | 0,_oZ_=0;
                      if(!(_o0_ < 0))
                       {var j=_oZ_;
                        for(;;)
                         {var _o3_=out_channel - 1 | 0,_o2_=0;
                          if(!(_o3_ < 0))
                           {var k=_o2_;
                            for(;;)
                             {sum[1] = 0;
                              var _o6_=kernel_cols - 1 | 0,_o5_=0;
                              if(!(_o6_ < 0))
                               {var di=_o5_;
                                for(;;)
                                 {var _o9_=kernel_rows - 1 | 0,_o8_=0;
                                  if(!(_o9_ < 0))
                                   {var dj=_o8_;
                                    for(;;)
                                     {var _pa_=in_channel - 1 | 0,_o$_=0;
                                      if(!(_pa_ < 0))
                                       {var q=_o$_;
                                        for(;;)
                                         {var
                                           in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                           in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0;
                                          if(0 <= in_col)
                                           if(in_col < input_cols)
                                            if(0 <= in_row)
                                             if(in_row < input_rows)
                                              var
                                               in_val=caml_ba_get_generic(input,[0,b,in_col,in_row,q]),
                                               switch$0=1;
                                             else
                                              var switch$0=0;
                                            else
                                             var switch$0=0;
                                           else
                                            var switch$0=0;
                                          else
                                           var switch$0=0;
                                          if(!switch$0)var in_val=0;
                                          var _pc_=in_val * caml_ba_get_generic(kernel,[0,di,dj,q,k]);
                                          sum[1] = sum[1] + _pc_;
                                          var _pd_=q + 1 | 0;
                                          if(_pa_ !== q){var q=_pd_;continue}
                                          break}}
                                      var _pb_=dj + 1 | 0;
                                      if(_o9_ !== dj){var dj=_pb_;continue}
                                      break}}
                                  var _o__=di + 1 | 0;
                                  if(_o6_ !== di){var di=_o__;continue}
                                  break}}
                              caml_ba_set_generic(output,[0,b,i,j,k],sum[1]);
                              var _o7_=k + 1 | 0;
                              if(_o3_ !== k){var k=_o7_;continue}
                              break}}
                          var _o4_=j + 1 | 0;
                          if(_o0_ !== j){var j=_o4_;continue}
                          break}}
                      var _o1_=i + 1 | 0;
                      if(_oX_ !== i){var i=_o1_;continue}
                      break}}
                  var _oY_=b + 1 | 0;
                  if(_oV_ !== b){var b=_oY_;continue}
                  break}}
              return output}
            throw [0,Assert_failure,_hF_]}
          throw [0,Assert_failure,_hG_]}
        throw [0,Assert_failure,_hH_]}
      throw [0,Assert_failure,_hI_]}
    function conv1d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(3 === num_dims(input))
       {if(3 === num_dims(kernel))
         {if(1 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             in_channel=caml_check_bound(input_shp,2)[3],
             input$0=
              caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
             kernel_shp=shape(kernel),
             kernel_cols=caml_check_bound(kernel_shp,0)[1],
             out_channel=caml_check_bound(kernel_shp,2)[3];
            if(in_channel === caml_check_bound(kernel_shp,1)[2])
             {var
               kernel$0=
                caml_ba_reshape
                 (kernel,[0,1,kernel_cols,in_channel,out_channel]),
               col_stride=caml_check_bound(stride,0)[1],
               stride$0=[0,1,col_stride],
               output=conv2d([0,padding],input$0,kernel$0,stride$0),
               output_shp=shape(output),
               output_cols=caml_check_bound(output_shp,2)[3],
               output$0=
                caml_ba_reshape(output,[0,batches,output_cols,out_channel]);
              return output$0}
            throw [0,Assert_failure,_hJ_]}
          throw [0,Assert_failure,_hK_]}
        throw [0,Assert_failure,_hL_]}
      throw [0,Assert_failure,_hM_]}
    function conv3d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(5 === num_dims(input))
       {if(5 === num_dims(kernel))
         {if(3 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             input_dpts=caml_check_bound(input_shp,3)[4],
             in_channel=caml_check_bound(input_shp,4)[5],
             kernel_shp=shape(kernel),
             kernel_cols=caml_check_bound(kernel_shp,0)[1],
             kernel_rows=caml_check_bound(kernel_shp,1)[2],
             kernel_dpts=caml_check_bound(kernel_shp,2)[3],
             out_channel=caml_check_bound(kernel_shp,4)[5];
            if(in_channel === caml_check_bound(kernel_shp,3)[4])
             {var
               col_stride=caml_check_bound(stride,0)[1],
               row_stride=caml_check_bound(stride,1)[2],
               dpt_stride=caml_check_bound(stride,2)[3],
               match=
                calc_conv3d_output_shape
                 (padding,
                  input_cols,
                  input_rows,
                  input_dpts,
                  kernel_cols,
                  kernel_rows,
                  kernel_dpts,
                  row_stride,
                  col_stride,
                  dpt_stride),
               output_dpts=match[3],
               output_rows=match[2],
               output_cols=match[1],
               kind=caml_ba_kind(input),
               output=
                caml_ba_create
                 (kind,
                  0,
                  [0,batches,output_cols,output_rows,output_dpts,out_channel]),
               match$0=
                calc_conv3d_padding
                 (input_cols,
                  input_rows,
                  input_dpts,
                  kernel_cols,
                  kernel_rows,
                  kernel_dpts,
                  output_cols,
                  output_rows,
                  output_dpts,
                  row_stride,
                  col_stride,
                  dpt_stride),
               pad_shallow=match$0[3],
               pad_left=match$0[2],
               pad_top=match$0[1],
               sum=[0,0],
               _ot_=batches - 1 | 0,
               _os_=0;
              if(!(_ot_ < 0))
               {var b=_os_;
                for(;;)
                 {var _ov_=output_cols - 1 | 0,_ou_=0;
                  if(!(_ov_ < 0))
                   {var i=_ou_;
                    for(;;)
                     {var _oy_=output_rows - 1 | 0,_ox_=0;
                      if(!(_oy_ < 0))
                       {var j=_ox_;
                        for(;;)
                         {var _oB_=output_dpts - 1 | 0,_oA_=0;
                          if(!(_oB_ < 0))
                           {var dpt=_oA_;
                            for(;;)
                             {var _oE_=out_channel - 1 | 0,_oD_=0;
                              if(!(_oE_ < 0))
                               {var k=_oD_;
                                for(;;)
                                 {sum[1] = 0;
                                  var _oH_=kernel_cols - 1 | 0,_oG_=0;
                                  if(!(_oH_ < 0))
                                   {var di=_oG_;
                                    for(;;)
                                     {var _oK_=kernel_rows - 1 | 0,_oJ_=0;
                                      if(!(_oK_ < 0))
                                       {var dj=_oJ_;
                                        for(;;)
                                         {var _oN_=kernel_dpts - 1 | 0,_oM_=0;
                                          if(!(_oN_ < 0))
                                           {var d_dpt=_oM_;
                                            for(;;)
                                             {var _oQ_=in_channel - 1 | 0,_oP_=0;
                                              if(!(_oQ_ < 0))
                                               {var q=_oP_;
                                                for(;;)
                                                 {var
                                                   in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                                   in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                                   in_dpt=
                                                    (caml_mul(dpt,dpt_stride) + d_dpt | 0)
                                                    -
                                                    pad_shallow
                                                    |
                                                    0;
                                                  if(0 <= in_col)
                                                   if(in_col < input_cols)
                                                    if(0 <= in_row)
                                                     if(in_row < input_rows)
                                                      if(0 <= in_dpt)
                                                       if(in_dpt < input_dpts)
                                                        var
                                                         in_val=
                                                          caml_ba_get_generic(input,[0,b,in_col,in_row,in_dpt,q]),
                                                         switch$0=1;
                                                       else
                                                        var switch$0=0;
                                                      else
                                                       var switch$0=0;
                                                     else
                                                      var switch$0=0;
                                                    else
                                                     var switch$0=0;
                                                   else
                                                    var switch$0=0;
                                                  else
                                                   var switch$0=0;
                                                  if(!switch$0)var in_val=0;
                                                  var
                                                   _oS_=
                                                    in_val * caml_ba_get_generic(kernel,[0,di,dj,d_dpt,q,k]);
                                                  sum[1] = sum[1] + _oS_;
                                                  var _oT_=q + 1 | 0;
                                                  if(_oQ_ !== q){var q=_oT_;continue}
                                                  break}}
                                              var _oR_=d_dpt + 1 | 0;
                                              if(_oN_ !== d_dpt){var d_dpt=_oR_;continue}
                                              break}}
                                          var _oO_=dj + 1 | 0;
                                          if(_oK_ !== dj){var dj=_oO_;continue}
                                          break}}
                                      var _oL_=di + 1 | 0;
                                      if(_oH_ !== di){var di=_oL_;continue}
                                      break}}
                                  caml_ba_set_generic(output,[0,b,i,j,dpt,k],sum[1]);
                                  var _oI_=k + 1 | 0;
                                  if(_oE_ !== k){var k=_oI_;continue}
                                  break}}
                              var _oF_=dpt + 1 | 0;
                              if(_oB_ !== dpt){var dpt=_oF_;continue}
                              break}}
                          var _oC_=j + 1 | 0;
                          if(_oy_ !== j){var j=_oC_;continue}
                          break}}
                      var _oz_=i + 1 | 0;
                      if(_ov_ !== i){var i=_oz_;continue}
                      break}}
                  var _ow_=b + 1 | 0;
                  if(_ot_ !== b){var b=_ow_;continue}
                  break}}
              return output}
            throw [0,Assert_failure,_hN_]}
          throw [0,Assert_failure,_hO_]}
        throw [0,Assert_failure,_hP_]}
      throw [0,Assert_failure,_hQ_]}
    function pool2d
     (opt,input,kernel,stride,init_pool_fun,add_val_pool_fun,end_pool_fun)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(4 === num_dims(input))
       {if(2 === kernel.length - 1)
         {if(2 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             in_channel=caml_check_bound(input_shp,3)[4],
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel_rows=caml_check_bound(kernel,1)[2],
             col_stride=caml_check_bound(stride,0)[1],
             row_stride=caml_check_bound(stride,1)[2],
             match=
              calc_conv2d_output_shape
               (padding,
                input_cols,
                input_rows,
                kernel_cols,
                kernel_rows,
                row_stride,
                col_stride),
             output_rows=match[2],
             output_cols=match[1],
             kind=caml_ba_kind(input),
             output=
              caml_ba_create
               (kind,0,[0,batches,output_cols,output_rows,in_channel]),
             match$0=
              calc_conv2d_padding
               (input_cols,
                input_rows,
                kernel_cols,
                kernel_rows,
                output_cols,
                output_rows,
                row_stride,
                col_stride),
             pad_left=match$0[2],
             pad_top=match$0[1],
             _n9_=batches - 1 | 0,
             _n8_=0;
            if(!(_n9_ < 0))
             {var b=_n8_;
              for(;;)
               {var _n$_=output_cols - 1 | 0,_n__=0;
                if(!(_n$_ < 0))
                 {var i=_n__;
                  for(;;)
                   {var _oc_=output_rows - 1 | 0,_ob_=0;
                    if(!(_oc_ < 0))
                     {var j=_ob_;
                      for(;;)
                       {var _of_=in_channel - 1 | 0,_oe_=0;
                        if(!(_of_ < 0))
                         {var k=_oe_;
                          for(;;)
                           {caml_call1(init_pool_fun,0);
                            var _oi_=kernel_cols - 1 | 0,_oh_=0;
                            if(!(_oi_ < 0))
                             {var di=_oh_;
                              for(;;)
                               {var _ol_=kernel_rows - 1 | 0,_ok_=0;
                                if(!(_ol_ < 0))
                                 {var dj=_ok_;
                                  for(;;)
                                   {var
                                     in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                     in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                     _on_=0 <= in_col?1:0;
                                    if(_on_)
                                     {var _oo_=in_col < input_cols?1:0;
                                      if(_oo_)
                                       var
                                        _op_=0 <= in_row?1:0,
                                        _oq_=_op_?in_row < input_rows?1:0:_op_;
                                      else
                                       var _oq_=_oo_}
                                    else
                                     var _oq_=_on_;
                                    if(_oq_)
                                     caml_call1
                                      (add_val_pool_fun,
                                       caml_ba_get_generic(input,[0,b,in_col,in_row,k]));
                                    var _or_=dj + 1 | 0;
                                    if(_ol_ !== dj){var dj=_or_;continue}
                                    break}}
                                var _om_=di + 1 | 0;
                                if(_oi_ !== di){var di=_om_;continue}
                                break}}
                            caml_ba_set_generic
                             (output,[0,b,i,j,k],caml_call1(end_pool_fun,0));
                            var _oj_=k + 1 | 0;
                            if(_of_ !== k){var k=_oj_;continue}
                            break}}
                        var _og_=j + 1 | 0;
                        if(_oc_ !== j){var j=_og_;continue}
                        break}}
                    var _od_=i + 1 | 0;
                    if(_n$_ !== i){var i=_od_;continue}
                    break}}
                var _oa_=b + 1 | 0;
                if(_n9_ !== b){var b=_oa_;continue}
                break}}
            return output}
          throw [0,Assert_failure,_hR_]}
        throw [0,Assert_failure,_hS_]}
      throw [0,Assert_failure,_hT_]}
    function pool3d
     (opt,input,kernel,stride,init_pool_fun,add_val_pool_fun,end_pool_fun)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(5 === num_dims(input))
       {if(3 === kernel.length - 1)
         {if(3 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             input_dpts=caml_check_bound(input_shp,3)[4],
             in_channel=caml_check_bound(input_shp,4)[5],
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel_rows=caml_check_bound(kernel,1)[2],
             kernel_dpts=caml_check_bound(kernel,2)[3],
             col_stride=caml_check_bound(stride,0)[1],
             row_stride=caml_check_bound(stride,1)[2],
             dpt_stride=caml_check_bound(stride,2)[3],
             match=
              calc_conv3d_output_shape
               (padding,
                input_cols,
                input_rows,
                input_dpts,
                kernel_cols,
                kernel_rows,
                kernel_dpts,
                row_stride,
                col_stride,
                dpt_stride),
             output_dpts=match[3],
             output_rows=match[2],
             output_cols=match[1],
             kind=caml_ba_kind(input),
             output=
              caml_ba_create
               (kind,
                0,
                [0,batches,output_cols,output_rows,output_dpts,in_channel]),
             match$0=
              calc_conv3d_padding
               (input_cols,
                input_rows,
                input_dpts,
                kernel_cols,
                kernel_rows,
                kernel_dpts,
                output_cols,
                output_rows,
                output_dpts,
                row_stride,
                col_stride,
                dpt_stride),
             pad_shallow=match$0[3],
             pad_left=match$0[2],
             pad_top=match$0[1],
             _nF_=batches - 1 | 0,
             _nE_=0;
            if(!(_nF_ < 0))
             {var b=_nE_;
              for(;;)
               {var _nH_=output_cols - 1 | 0,_nG_=0;
                if(!(_nH_ < 0))
                 {var i=_nG_;
                  for(;;)
                   {var _nK_=output_rows - 1 | 0,_nJ_=0;
                    if(!(_nK_ < 0))
                     {var j=_nJ_;
                      for(;;)
                       {var _nN_=output_dpts - 1 | 0,_nM_=0;
                        if(!(_nN_ < 0))
                         {var dpt=_nM_;
                          for(;;)
                           {var _nQ_=in_channel - 1 | 0,_nP_=0;
                            if(!(_nQ_ < 0))
                             {var k=_nP_;
                              for(;;)
                               {caml_call1(init_pool_fun,0);
                                var _nT_=kernel_cols - 1 | 0,_nS_=0;
                                if(!(_nT_ < 0))
                                 {var di=_nS_;
                                  for(;;)
                                   {var _nW_=kernel_rows - 1 | 0,_nV_=0;
                                    if(!(_nW_ < 0))
                                     {var dj=_nV_;
                                      for(;;)
                                       {var _nZ_=kernel_dpts - 1 | 0,_nY_=0;
                                        if(!(_nZ_ < 0))
                                         {var d_dpt=_nY_;
                                          for(;;)
                                           {var
                                             in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                             in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                             in_dpt=
                                              (caml_mul(dpt,dpt_stride) + d_dpt | 0)
                                              -
                                              pad_shallow
                                              |
                                              0,
                                             _n1_=0 <= in_col?1:0;
                                            if(_n1_)
                                             {var _n2_=in_col < input_cols?1:0;
                                              if(_n2_)
                                               {var _n3_=0 <= in_row?1:0;
                                                if(_n3_)
                                                 {var _n4_=in_row < input_rows?1:0;
                                                  if(_n4_)
                                                   var
                                                    _n5_=0 <= in_dpt?1:0,
                                                    _n6_=_n5_?in_dpt < input_dpts?1:0:_n5_;
                                                  else
                                                   var _n6_=_n4_}
                                                else
                                                 var _n6_=_n3_}
                                              else
                                               var _n6_=_n2_}
                                            else
                                             var _n6_=_n1_;
                                            if(_n6_)
                                             caml_call1
                                              (add_val_pool_fun,
                                               caml_ba_get_generic(input,[0,b,in_col,in_row,in_dpt,k]));
                                            var _n7_=d_dpt + 1 | 0;
                                            if(_nZ_ !== d_dpt){var d_dpt=_n7_;continue}
                                            break}}
                                        var _n0_=dj + 1 | 0;
                                        if(_nW_ !== dj){var dj=_n0_;continue}
                                        break}}
                                    var _nX_=di + 1 | 0;
                                    if(_nT_ !== di){var di=_nX_;continue}
                                    break}}
                                caml_ba_set_generic
                                 (output,[0,b,i,j,dpt,k],caml_call1(end_pool_fun,0));
                                var _nU_=k + 1 | 0;
                                if(_nQ_ !== k){var k=_nU_;continue}
                                break}}
                            var _nR_=dpt + 1 | 0;
                            if(_nN_ !== dpt){var dpt=_nR_;continue}
                            break}}
                        var _nO_=j + 1 | 0;
                        if(_nK_ !== j){var j=_nO_;continue}
                        break}}
                    var _nL_=i + 1 | 0;
                    if(_nH_ !== i){var i=_nL_;continue}
                    break}}
                var _nI_=b + 1 | 0;
                if(_nF_ !== b){var b=_nI_;continue}
                break}}
            return output}
          throw [0,Assert_failure,_hU_]}
        throw [0,Assert_failure,_hV_]}
      throw [0,Assert_failure,_hW_]}
    function max_pool2d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      var max_pool=[0,0];
      function init_pool_fun(param){max_pool[1] = min_float;return 0}
      function add_val_pool_fun(v){max_pool[1] = max(max_pool[1],v);return 0}
      function end_pool_fun(param){return max_pool[1]}
      return pool2d
              ([0,padding],
               input,
               kernel,
               stride,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun)}
    function max_pool1d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(3 === num_dims(input))
       {if(1 === kernel.length - 1)
         {if(1 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             in_channel=caml_check_bound(input_shp,2)[3],
             input$0=
              caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel$0=[0,1,kernel_cols],
             col_stride=caml_check_bound(stride,0)[1],
             stride$0=[0,1,col_stride],
             output=max_pool2d([0,padding],input$0,kernel$0,stride$0),
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,2)[3],
             output$0=
              caml_ba_reshape(output,[0,batches,output_cols,in_channel]);
            return output$0}
          throw [0,Assert_failure,_hX_]}
        throw [0,Assert_failure,_hY_]}
      throw [0,Assert_failure,_hZ_]}
    function max_pool3d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      var max_pool=[0,0];
      function init_pool_fun(param){max_pool[1] = min_float;return 0}
      function add_val_pool_fun(v){max_pool[1] = max(max_pool[1],v);return 0}
      function end_pool_fun(param){return max_pool[1]}
      return pool3d
              ([0,padding],
               input,
               kernel,
               stride,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun)}
    function avg_pool2d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      var sum_pool=[0,0],cnt=[0,0];
      function init_pool_fun(param){sum_pool[1] = 0;cnt[1] = 0;return 0}
      function add_val_pool_fun(v)
       {sum_pool[1] = sum_pool[1] + v;cnt[1] = cnt[1] + 1;return 0}
      function end_pool_fun(param){return sum_pool[1] / cnt[1]}
      return pool2d
              ([0,padding],
               input,
               kernel,
               stride,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun)}
    function avg_pool1d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      if(3 === num_dims(input))
       {if(1 === kernel.length - 1)
         {if(1 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             in_channel=caml_check_bound(input_shp,2)[3],
             input$0=
              caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel$0=[0,1,kernel_cols],
             col_stride=caml_check_bound(stride,0)[1],
             stride$0=[0,1,col_stride],
             output=avg_pool2d([0,padding],input$0,kernel$0,stride$0),
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,2)[3],
             output$0=
              caml_ba_reshape(output,[0,batches,output_cols,in_channel]);
            return output$0}
          throw [0,Assert_failure,_h0_]}
        throw [0,Assert_failure,_h1_]}
      throw [0,Assert_failure,_h2_]}
    function avg_pool3d(opt,input,kernel,stride)
     {if(opt)var sth=opt[1],padding=sth;else var padding=0;
      var sum_pool=[0,0],cnt=[0,0];
      function init_pool_fun(param){sum_pool[1] = 0;cnt[1] = 0;return 0}
      function add_val_pool_fun(v)
       {sum_pool[1] = sum_pool[1] + v;cnt[1] = cnt[1] + 1;return 0}
      function end_pool_fun(param){return sum_pool[1] / cnt[1]}
      return pool3d
              ([0,padding],
               input,
               kernel,
               stride,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun)}
    function conv2d_backward_input(input,kernel,stride,output)
     {if(4 === num_dims(input))
       {if(4 === num_dims(kernel))
         {if(4 === num_dims(output))
           {if(2 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               input_rows=caml_check_bound(input_shp,2)[3],
               in_channel=caml_check_bound(input_shp,3)[4],
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               kernel_rows=caml_check_bound(kernel_shp,1)[2],
               out_channel=caml_check_bound(kernel_shp,3)[4];
              if(in_channel === caml_check_bound(kernel_shp,2)[3])
               {var
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2],
                 output_rows=caml_check_bound(output_shp,2)[3];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,3)[4])
                   {var
                     col_stride=caml_check_bound(stride,0)[1],
                     row_stride=caml_check_bound(stride,1)[2],
                     _nc_=shape(input),
                     input$0=caml_ba_create(caml_ba_kind(input),0,_nc_),
                     match=
                      calc_conv2d_padding
                       (input_cols,
                        input_rows,
                        kernel_cols,
                        kernel_rows,
                        output_cols,
                        output_rows,
                        row_stride,
                        col_stride),
                     pad_left=match[2],
                     pad_top=match[1],
                     _ne_=batches - 1 | 0,
                     _nd_=0;
                    if(!(_ne_ < 0))
                     {var b=_nd_;
                      for(;;)
                       {var _ng_=input_cols - 1 | 0,_nf_=0;
                        if(!(_ng_ < 0))
                         {var in_i=_nf_;
                          for(;;)
                           {var _nj_=input_rows - 1 | 0,_ni_=0;
                            if(!(_nj_ < 0))
                             {var in_j=_ni_;
                              for(;;)
                               {var _nm_=in_channel - 1 | 0,_nl_=0;
                                if(!(_nm_ < 0))
                                 {var q=_nl_;
                                  for(;;)
                                   {var sum=[0,0],_np_=kernel_cols - 1 | 0,_no_=0;
                                    if(!(_np_ < 0))
                                     {var di=_no_;
                                      for(;;)
                                       {var _ns_=kernel_rows - 1 | 0,_nr_=0;
                                        if(!(_ns_ < 0))
                                         {var dj=_nr_;
                                          for(;;)
                                           {var
                                             _nu_=
                                              0 === caml_mod((in_i + pad_left | 0) - di | 0,col_stride)
                                               ?1
                                               :0,
                                             _nv_=
                                              _nu_
                                               ?0 === caml_mod((in_j + pad_top | 0) - dj | 0,row_stride)
                                                 ?1
                                                 :0
                                               :_nu_;
                                            if(_nv_)
                                             {var
                                               out_col=caml_div((in_i + pad_left | 0) - di | 0,col_stride),
                                               out_row=caml_div((in_j + pad_top | 0) - dj | 0,row_stride),
                                               _nw_=0 <= out_col?1:0;
                                              if(_nw_)
                                               {var _nx_=out_col < output_cols?1:0;
                                                if(_nx_)
                                                 var
                                                  _ny_=0 <= out_row?1:0,
                                                  _nz_=_ny_?out_row < output_rows?1:0:_ny_;
                                                else
                                                 var _nz_=_nx_}
                                              else
                                               var _nz_=_nw_;
                                              if(_nz_)
                                               {var _nB_=out_channel - 1 | 0,_nA_=0;
                                                if(!(_nB_ < 0))
                                                 {var k=_nA_;
                                                  for(;;)
                                                   {var
                                                     out_grad=caml_ba_get_generic(output,[0,b,out_col,out_row,k]),
                                                     kernel_val=caml_ba_get_generic(kernel,[0,di,dj,q,k]);
                                                    sum[1] = sum[1] + out_grad * kernel_val;
                                                    var _nD_=k + 1 | 0;
                                                    if(_nB_ !== k){var k=_nD_;continue}
                                                    break}}}}
                                            var _nC_=dj + 1 | 0;
                                            if(_ns_ !== dj){var dj=_nC_;continue}
                                            break}}
                                        var _nt_=di + 1 | 0;
                                        if(_np_ !== di){var di=_nt_;continue}
                                        break}}
                                    caml_ba_set_generic(input$0,[0,b,in_i,in_j,q],sum[1]);
                                    var _nq_=q + 1 | 0;
                                    if(_nm_ !== q){var q=_nq_;continue}
                                    break}}
                                var _nn_=in_j + 1 | 0;
                                if(_nj_ !== in_j){var in_j=_nn_;continue}
                                break}}
                            var _nk_=in_i + 1 | 0;
                            if(_ng_ !== in_i){var in_i=_nk_;continue}
                            break}}
                        var _nh_=b + 1 | 0;
                        if(_ne_ !== b){var b=_nh_;continue}
                        break}}
                    return input$0}
                  throw [0,Assert_failure,_h3_]}
                throw [0,Assert_failure,_h4_]}
              throw [0,Assert_failure,_h5_]}
            throw [0,Assert_failure,_h6_]}
          throw [0,Assert_failure,_h7_]}
        throw [0,Assert_failure,_h8_]}
      throw [0,Assert_failure,_h9_]}
    function conv2d_backward_kernel(input,kernel,stride,output)
     {if(4 === num_dims(input))
       {if(4 === num_dims(kernel))
         {if(4 === num_dims(output))
           {if(2 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               input_rows=caml_check_bound(input_shp,2)[3],
               in_channel=caml_check_bound(input_shp,3)[4],
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               kernel_rows=caml_check_bound(kernel_shp,1)[2],
               out_channel=caml_check_bound(kernel_shp,3)[4];
              if(in_channel === caml_check_bound(kernel_shp,2)[3])
               {var
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2],
                 output_rows=caml_check_bound(output_shp,2)[3];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,3)[4])
                   {var
                     col_stride=caml_check_bound(stride,0)[1],
                     row_stride=caml_check_bound(stride,1)[2],
                     _mO_=shape(kernel),
                     kernel$0=caml_ba_create(caml_ba_kind(kernel),0,_mO_),
                     match=
                      calc_conv2d_padding
                       (input_cols,
                        input_rows,
                        kernel_cols,
                        kernel_rows,
                        output_cols,
                        output_rows,
                        row_stride,
                        col_stride),
                     pad_left=match[2],
                     pad_top=match[1],
                     _mQ_=kernel_cols - 1 | 0,
                     _mP_=0;
                    if(!(_mQ_ < 0))
                     {var di=_mP_;
                      for(;;)
                       {var _mS_=kernel_rows - 1 | 0,_mR_=0;
                        if(!(_mS_ < 0))
                         {var dj=_mR_;
                          for(;;)
                           {var _mV_=in_channel - 1 | 0,_mU_=0;
                            if(!(_mV_ < 0))
                             {var q=_mU_;
                              for(;;)
                               {var _mY_=out_channel - 1 | 0,_mX_=0;
                                if(!(_mY_ < 0))
                                 {var k=_mX_;
                                  for(;;)
                                   {var sum=[0,0],_m1_=batches - 1 | 0,_m0_=0;
                                    if(!(_m1_ < 0))
                                     {var b=_m0_;
                                      for(;;)
                                       {var _m4_=output_cols - 1 | 0,_m3_=0;
                                        if(!(_m4_ < 0))
                                         {var i=_m3_;
                                          for(;;)
                                           {var _m7_=output_rows - 1 | 0,_m6_=0;
                                            if(!(_m7_ < 0))
                                             {var j=_m6_;
                                              for(;;)
                                               {var
                                                 in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                                 in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                                 _m9_=0 <= in_col?1:0;
                                                if(_m9_)
                                                 {var _m__=in_col < input_cols?1:0;
                                                  if(_m__)
                                                   var
                                                    _m$_=0 <= in_row?1:0,
                                                    _na_=_m$_?in_row < input_rows?1:0:_m$_;
                                                  else
                                                   var _na_=_m__}
                                                else
                                                 var _na_=_m9_;
                                                if(_na_)
                                                 {var
                                                   out_grad=caml_ba_get_generic(output,[0,b,i,j,k]),
                                                   input_val=caml_ba_get_generic(input,[0,b,in_col,in_row,q]);
                                                  sum[1] = sum[1] + out_grad * input_val}
                                                var _nb_=j + 1 | 0;
                                                if(_m7_ !== j){var j=_nb_;continue}
                                                break}}
                                            var _m8_=i + 1 | 0;
                                            if(_m4_ !== i){var i=_m8_;continue}
                                            break}}
                                        var _m5_=b + 1 | 0;
                                        if(_m1_ !== b){var b=_m5_;continue}
                                        break}}
                                    caml_ba_set_generic(kernel$0,[0,di,dj,q,k],sum[1]);
                                    var _m2_=k + 1 | 0;
                                    if(_mY_ !== k){var k=_m2_;continue}
                                    break}}
                                var _mZ_=q + 1 | 0;
                                if(_mV_ !== q){var q=_mZ_;continue}
                                break}}
                            var _mW_=dj + 1 | 0;
                            if(_mS_ !== dj){var dj=_mW_;continue}
                            break}}
                        var _mT_=di + 1 | 0;
                        if(_mQ_ !== di){var di=_mT_;continue}
                        break}}
                    return kernel$0}
                  throw [0,Assert_failure,_h__]}
                throw [0,Assert_failure,_h$_]}
              throw [0,Assert_failure,_ia_]}
            throw [0,Assert_failure,_ib_]}
          throw [0,Assert_failure,_ic_]}
        throw [0,Assert_failure,_id_]}
      throw [0,Assert_failure,_ie_]}
    function conv1d_backward_input(input,kernel,stride,output)
     {if(3 === num_dims(input))
       {if(3 === num_dims(kernel))
         {if(3 === num_dims(output))
           {if(1 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               in_channel=caml_check_bound(input_shp,2)[3],
               input$0=
                caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               out_channel=caml_check_bound(kernel_shp,2)[3];
              if(in_channel === caml_check_bound(kernel_shp,1)[2])
               {var
                 kernel$0=
                  caml_ba_reshape
                   (kernel,[0,1,kernel_cols,in_channel,out_channel]),
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,2)[3])
                   {var
                     output$0=
                      caml_ba_reshape
                       (output,[0,batches,1,output_cols,out_channel]),
                     col_stride=caml_check_bound(stride,0)[1],
                     stride$0=[0,1,col_stride],
                     input$1=
                      conv2d_backward_input(input$0,kernel$0,stride$0,output$0);
                    return caml_ba_reshape(input$1,input_shp)}
                  throw [0,Assert_failure,_if_]}
                throw [0,Assert_failure,_ig_]}
              throw [0,Assert_failure,_ih_]}
            throw [0,Assert_failure,_ii_]}
          throw [0,Assert_failure,_ij_]}
        throw [0,Assert_failure,_ik_]}
      throw [0,Assert_failure,_il_]}
    function conv1d_backward_kernel(input,kernel,stride,output)
     {if(3 === num_dims(input))
       {if(3 === num_dims(kernel))
         {if(3 === num_dims(output))
           {if(1 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               in_channel=caml_check_bound(input_shp,2)[3],
               input$0=
                caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               out_channel=caml_check_bound(kernel_shp,2)[3];
              if(in_channel === caml_check_bound(kernel_shp,1)[2])
               {var
                 kernel$0=
                  caml_ba_reshape
                   (kernel,[0,1,kernel_cols,in_channel,out_channel]),
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,2)[3])
                   {var
                     output$0=
                      caml_ba_reshape
                       (output,[0,batches,1,output_cols,out_channel]),
                     col_stride=caml_check_bound(stride,0)[1],
                     stride$0=[0,1,col_stride],
                     kernel$1=
                      conv2d_backward_kernel(input$0,kernel$0,stride$0,output$0);
                    return caml_ba_reshape(kernel$1,kernel_shp)}
                  throw [0,Assert_failure,_im_]}
                throw [0,Assert_failure,_in_]}
              throw [0,Assert_failure,_io_]}
            throw [0,Assert_failure,_ip_]}
          throw [0,Assert_failure,_iq_]}
        throw [0,Assert_failure,_ir_]}
      throw [0,Assert_failure,_is_]}
    function conv3d_backward_input(input,kernel,stride,output)
     {if(5 === num_dims(input))
       {if(5 === num_dims(kernel))
         {if(5 === num_dims(output))
           {if(3 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               input_rows=caml_check_bound(input_shp,2)[3],
               input_dpts=caml_check_bound(input_shp,3)[4],
               in_channel=caml_check_bound(input_shp,4)[5],
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               kernel_rows=caml_check_bound(kernel_shp,1)[2],
               kernel_dpts=caml_check_bound(kernel_shp,2)[3],
               out_channel=caml_check_bound(kernel_shp,4)[5];
              if(in_channel === caml_check_bound(kernel_shp,3)[4])
               {var
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2],
                 output_rows=caml_check_bound(output_shp,2)[3],
                 output_dpts=caml_check_bound(output_shp,3)[4];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,4)[5])
                   {var
                     col_stride=caml_check_bound(stride,0)[1],
                     row_stride=caml_check_bound(stride,1)[2],
                     dpt_stride=caml_check_bound(stride,2)[3],
                     _md_=shape(input),
                     input$0=caml_ba_create(caml_ba_kind(input),0,_md_),
                     match=
                      calc_conv3d_padding
                       (input_cols,
                        input_rows,
                        input_dpts,
                        kernel_cols,
                        kernel_rows,
                        kernel_dpts,
                        output_cols,
                        output_rows,
                        output_dpts,
                        row_stride,
                        col_stride,
                        dpt_stride),
                     pad_shallow=match[3],
                     pad_left=match[2],
                     pad_top=match[1],
                     _mf_=batches - 1 | 0,
                     _me_=0;
                    if(!(_mf_ < 0))
                     {var b=_me_;
                      for(;;)
                       {var _mh_=input_cols - 1 | 0,_mg_=0;
                        if(!(_mh_ < 0))
                         {var in_i=_mg_;
                          for(;;)
                           {var _mk_=input_rows - 1 | 0,_mj_=0;
                            if(!(_mk_ < 0))
                             {var in_j=_mj_;
                              for(;;)
                               {var _mn_=input_dpts - 1 | 0,_mm_=0;
                                if(!(_mn_ < 0))
                                 {var in_dpt=_mm_;
                                  for(;;)
                                   {var _mq_=in_channel - 1 | 0,_mp_=0;
                                    if(!(_mq_ < 0))
                                     {var q=_mp_;
                                      for(;;)
                                       {var sum=[0,0],_mt_=kernel_cols - 1 | 0,_ms_=0;
                                        if(!(_mt_ < 0))
                                         {var di=_ms_;
                                          for(;;)
                                           {var _mw_=kernel_rows - 1 | 0,_mv_=0;
                                            if(!(_mw_ < 0))
                                             {var dj=_mv_;
                                              for(;;)
                                               {var _mz_=kernel_dpts - 1 | 0,_my_=0;
                                                if(!(_mz_ < 0))
                                                 {var d_dpt=_my_;
                                                  for(;;)
                                                   {var
                                                     _mB_=
                                                      0 === caml_mod((in_i + pad_left | 0) - di | 0,col_stride)
                                                       ?1
                                                       :0;
                                                    if(_mB_)
                                                     var
                                                      _mC_=
                                                       0 === caml_mod((in_j + pad_top | 0) - dj | 0,row_stride)?1:0,
                                                      _mD_=
                                                       _mC_
                                                        ?0
                                                          ===
                                                          caml_mod((in_dpt + pad_shallow | 0) - d_dpt | 0,dpt_stride)
                                                          ?1
                                                          :0
                                                        :_mC_;
                                                    else
                                                     var _mD_=_mB_;
                                                    if(_mD_)
                                                     {var
                                                       out_col=caml_div((in_i + pad_left | 0) - di | 0,col_stride),
                                                       out_row=caml_div((in_j + pad_top | 0) - dj | 0,row_stride),
                                                       out_dpt=
                                                        caml_div((in_dpt + pad_shallow | 0) - d_dpt | 0,dpt_stride),
                                                       _mE_=0 <= out_col?1:0;
                                                      if(_mE_)
                                                       {var _mF_=out_col < output_cols?1:0;
                                                        if(_mF_)
                                                         {var _mG_=0 <= out_row?1:0;
                                                          if(_mG_)
                                                           {var _mH_=out_row < output_rows?1:0;
                                                            if(_mH_)
                                                             var
                                                              _mI_=0 <= out_dpt?1:0,
                                                              _mJ_=_mI_?out_dpt < output_dpts?1:0:_mI_;
                                                            else
                                                             var _mJ_=_mH_}
                                                          else
                                                           var _mJ_=_mG_}
                                                        else
                                                         var _mJ_=_mF_}
                                                      else
                                                       var _mJ_=_mE_;
                                                      if(_mJ_)
                                                       {var _mL_=out_channel - 1 | 0,_mK_=0;
                                                        if(!(_mL_ < 0))
                                                         {var k=_mK_;
                                                          for(;;)
                                                           {var
                                                             out_grad=
                                                              caml_ba_get_generic(output,[0,b,out_col,out_row,out_dpt,k]),
                                                             kernel_val=caml_ba_get_generic(kernel,[0,di,dj,d_dpt,q,k]);
                                                            sum[1] = sum[1] + out_grad * kernel_val;
                                                            var _mN_=k + 1 | 0;
                                                            if(_mL_ !== k){var k=_mN_;continue}
                                                            break}}}}
                                                    var _mM_=d_dpt + 1 | 0;
                                                    if(_mz_ !== d_dpt){var d_dpt=_mM_;continue}
                                                    break}}
                                                var _mA_=dj + 1 | 0;
                                                if(_mw_ !== dj){var dj=_mA_;continue}
                                                break}}
                                            var _mx_=di + 1 | 0;
                                            if(_mt_ !== di){var di=_mx_;continue}
                                            break}}
                                        caml_ba_set_generic(input$0,[0,b,in_i,in_j,in_dpt,q],sum[1]);
                                        var _mu_=q + 1 | 0;
                                        if(_mq_ !== q){var q=_mu_;continue}
                                        break}}
                                    var _mr_=in_dpt + 1 | 0;
                                    if(_mn_ !== in_dpt){var in_dpt=_mr_;continue}
                                    break}}
                                var _mo_=in_j + 1 | 0;
                                if(_mk_ !== in_j){var in_j=_mo_;continue}
                                break}}
                            var _ml_=in_i + 1 | 0;
                            if(_mh_ !== in_i){var in_i=_ml_;continue}
                            break}}
                        var _mi_=b + 1 | 0;
                        if(_mf_ !== b){var b=_mi_;continue}
                        break}}
                    return input$0}
                  throw [0,Assert_failure,_it_]}
                throw [0,Assert_failure,_iu_]}
              throw [0,Assert_failure,_iv_]}
            throw [0,Assert_failure,_iw_]}
          throw [0,Assert_failure,_ix_]}
        throw [0,Assert_failure,_iy_]}
      throw [0,Assert_failure,_iz_]}
    function conv3d_backward_kernel(input,kernel,stride,output)
     {if(5 === num_dims(input))
       {if(5 === num_dims(kernel))
         {if(5 === num_dims(output))
           {if(3 === stride.length - 1)
             {var
               input_shp=shape(input),
               batches=caml_check_bound(input_shp,0)[1],
               input_cols=caml_check_bound(input_shp,1)[2],
               input_rows=caml_check_bound(input_shp,2)[3],
               input_dpts=caml_check_bound(input_shp,3)[4],
               in_channel=caml_check_bound(input_shp,4)[5],
               kernel_shp=shape(kernel),
               kernel_cols=caml_check_bound(kernel_shp,0)[1],
               kernel_rows=caml_check_bound(kernel_shp,1)[2],
               kernel_dpts=caml_check_bound(kernel_shp,2)[3],
               out_channel=caml_check_bound(kernel_shp,4)[5];
              if(in_channel === caml_check_bound(kernel_shp,3)[4])
               {var
                 output_shp=shape(output),
                 output_cols=caml_check_bound(output_shp,1)[2],
                 output_rows=caml_check_bound(output_shp,2)[3],
                 output_dpts=caml_check_bound(output_shp,3)[4];
                if(batches === caml_check_bound(output_shp,0)[1])
                 {if(out_channel === caml_check_bound(output_shp,4)[5])
                   {var
                     col_stride=caml_check_bound(stride,0)[1],
                     row_stride=caml_check_bound(stride,1)[2],
                     dpt_stride=caml_check_bound(stride,2)[3],
                     _lH_=shape(kernel),
                     kernel$0=caml_ba_create(caml_ba_kind(kernel),0,_lH_),
                     match=
                      calc_conv3d_padding
                       (input_cols,
                        input_rows,
                        input_dpts,
                        kernel_cols,
                        kernel_rows,
                        kernel_dpts,
                        output_cols,
                        output_rows,
                        output_dpts,
                        row_stride,
                        col_stride,
                        dpt_stride),
                     pad_shallow=match[3],
                     pad_left=match[2],
                     pad_top=match[1],
                     _lJ_=kernel_cols - 1 | 0,
                     _lI_=0;
                    if(!(_lJ_ < 0))
                     {var di=_lI_;
                      for(;;)
                       {var _lL_=kernel_rows - 1 | 0,_lK_=0;
                        if(!(_lL_ < 0))
                         {var dj=_lK_;
                          for(;;)
                           {var _lO_=kernel_dpts - 1 | 0,_lN_=0;
                            if(!(_lO_ < 0))
                             {var d_dpt=_lN_;
                              for(;;)
                               {var _lR_=in_channel - 1 | 0,_lQ_=0;
                                if(!(_lR_ < 0))
                                 {var q=_lQ_;
                                  for(;;)
                                   {var _lU_=out_channel - 1 | 0,_lT_=0;
                                    if(!(_lU_ < 0))
                                     {var k=_lT_;
                                      for(;;)
                                       {var sum=[0,0],_lX_=batches - 1 | 0,_lW_=0;
                                        if(!(_lX_ < 0))
                                         {var b=_lW_;
                                          for(;;)
                                           {var _l0_=output_cols - 1 | 0,_lZ_=0;
                                            if(!(_l0_ < 0))
                                             {var i=_lZ_;
                                              for(;;)
                                               {var _l3_=output_rows - 1 | 0,_l2_=0;
                                                if(!(_l3_ < 0))
                                                 {var j=_l2_;
                                                  for(;;)
                                                   {var _l6_=output_dpts - 1 | 0,_l5_=0;
                                                    if(!(_l6_ < 0))
                                                     {var dpt=_l5_;
                                                      for(;;)
                                                       {var
                                                         in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                                         in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                                         in_dpt=
                                                          (caml_mul(dpt,dpt_stride) + d_dpt | 0)
                                                          -
                                                          pad_shallow
                                                          |
                                                          0,
                                                         _l8_=0 <= in_col?1:0;
                                                        if(_l8_)
                                                         {var _l9_=in_col < input_cols?1:0;
                                                          if(_l9_)
                                                           {var _l__=0 <= in_row?1:0;
                                                            if(_l__)
                                                             {var _l$_=in_row < input_rows?1:0;
                                                              if(_l$_)
                                                               var
                                                                _ma_=0 <= in_dpt?1:0,
                                                                _mb_=_ma_?in_dpt < input_dpts?1:0:_ma_;
                                                              else
                                                               var _mb_=_l$_}
                                                            else
                                                             var _mb_=_l__}
                                                          else
                                                           var _mb_=_l9_}
                                                        else
                                                         var _mb_=_l8_;
                                                        if(_mb_)
                                                         {var
                                                           out_grad=caml_ba_get_generic(output,[0,b,i,j,dpt,k]),
                                                           input_val=
                                                            caml_ba_get_generic(input,[0,b,in_col,in_row,in_dpt,q]);
                                                          sum[1] = sum[1] + out_grad * input_val}
                                                        var _mc_=dpt + 1 | 0;
                                                        if(_l6_ !== dpt){var dpt=_mc_;continue}
                                                        break}}
                                                    var _l7_=j + 1 | 0;
                                                    if(_l3_ !== j){var j=_l7_;continue}
                                                    break}}
                                                var _l4_=i + 1 | 0;
                                                if(_l0_ !== i){var i=_l4_;continue}
                                                break}}
                                            var _l1_=b + 1 | 0;
                                            if(_lX_ !== b){var b=_l1_;continue}
                                            break}}
                                        caml_ba_set_generic(kernel$0,[0,di,dj,d_dpt,q,k],sum[1]);
                                        var _lY_=k + 1 | 0;
                                        if(_lU_ !== k){var k=_lY_;continue}
                                        break}}
                                    var _lV_=q + 1 | 0;
                                    if(_lR_ !== q){var q=_lV_;continue}
                                    break}}
                                var _lS_=d_dpt + 1 | 0;
                                if(_lO_ !== d_dpt){var d_dpt=_lS_;continue}
                                break}}
                            var _lP_=dj + 1 | 0;
                            if(_lL_ !== dj){var dj=_lP_;continue}
                            break}}
                        var _lM_=di + 1 | 0;
                        if(_lJ_ !== di){var di=_lM_;continue}
                        break}}
                    return kernel$0}
                  throw [0,Assert_failure,_iA_]}
                throw [0,Assert_failure,_iB_]}
              throw [0,Assert_failure,_iC_]}
            throw [0,Assert_failure,_iD_]}
          throw [0,Assert_failure,_iE_]}
        throw [0,Assert_failure,_iF_]}
      throw [0,Assert_failure,_iG_]}
    function pool2d_backward
     (padding,
      input,
      kernel,
      stride,
      output,
      init_pool_fun,
      add_val_pool_fun,
      end_pool_fun,
      compute_grad_fun)
     {if(4 === num_dims(input))
       {if(2 === kernel.length - 1)
         {if(2 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             in_channel=caml_check_bound(input_shp,3)[4],
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel_rows=caml_check_bound(kernel,1)[2],
             col_stride=caml_check_bound(stride,0)[1],
             row_stride=caml_check_bound(stride,1)[2],
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,1)[2],
             output_rows=caml_check_bound(output_shp,2)[3];
            if(batches === caml_check_bound(output_shp,0)[1])
             {if(in_channel === caml_check_bound(output_shp,3)[4])
               {var
                 match=
                  calc_conv2d_padding
                   (input_cols,
                    input_rows,
                    kernel_cols,
                    kernel_rows,
                    output_cols,
                    output_rows,
                    row_stride,
                    col_stride),
                 pad_left=match[2],
                 pad_top=match[1],
                 _la_=shape(input),
                 input$0=zeros(caml_ba_kind(input),_la_),
                 _lc_=batches - 1 | 0,
                 _lb_=0;
                if(!(_lc_ < 0))
                 {var b=_lb_;
                  for(;;)
                   {var _le_=output_cols - 1 | 0,_ld_=0;
                    if(!(_le_ < 0))
                     {var i=_ld_;
                      for(;;)
                       {var _lh_=output_rows - 1 | 0,_lg_=0;
                        if(!(_lh_ < 0))
                         {var j=_lg_;
                          for(;;)
                           {var _lk_=in_channel - 1 | 0,_lj_=0;
                            if(!(_lk_ < 0))
                             {var k=_lj_;
                              for(;;)
                               {caml_call1(init_pool_fun,0);
                                var _ln_=kernel_cols - 1 | 0,_lm_=0;
                                if(!(_ln_ < 0))
                                 {var di$0=_lm_;
                                  for(;;)
                                   {var _lA_=kernel_rows - 1 | 0,_lz_=0;
                                    if(!(_lA_ < 0))
                                     {var dj$0=_lz_;
                                      for(;;)
                                       {var
                                         in_col$0=(caml_mul(i,col_stride) + di$0 | 0) - pad_left | 0,
                                         in_row$0=(caml_mul(j,row_stride) + dj$0 | 0) - pad_top | 0,
                                         _lC_=0 <= in_col$0?1:0;
                                        if(_lC_)
                                         {var _lD_=in_col$0 < input_cols?1:0;
                                          if(_lD_)
                                           var
                                            _lE_=0 <= in_row$0?1:0,
                                            _lF_=_lE_?in_row$0 < input_rows?1:0:_lE_;
                                          else
                                           var _lF_=_lD_}
                                        else
                                         var _lF_=_lC_;
                                        if(_lF_)
                                         caml_call1
                                          (add_val_pool_fun,
                                           caml_ba_get_generic(input,[0,b,in_col$0,in_row$0,k]));
                                        var _lG_=dj$0 + 1 | 0;
                                        if(_lA_ !== dj$0){var dj$0=_lG_;continue}
                                        break}}
                                    var _lB_=di$0 + 1 | 0;
                                    if(_ln_ !== di$0){var di$0=_lB_;continue}
                                    break}}
                                var
                                 output_val=caml_call1(end_pool_fun,0),
                                 output_grad=caml_ba_get_generic(output,[0,b,i,j,k]),
                                 _lp_=kernel_cols - 1 | 0,
                                 _lo_=0;
                                if(!(_lp_ < 0))
                                 {var di=_lo_;
                                  for(;;)
                                   {var _ls_=kernel_rows - 1 | 0,_lr_=0;
                                    if(!(_ls_ < 0))
                                     {var dj=_lr_;
                                      for(;;)
                                       {var
                                         in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                         in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                         _lu_=0 <= in_col?1:0;
                                        if(_lu_)
                                         {var _lv_=in_col < input_cols?1:0;
                                          if(_lv_)
                                           var
                                            _lw_=0 <= in_row?1:0,
                                            _lx_=_lw_?in_row < input_rows?1:0:_lw_;
                                          else
                                           var _lx_=_lv_}
                                        else
                                         var _lx_=_lu_;
                                        if(_lx_)
                                         {var
                                           input_val=caml_ba_get_generic(input,[0,b,in_col,in_row,k]),
                                           input_grad=
                                            caml_ba_get_generic(input$0,[0,b,in_col,in_row,k]);
                                          caml_ba_set_generic
                                           (input$0,
                                            [0,b,in_col,in_row,k],
                                            caml_call4
                                             (compute_grad_fun,
                                              input_val,
                                              input_grad,
                                              output_val,
                                              output_grad))}
                                        var _ly_=dj + 1 | 0;
                                        if(_ls_ !== dj){var dj=_ly_;continue}
                                        break}}
                                    var _lt_=di + 1 | 0;
                                    if(_lp_ !== di){var di=_lt_;continue}
                                    break}}
                                var _lq_=k + 1 | 0;
                                if(_lk_ !== k){var k=_lq_;continue}
                                break}}
                            var _ll_=j + 1 | 0;
                            if(_lh_ !== j){var j=_ll_;continue}
                            break}}
                        var _li_=i + 1 | 0;
                        if(_le_ !== i){var i=_li_;continue}
                        break}}
                    var _lf_=b + 1 | 0;
                    if(_lc_ !== b){var b=_lf_;continue}
                    break}}
                return input$0}
              throw [0,Assert_failure,_iH_]}
            throw [0,Assert_failure,_iI_]}
          throw [0,Assert_failure,_iJ_]}
        throw [0,Assert_failure,_iK_]}
      throw [0,Assert_failure,_iL_]}
    function max_pool2d_backward(padding,input,kernel,stride,output)
     {var max_pool=[0,0];
      function init_pool_fun(param){max_pool[1] = min_float;return 0}
      function add_val_pool_fun(v){max_pool[1] = max(max_pool[1],v);return 0}
      function end_pool_fun(param){return max_pool[1]}
      function compute_grad_fun(input_val,input_grad,output_val,output_grad)
       {return Math.abs(input_val - output_val) < 1e-08
                ?input_grad + output_grad
                :input_grad}
      return pool2d_backward
              (padding,
               input,
               kernel,
               stride,
               output,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun,
               compute_grad_fun)}
    function avg_pool2d_backward(padding,input,kernel,stride,output)
     {var sum_pool=[0,0],cnt=[0,0];
      function init_pool_fun(param){sum_pool[1] = 0;cnt[1] = 0;return 0}
      function add_val_pool_fun(v)
       {sum_pool[1] = sum_pool[1] + v;cnt[1] = cnt[1] + 1;return 0}
      function end_pool_fun(param){return sum_pool[1] / cnt[1]}
      function compute_grad_fun(input_val,input_grad,output_val,output_grad)
       {return input_grad + output_grad / cnt[1]}
      return pool2d_backward
              (padding,
               input,
               kernel,
               stride,
               output,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun,
               compute_grad_fun)}
    function pool3d_backward
     (padding,
      input,
      kernel,
      stride,
      output,
      init_pool_fun,
      add_val_pool_fun,
      end_pool_fun,
      compute_grad_fun)
     {if(5 === num_dims(input))
       {if(3 === kernel.length - 1)
         {if(3 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             input_rows=caml_check_bound(input_shp,2)[3],
             input_dpts=caml_check_bound(input_shp,3)[4],
             in_channel=caml_check_bound(input_shp,4)[5],
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel_rows=caml_check_bound(kernel,1)[2],
             kernel_dpts=caml_check_bound(kernel,2)[3],
             col_stride=caml_check_bound(stride,0)[1],
             row_stride=caml_check_bound(stride,1)[2],
             dpt_stride=caml_check_bound(stride,2)[3],
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,1)[2],
             output_rows=caml_check_bound(output_shp,2)[3],
             output_dpts=caml_check_bound(output_shp,3)[4];
            if(batches === caml_check_bound(output_shp,0)[1])
             {if(in_channel === caml_check_bound(output_shp,4)[5])
               {var
                 match=
                  calc_conv3d_padding
                   (input_cols,
                    input_rows,
                    input_dpts,
                    kernel_cols,
                    kernel_rows,
                    kernel_dpts,
                    output_cols,
                    output_rows,
                    output_dpts,
                    row_stride,
                    col_stride,
                    dpt_stride),
                 pad_shallow=match[3],
                 pad_left=match[2],
                 pad_top=match[1],
                 _ks_=shape(input),
                 input$0=zeros(caml_ba_kind(input),_ks_),
                 _ku_=batches - 1 | 0,
                 _kt_=0;
                if(!(_ku_ < 0))
                 {var b=_kt_;
                  for(;;)
                   {var _kw_=output_cols - 1 | 0,_kv_=0;
                    if(!(_kw_ < 0))
                     {var i=_kv_;
                      for(;;)
                       {var _kz_=output_rows - 1 | 0,_ky_=0;
                        if(!(_kz_ < 0))
                         {var j=_ky_;
                          for(;;)
                           {var _kC_=output_dpts - 1 | 0,_kB_=0;
                            if(!(_kC_ < 0))
                             {var dpt=_kB_;
                              for(;;)
                               {var _kF_=in_channel - 1 | 0,_kE_=0;
                                if(!(_kF_ < 0))
                                 {var k=_kE_;
                                  for(;;)
                                   {caml_call1(init_pool_fun,0);
                                    var _kI_=kernel_cols - 1 | 0,_kH_=0;
                                    if(!(_kI_ < 0))
                                     {var di$0=_kH_;
                                      for(;;)
                                       {var _k0_=kernel_rows - 1 | 0,_kZ_=0;
                                        if(!(_k0_ < 0))
                                         {var dj$0=_kZ_;
                                          for(;;)
                                           {var _k3_=kernel_dpts - 1 | 0,_k2_=0;
                                            if(!(_k3_ < 0))
                                             {var dk$0=_k2_;
                                              for(;;)
                                               {var
                                                 in_col$0=(caml_mul(i,col_stride) + di$0 | 0) - pad_left | 0,
                                                 in_row$0=(caml_mul(j,row_stride) + dj$0 | 0) - pad_top | 0,
                                                 in_dpt$0=
                                                  (caml_mul(dpt,dpt_stride) + dk$0 | 0)
                                                  -
                                                  pad_shallow
                                                  |
                                                  0,
                                                 _k5_=0 <= in_col$0?1:0;
                                                if(_k5_)
                                                 {var _k6_=in_col$0 < input_cols?1:0;
                                                  if(_k6_)
                                                   {var _k7_=0 <= in_row$0?1:0;
                                                    if(_k7_)
                                                     {var _k8_=in_row$0 < input_rows?1:0;
                                                      if(_k8_)
                                                       var
                                                        _k9_=0 <= in_dpt$0?1:0,
                                                        _k__=_k9_?in_dpt$0 < input_dpts?1:0:_k9_;
                                                      else
                                                       var _k__=_k8_}
                                                    else
                                                     var _k__=_k7_}
                                                  else
                                                   var _k__=_k6_}
                                                else
                                                 var _k__=_k5_;
                                                if(_k__)
                                                 caml_call1
                                                  (add_val_pool_fun,
                                                   caml_ba_get_generic
                                                    (input,[0,b,in_col$0,in_row$0,in_dpt$0,k]));
                                                var _k$_=dk$0 + 1 | 0;
                                                if(_k3_ !== dk$0){var dk$0=_k$_;continue}
                                                break}}
                                            var _k4_=dj$0 + 1 | 0;
                                            if(_k0_ !== dj$0){var dj$0=_k4_;continue}
                                            break}}
                                        var _k1_=di$0 + 1 | 0;
                                        if(_kI_ !== di$0){var di$0=_k1_;continue}
                                        break}}
                                    var
                                     output_val=caml_call1(end_pool_fun,0),
                                     output_grad=caml_ba_get_generic(output,[0,b,i,j,dpt,k]),
                                     _kK_=kernel_cols - 1 | 0,
                                     _kJ_=0;
                                    if(!(_kK_ < 0))
                                     {var di=_kJ_;
                                      for(;;)
                                       {var _kN_=kernel_rows - 1 | 0,_kM_=0;
                                        if(!(_kN_ < 0))
                                         {var dj=_kM_;
                                          for(;;)
                                           {var _kQ_=kernel_dpts - 1 | 0,_kP_=0;
                                            if(!(_kQ_ < 0))
                                             {var dk=_kP_;
                                              for(;;)
                                               {var
                                                 in_col=(caml_mul(i,col_stride) + di | 0) - pad_left | 0,
                                                 in_row=(caml_mul(j,row_stride) + dj | 0) - pad_top | 0,
                                                 in_dpt=(caml_mul(dpt,dpt_stride) + dk | 0) - pad_shallow | 0,
                                                 _kS_=0 <= in_col?1:0;
                                                if(_kS_)
                                                 {var _kT_=in_col < input_cols?1:0;
                                                  if(_kT_)
                                                   {var _kU_=0 <= in_row?1:0;
                                                    if(_kU_)
                                                     {var _kV_=in_row < input_rows?1:0;
                                                      if(_kV_)
                                                       var
                                                        _kW_=0 <= in_dpt?1:0,
                                                        _kX_=_kW_?in_dpt < input_dpts?1:0:_kW_;
                                                      else
                                                       var _kX_=_kV_}
                                                    else
                                                     var _kX_=_kU_}
                                                  else
                                                   var _kX_=_kT_}
                                                else
                                                 var _kX_=_kS_;
                                                if(_kX_)
                                                 {var
                                                   input_val=
                                                    caml_ba_get_generic(input,[0,b,in_col,in_row,in_dpt,k]),
                                                   input_grad=
                                                    caml_ba_get_generic(input$0,[0,b,in_col,in_row,in_dpt,k]);
                                                  caml_ba_set_generic
                                                   (input$0,
                                                    [0,b,in_col,in_row,in_dpt,k],
                                                    caml_call4
                                                     (compute_grad_fun,
                                                      input_val,
                                                      input_grad,
                                                      output_val,
                                                      output_grad))}
                                                var _kY_=dk + 1 | 0;
                                                if(_kQ_ !== dk){var dk=_kY_;continue}
                                                break}}
                                            var _kR_=dj + 1 | 0;
                                            if(_kN_ !== dj){var dj=_kR_;continue}
                                            break}}
                                        var _kO_=di + 1 | 0;
                                        if(_kK_ !== di){var di=_kO_;continue}
                                        break}}
                                    var _kL_=k + 1 | 0;
                                    if(_kF_ !== k){var k=_kL_;continue}
                                    break}}
                                var _kG_=dpt + 1 | 0;
                                if(_kC_ !== dpt){var dpt=_kG_;continue}
                                break}}
                            var _kD_=j + 1 | 0;
                            if(_kz_ !== j){var j=_kD_;continue}
                            break}}
                        var _kA_=i + 1 | 0;
                        if(_kw_ !== i){var i=_kA_;continue}
                        break}}
                    var _kx_=b + 1 | 0;
                    if(_ku_ !== b){var b=_kx_;continue}
                    break}}
                return input$0}
              throw [0,Assert_failure,_iM_]}
            throw [0,Assert_failure,_iN_]}
          throw [0,Assert_failure,_iO_]}
        throw [0,Assert_failure,_iP_]}
      throw [0,Assert_failure,_iQ_]}
    function max_pool3d_backward(padding,input,kernel,stride,output)
     {var max_pool=[0,0];
      function init_pool_fun(param){max_pool[1] = min_float;return 0}
      function add_val_pool_fun(v){max_pool[1] = max(max_pool[1],v);return 0}
      function end_pool_fun(param){return max_pool[1]}
      function compute_grad_fun(input_val,input_grad,output_val,output_grad)
       {return Math.abs(input_val - output_val) < 1e-08
                ?input_grad + output_grad
                :input_grad}
      return pool3d_backward
              (padding,
               input,
               kernel,
               stride,
               output,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun,
               compute_grad_fun)}
    function avg_pool3d_backward(padding,input,kernel,stride,output)
     {var sum_pool=[0,0],cnt=[0,0];
      function init_pool_fun(param){sum_pool[1] = 0;cnt[1] = 0;return 0}
      function add_val_pool_fun(v)
       {sum_pool[1] = sum_pool[1] + v;cnt[1] = cnt[1] + 1;return 0}
      function end_pool_fun(param){return sum_pool[1] / cnt[1]}
      function compute_grad_fun(input_val,input_grad,output_val,output_grad)
       {return input_grad + output_grad / cnt[1]}
      return pool3d_backward
              (padding,
               input,
               kernel,
               stride,
               output,
               init_pool_fun,
               add_val_pool_fun,
               end_pool_fun,
               compute_grad_fun)}
    function max_pool1d_backward(padding,input,kernel,stride,output)
     {if(3 === num_dims(input))
       {if(1 === kernel.length - 1)
         {if(1 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             in_channel=caml_check_bound(input_shp,2)[3],
             input$0=
              caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel$0=[0,1,kernel_cols],
             col_stride=caml_check_bound(stride,0)[1],
             stride$0=[0,1,col_stride],
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,1)[2],
             out_channel=caml_check_bound(output_shp,2)[3],
             output$0=
              caml_ba_reshape(output,[0,batches,1,output_cols,out_channel]),
             input$1=
              max_pool2d_backward(padding,input$0,kernel$0,stride$0,output$0);
            return caml_ba_reshape(input$1,input_shp)}
          throw [0,Assert_failure,_iR_]}
        throw [0,Assert_failure,_iS_]}
      throw [0,Assert_failure,_iT_]}
    function avg_pool1d_backward(padding,input,kernel,stride,output)
     {if(3 === num_dims(input))
       {if(1 === kernel.length - 1)
         {if(1 === stride.length - 1)
           {var
             input_shp=shape(input),
             batches=caml_check_bound(input_shp,0)[1],
             input_cols=caml_check_bound(input_shp,1)[2],
             in_channel=caml_check_bound(input_shp,2)[3],
             input$0=
              caml_ba_reshape(input,[0,batches,1,input_cols,in_channel]),
             kernel_cols=caml_check_bound(kernel,0)[1],
             kernel$0=[0,1,kernel_cols],
             col_stride=caml_check_bound(stride,0)[1],
             stride$0=[0,1,col_stride],
             output_shp=shape(output),
             output_cols=caml_check_bound(output_shp,1)[2],
             out_channel=caml_check_bound(output_shp,2)[3],
             output$0=
              caml_ba_reshape(output,[0,batches,1,output_cols,out_channel]),
             input$1=
              avg_pool2d_backward(padding,input$0,kernel$0,stride$0,output$0);
            return caml_ba_reshape(input$1,input_shp)}
          throw [0,Assert_failure,_iU_]}
        throw [0,Assert_failure,_iV_]}
      throw [0,Assert_failure,_iW_]}
    function check_is_matrix(dims)
     {if(2 === dims.length - 1)return 0;throw [0,Invalid_argument,_iY_]}
    function row_num(varr)
     {var dims=shape(varr);
      check_is_matrix(dims);
      return caml_check_bound(dims,0)[1]}
    function col_num(varr)
     {var dims=shape(varr);
      check_is_matrix(dims);
      return caml_check_bound(dims,1)[2]}
    function row(varr,ind)
     {var dims=shape(varr);
      check_is_matrix(dims);
      return caml_ba_slice(varr,[0,ind])}
    function rows(varr,indices)
     {var dims=shape(varr);
      check_is_matrix(dims);
      var
       new_rownum=indices.length - 1,
       new_colnum=caml_check_bound(dims,1)[2],
       new_varr=caml_ba_create(caml_ba_kind(varr),0,[0,new_rownum,new_colnum]),
       _kp_=new_rownum - 1 | 0,
       _ko_=0;
      if(!(_kp_ < 0))
       {var i=_ko_;
        for(;;)
         {var _kq_=caml_ba_slice(new_varr,[0,i]);
          caml_ba_blit
           (caml_ba_slice(varr,[0,caml_check_bound(indices,i)[i + 1]]),_kq_);
          var _kr_=i + 1 | 0;
          if(_kp_ !== i){var i=_kr_;continue}
          break}}
      return new_varr}
    function copy_row_to(vec,varr,ind)
     {var dims=shape(varr);
      check_is_matrix(dims);
      return caml_ba_blit(vec,caml_ba_slice(varr,[0,ind]))}
    function copy_col_to(vec,varr,ind)
     {var dims=shape(varr);
      check_is_matrix(dims);
      var dims$0=shape(vec),param$0=to_list(dims$0),accu=0,param=param$0;
      for(;;)
       {if(param)
         {var l=param[2],x=param[1];
          if(1 < x){var accu$0=[0,x,accu],accu=accu$0,param=l;continue}
          var param=l;
          continue}
        var
         removed_ones_list=rev(accu),
         not_empty_list=removed_ones_list || _iX_,
         vec_dims=of_list(not_empty_list);
        if(1 === vec_dims.length - 1)
         {var
           vec_len=caml_check_bound(vec_dims,0)[1],
           num_rows=caml_check_bound(dims,0)[1],
           vec_linear=array1_of_genarray(flatten(vec));
          if(num_rows !== vec_len)throw [0,Invalid_argument,_iZ_];
          var _km_=num_rows - 1 | 0,_kl_=0;
          if(!(_km_ < 0))
           {var i=_kl_;
            for(;;)
             {caml_ba_set_generic(varr,[0,i,ind],caml_ba_get_1(vec_linear,i));
              var _kn_=i + 1 | 0;
              if(_km_ !== i){var i=_kn_;continue}
              break}}
          return 0}
        throw [0,Invalid_argument,_i0_]}}
    function dot(varr_a,varr_b)
     {var dims_b=shape(varr_b),dims_a=shape(varr_a);
      check_is_matrix(dims_b);
      check_is_matrix(dims_a);
      var
       m=caml_check_bound(dims_a,0)[1],
       cdim=caml_check_bound(dims_a,1)[2],
       n=caml_check_bound(dims_b,1)[2];
      if(caml_check_bound(dims_b,0)[1] !== cdim)
       throw [0,Invalid_argument,_i1_];
      var
       varr_c=caml_ba_create(caml_ba_kind(varr_a),0,[0,m,n]),
       sum=[0,0],
       _kb_=m - 1 | 0,
       _ka_=0;
      if(!(_kb_ < 0))
       {var i=_ka_;
        for(;;)
         {var _kd_=n - 1 | 0,_kc_=0;
          if(!(_kd_ < 0))
           {var j=_kc_;
            for(;;)
             {sum[1] = 0;
              var _kg_=cdim - 1 | 0,_kf_=0;
              if(!(_kg_ < 0))
               {var k=_kf_;
                for(;;)
                 {var
                   _ki_=caml_ba_get_generic(varr_b,[0,k,j]),
                   _kj_=caml_ba_get_generic(varr_a,[0,i,k]) * _ki_;
                  sum[1] = sum[1] + _kj_;
                  var _kk_=k + 1 | 0;
                  if(_kg_ !== k){var k=_kk_;continue}
                  break}}
              caml_ba_set_generic(varr_c,[0,i,j],sum[1]);
              var _kh_=j + 1 | 0;
              if(_kd_ !== j){var j=_kh_;continue}
              break}}
          var _ke_=i + 1 | 0;
          if(_kb_ !== i){var i=_ke_;continue}
          break}}
      return varr_c}
    function trace(varr)
     {var dims=shape(varr);
      check_is_matrix(dims);
      var n=caml_check_bound(dims,0)[1];
      if(caml_check_bound(dims,1)[2] !== n)throw [0,Invalid_argument,_i2_];
      var sum=[0,0],_j9_=n - 1 | 0,_j8_=0;
      if(!(_j9_ < 0))
       {var i=_j8_;
        for(;;)
         {var _j__=caml_ba_get_generic(varr,[0,i,i]);
          sum[1] = sum[1] + _j__;
          var _j$_=i + 1 | 0;
          if(_j9_ !== i){var i=_j$_;continue}
          break}}
      return sum[1]}
    function to_rows(varr)
     {var dims=shape(varr);
      check_is_matrix(dims);
      var m=caml_check_bound(dims,0)[1];
      return init(m,function(i){return caml_ba_slice(varr,[0,i])})}
    function of_rows(rows)
     {var
       m=rows.length - 1,
       row_dim=shape(caml_check_bound(rows,0)[1]),
       dims=append$0([0,m],row_dim),
       varr=caml_ba_create(caml_ba_kind(caml_check_bound(rows,0)[1]),0,dims),
       _j5_=m - 1 | 0,
       _j4_=0;
      if(!(_j5_ < 0))
       {var i=_j4_;
        for(;;)
         {var _j6_=caml_ba_slice(varr,[0,i]);
          caml_ba_blit(caml_check_bound(rows,i)[i + 1],_j6_);
          var _j7_=i + 1 | 0;
          if(_j5_ !== i){var i=_j7_;continue}
          break}}
      return varr}
    function transpose(axis,varr)
     {var dims=shape(varr),rank=dims.length - 1;
      if(axis)
       var perm=axis[1],axis_perm=perm;
      else
       var axis_perm=init(rank,function(i){return (rank - i | 0) - 1 | 0});
      var
       new_dims=apply_perm(dims,axis_perm),
       new_varr=caml_ba_create(caml_ba_kind(varr),0,new_dims),
       ind=caml_make_vect(rank,0),
       should_stop=[0,0];
      for(;;)
       {if(should_stop[1])return new_varr;
        var _j3_=caml_ba_get_generic(varr,ind);
        caml_ba_set_generic(new_varr,apply_perm(ind,axis_perm),_j3_);
        if(1 - next_index(ind,dims)){should_stop[1] = 1;continue}
        continue}}
    function inv(varr)
     {var dims=shape(varr);
      check_is_matrix(dims);
      var n=dims[1];
      if(dims[2] !== n)return failwith(_i3_);
      var
       pivot_row=caml_make_vect(n,0),
       result_varr=copy$0(varr),
       _jN_=n - 1 | 0,
       _jM_=0;
      if(!(_jN_ < 0))
       {var p=_jM_;
        for(;;)
         {var pivot_elem=caml_ba_get_generic(result_varr,[0,p,p]);
          if(caml_ba_get_generic(result_varr,[0,p,p]) == 0)failwith(_i4_);
          var _jP_=n - 1 | 0,_jO_=0;
          if(!(_jP_ < 0))
           {var j$0=_jO_;
            for(;;)
             {caml_array_set
               (pivot_row,j$0,caml_ba_get_generic(result_varr,[0,p,j$0]));
              if(j$0 !== p)
               caml_ba_set_generic
                (result_varr,
                 [0,p,j$0],
                 caml_array_get(pivot_row,j$0) / pivot_elem);
              var _j2_=j$0 + 1 | 0;
              if(_jP_ !== j$0){var j$0=_j2_;continue}
              break}}
          var _jR_=n - 1 | 0,_jQ_=0;
          if(!(_jR_ < 0))
           {var i$0=_jQ_;
            for(;;)
             {if(i$0 !== p)
               caml_ba_set_generic
                (result_varr,
                 [0,i$0,p],
                 caml_ba_get_generic(result_varr,[0,i$0,p]) / -pivot_elem);
              var _j1_=i$0 + 1 | 0;
              if(_jR_ !== i$0){var i$0=_j1_;continue}
              break}}
          var _jT_=n - 1 | 0,_jS_=0;
          if(!(_jT_ < 0))
           {var i=_jS_;
            for(;;)
             {var
               pivot_col_elem=caml_ba_get_generic(result_varr,[0,i,p]),
               _jW_=n - 1 | 0,
               _jV_=0;
              if(!(_jW_ < 0))
               {var j=_jV_;
                for(;;)
                 {var _jY_=i !== p?1:0,_jZ_=_jY_?j !== p?1:0:_jY_;
                  if(_jZ_)
                   {var
                     pivot_row_elem=caml_array_get(pivot_row,j),
                     old_val=caml_ba_get_generic(result_varr,[0,i,j]),
                     new_val=old_val + pivot_row_elem * pivot_col_elem;
                    caml_ba_set_generic(result_varr,[0,i,j],new_val)}
                  var _j0_=j + 1 | 0;
                  if(_jW_ !== j){var j=_j0_;continue}
                  break}}
              var _jX_=i + 1 | 0;
              if(_jT_ !== i){var i=_jX_;continue}
              break}}
          caml_ba_set_generic(result_varr,[0,p,p],1 / pivot_elem);
          var _jU_=p + 1 | 0;
          if(_jN_ !== p){var p=_jU_;continue}
          break}}
      return result_varr}
    function empty(dims){return caml_ba_create(0,0,dims)}
    function create$2(dims,value){return create$1(0,dims,value)}
    function init$1(dims,f)
     {var
       varr=caml_ba_create(0,0,dims),
       varr_flat=array1_of_genarray(flatten(varr)),
       n=numel(varr),
       _jK_=n - 1 | 0,
       _jJ_=0;
      if(!(_jK_ < 0))
       {var i=_jJ_;
        for(;;)
         {caml_ba_set_1(varr_flat,i,caml_call1(f,i));
          var _jL_=i + 1 | 0;
          if(_jK_ !== i){var i=_jL_;continue}
          break}}
      return varr}
    function zeros$0(dims){return zeros(0,dims)}
    function ones(dims){return create$1(0,dims,one$0(0))}
    function sequential(a$0,step$0,dims)
     {if(a$0)var sth=a$0[1],a=sth;else var a=0;
      if(step$0)var sth$0=step$0[1],step=sth$0;else var step=1;
      var varr=caml_ba_create(0,0,dims),count=[0,0];
      function seq_fun(x)
       {count[1] = count[1] + 1;return a + (count[1] - 1) * step}
      apply_fun(seq_fun,varr);
      return varr}
    function of_array(arr,dims)
     {var
       varr=caml_ba_create(0,0,dims),
       flat_varr=array1_of_genarray(flatten(varr)),
       n=numel(varr),
       _jH_=n - 1 | 0,
       _jG_=0;
      if(!(_jH_ < 0))
       {var i=_jG_;
        for(;;)
         {caml_ba_set_1(flat_varr,i,caml_check_bound(arr,i)[i + 1]);
          var _jI_=i + 1 | 0;
          if(_jH_ !== i){var i=_jI_;continue}
          break}}
      return varr}
    function of_arrays(arrays)
     {var
       m=arrays.length - 1,
       n=caml_check_bound(arrays,0)[1].length - 1,
       varr=caml_ba_create(0,0,[0,m,n]),
       _jB_=n - 1 | 0,
       _jA_=0;
      if(!(_jB_ < 0))
       {var i=_jA_;
        for(;;)
         {var _jD_=m - 1 | 0,_jC_=0;
          if(!(_jD_ < 0))
           {var j=_jC_;
            for(;;)
             {caml_ba_set_generic
               (varr,[0,i,j],caml_check_bound(arrays,i)[i + 1][j + 1]);
              var _jF_=j + 1 | 0;
              if(_jD_ !== j){var j=_jF_;continue}
              break}}
          var _jE_=i + 1 | 0;
          if(_jB_ !== i){var i=_jE_;continue}
          break}}
      return varr}
    function uniform$0(a$0,b$0,dims)
     {if(a$0)var sth=a$0[1],a=sth;else var a=0;
      if(b$0)var sth$0=b$0[1],b=sth$0;else var b=1;
      function uniform_gen_fun(param){return uniform(a,b)}
      var varr=caml_ba_create(0,0,dims);
      apply_fun(uniform_gen_fun,varr);
      return varr}
    function bernoulli(p$0,dims)
     {if(p$0)var sth=p$0[1],p=sth;else var p=0.5;
      function bernoulli_gen_fun(param)
       {if(0 <= p)if(p <= 1)return float$0(rand_gen,1) <= p?1:0;
        throw [0,Assert_failure,_hg_]}
      var varr=caml_ba_create(0,0,dims);
      apply_fun(bernoulli_gen_fun,varr);
      return varr}
    function gaussian(mu$0,sigma$0,dims)
     {if(mu$0)var sth=mu$0[1],mu=sth;else var mu=0;
      if(sigma$0)var sth$0=sigma$0[1],sigma=sth$0;else var sigma=1;
      function gaussian_gen_fun(param)
       {return case$0[1]
                ?(case$0[1] = 0,mu + sigma * z1[1])
                :(case$0[1]
                  =
                  1,
                  u1[1]
                  =
                  float$0(rand_gen,1),
                  u2[1]
                  =
                  float$0(rand_gen,1),
                  z0[1]
                  =
                  Math.sqrt(-2 * Math.log(u1[1]))
                  *
                  Math.cos(6.28318530717958623 * u2[1]),
                  z1[1]
                  =
                  Math.sqrt(-2 * Math.log(u1[1]))
                  *
                  Math.sin(6.28318530717958623 * u2[1]),
                  mu
                  +
                  sigma
                  *
                  z0[1])}
      var varr=caml_ba_create(0,0,dims);
      apply_fun(gaussian_gen_fun,varr);
      return varr}
    function level_to_int(param)
     {switch(param)
       {case 0:return 0;
        case 1:return 1;
        case 2:return 2;
        case 3:return 3;
        default:return 4}}
    var _i6_=1;
    function info(fmt$0)
     {var _jp_=level_to_int(_i6_),match=_jp_ <= level_to_int(1)?1:0;
      if(0 === match)
       {var k=function(_jz_){return 0},fmt=fmt$0[1];
        return make_iprintf(k,oc,fmt)}
      var
       ts=unix_gettimeofday(0),
       tm=unix_localtime(ts),
       _jq_=_d_(_i5_,_d_(s,_i7_)),
       _jr_=1e3 * caml_modf_float(ts)[1] | 0,
       _js_=tm[1],
       _jt_=tm[2],
       _ju_=tm[3],
       _jv_=tm[4],
       _jw_=tm[5] + 1 | 0,
       _jx_=tm[6] + 1900 | 0,
       _jy_=caml_call8(sprintf(_i8_),_jx_,_jw_,_jv_,_ju_,_jt_,_js_,_jr_,_jq_);
      return caml_call1(fprintf(oc,_i_(_i__,_i_(fmt$0,_i9_))),_jy_)}
    var
     A=
      Make
       ([0,
         empty,
         zeros$0,
         ones,
         create$2,
         sequential,
         uniform$0,
         gaussian,
         bernoulli,
         init$1,
         shape,
         numel,
         get,
         set,
         get_slice,
         set_slice,
         copy$0,
         reset,
         reshape,
         reverse,
         tile,
         repeat,
         concatenate,
         split,
         draw,
         map$1,
         fold$0,
         scan,
         print,
         abs$1,
         neg$0,
         floor$0,
         ceil$0,
         round$0,
         sqr$0,
         sqrt$0,
         log$0,
         log2$0,
         log10$0,
         exp$0,
         sin$0,
         cos$0,
         tan$0,
         sinh$0,
         cosh$0,
         tanh$0,
         asin$0,
         acos$0,
         atan$0,
         asinh$0,
         acosh$0,
         atanh$0,
         sum,
         sum_slices,
         signum$0,
         sigmoid$0,
         relu$0,
         min$0,
         max$0,
         sum$0,
         l1norm,
         l2norm,
         l2norm_sqr,
         clip_by_value,
         clip_by_l2norm,
         pow$0,
         scalar_pow,
         pow_scalar,
         atan2$0,
         scalar_atan2,
         atan2_scalar,
         add$1,
         sub$4,
         mul$1,
         div$1,
         add_scalar,
         sub_scalar,
         mul_scalar,
         div_scalar,
         scalar_add,
         scalar_sub,
         scalar_mul,
         scalar_div,
         conv1d,
         conv2d,
         conv3d,
         max_pool1d,
         max_pool2d,
         max_pool3d,
         avg_pool1d,
         avg_pool2d,
         avg_pool3d,
         conv1d_backward_input,
         conv1d_backward_kernel,
         conv2d_backward_input,
         conv2d_backward_kernel,
         conv3d_backward_input,
         conv3d_backward_kernel,
         max_pool1d_backward,
         max_pool2d_backward,
         max_pool3d_backward,
         avg_pool1d_backward,
         avg_pool2d_backward,
         avg_pool3d_backward,
         row_num,
         col_num,
         row,
         rows,
         copy_row_to,
         copy_col_to,
         dot,
         inv,
         trace,
         transpose,
         to_rows,
         of_rows,
         of_array,
         of_arrays,
         is_zero,
         is_positive,
         is_negative,
         is_nonpositive,
         is_nonnegative,
         equal,
         not_equal,
         less,
         greater,
         less_equal,
         greater_equal,
         elt_equal,
         elt_not_equal,
         elt_less,
         elt_greater,
         elt_less_equal,
         elt_greater_equal,
         elt_equal_scalar,
         elt_not_equal_scalar,
         elt_less_scalar,
         elt_greater_scalar,
         elt_less_equal_scalar,
         elt_greater_equal_scalar,
         approx_equal,
         approx_equal_scalar,
         approx_elt_equal,
         approx_elt_equal_scalar,
         [0,
          add$0,
          sub$3,
          mul$0,
          div$0,
          pow,
          atan2,
          abs$0,
          neg,
          sqr,
          sqrt,
          exp,
          log,
          log2,
          log10,
          signum,
          floor,
          ceil,
          round,
          sin,
          cos,
          tan,
          sinh,
          cosh,
          tanh,
          asin,
          acos,
          atan,
          asinh,
          acosh,
          atanh,
          relu,
          sigmoid]]);
    function desc(opt,_jl_,f,x)
     {var opt$0=opt,_jm_=_jl_,x$0=x;
      for(;;)
       {if(opt$0)var sth=opt$0[1],eta=sth;else var eta=_i$_;
        if(_jm_)var sth$0=_jm_[1],eps=sth$0;else var eps=1e-06;
        var
         g=caml_call1(caml_call1(A[35],f),x$0),
         _jn_=caml_call1(A[28][18],g);
        if(caml_call1(A[23],_jn_) < eps)return x$0;
        var
         _jo_=caml_call2(A[28][8],eta,g),
         x$1=caml_call2(A[28][6],x$0,_jo_),
         opt$1=[0,eta],
         opt$0=opt$1,
         _jm_=[0,eps],
         x$0=x$1;
        continue}}
    var
     f=A[28][29],
     start_time=caml_sys_time(0),
     y=desc(0,0,f,[0,uniform(0,10)]),
     end_time=caml_sys_time(0);
    caml_call1(printf(_ja_),end_time - start_time);
    var _jb_=caml_call1(A[23],y);
    caml_call1(info(_jc_),_jb_);
    do_at_exit(0);
    return}
  (function(){return this}()));

//# sourceMappingURL=gd_base.map
